<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection • REndo</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fitting Linear Models Endogenous Regressors using Gaussian Copula — copulaCorrection" />

<meta property="og:description" content="Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">REndo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/REndo-introduction.html">REndo: A Package to Address Endogeneity Without External Instrumental Variables</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mmeierer/REndo">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting Linear Models Endogenous Regressors using Gaussian Copula</h1>
    <small class="dont-index">Source: <a href='https://github.com/mmeierer/REndo/blob/master/R/f_copulacorrection_interface.R'><code>R/f_copulacorrection_interface.R</code></a></small>
    <div class="hidden name"><code>copulaCorrection.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits linear models with continuous or discrete endogenous regressors (or a mixture of both) using Gaussian copulas, as presented in Park and Gupta (2012).
This is a statistical technique to address the endogeneity problem where no external instrumental variables are needed.
The important assumption of the model is that the endogenous variables should NOT be normally distributed, if continuous, preferably with a skewed distribution.</p>
    
    </div>

    <pre class="usage"><span class='fu'>copulaCorrection</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>num.boots</span> <span class='kw'>=</span> <span class='fl'>1000</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A symbolic description of the model to be fitted. See the "Details" section for the exact notation.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data.frame containing the data of all parts specified in the formula parameter.</p></td>
    </tr>
    <tr>
      <th>num.boots</th>
      <td><p>Number of bootstrapping iterations. Defaults to 1000.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments for the log-likelihood optimization function in the case of a single continuous endogenous
 regressor. Ignored with a warning otherwise.</p><dl class='dl-horizontal'>
<dt>start.params</dt><dd><p>A named vector containing a set of parameters to use in the first optimization iteration.
The names have to correspond exactly to the names of the components specified in the <code>formula</code> parameter.
If not provided, a linear model is fitted to derive them.</p></dd>
<dt>optimx.args</dt><dd><p>A named list of arguments which are passed to <code><a href='https://www.rdocumentation.org/packages/optimx/topics/optimx'>optimx</a></code>. This allows users to tweak optimization settings to their liking.</p></dd>
</dl></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>For all cases, an object of classes <code>rendo.copula.correction</code>, <code>rendo.boots</code>, and <code>rendo.base</code> is returned
which is a list and contains the following components:</p>
<dt>formula</dt><dd><p>The formula given to specify the fitted model.</p></dd>
<dt>terms</dt><dd><p>The terms object used for model fitting.</p></dd>
<dt>model</dt><dd><p>The model.frame used for model fitting.</p></dd>
<dt>coefficients</dt><dd><p>A named vector of all coefficients resulting from model fitting.</p></dd>
<dt>names.main.coefs</dt><dd><p>a vector specifying which coefficients are from the model. For internal usage.</p></dd>
<dt>names.vars.continuous</dt><dd><p>The names of the continuous endogenous regressors.</p></dd>
<dt>names.vars.discrete</dt><dd><p>The names of the discrete endogenous regressors.</p></dd>
<dt>fitted.values</dt><dd><p>Fitted values at the found solution.</p></dd>
<dt>residuals</dt><dd><p>The residuals at the found solution.</p></dd>
<dt>boots.params</dt><dd><p>The bootstrapped coefficients.</p></dd>

For the case of a single continuous endogenous regressor, the returned object further
contains the following components:
<dt>start.params</dt><dd><p>A named vector with the initial set of parameters used to optimize the log-likelihood function.</p></dd>
<dt>res.optimx</dt><dd><p>The result object returned by the function <code>optimx</code> after optimizing the log-likelihood function.</p></dd>

For all other cases, the returned object further contains the following components:
<dt>res.lm.real.data</dt><dd><p>The linear model fitted on the original data together with generated p.star data.</p></dd>

The function summary can be used to obtain and print a summary of the results.
Depending on the returned object, the generic accessor functions coefficients, fitted.values,
residuals, vcov, logLik, AIC, BIC, and nobs are available.

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <h3>Method</h3>
    The underlying idea of the joint estimation method is that using information contained in the observed data,
one selects marginal distributions for the endogenous regressor and the structural error term, respectively.
Then, the copula model enables the construction of a flexible multivariate joint distribution allowing a wide range
of correlations between the two marginals.
    Consider the model:
<br><center>Y<sub>t</sub>=&beta;<sub>0</sub>+&beta;<sub>1</sub>P<sub>t</sub>+&beta;<sub>2</sub>X<sub>t</sub>+&epsilon;<sub>t</sub></center>
    where \(t=1,..,T\) indexes either time or cross-sectional units, Y<sub>t</sub> is a \(1x1\) response variable,
X<sub>t</sub> is a \(kxn\) exogenous regressor,
P<sub>t</sub> is a \(kx1\) continuous endogenous regressor,
&epsilon;<sub>t</sub> is a normally distributed structural error term with mean zero and
E(&epsilon;<sup>2</sup>)=&sigma;<sub>&epsilon;</sub><sup>2</sup>,
\(\alpha\) and \(\beta\) are model parameters.
    The marginal distribution of the endogenous regressor P<sub>t</sub> is obtained using the Epanechnikov
kernel density estimator (Epanechnikov, 1969), as below:
<br><center>h&#770;(p)=1/(T&#183;b) &sum;(K&#183;((p-P<sub>t</sub>)/b))</center>
    where P<sub>t</sub> is the endogenous regressor,
K(x)=0.75&#183;(1-x<sup>2</sup>)&#183;I(|x|<=1)
and the bandwidth \(b\) is the one proposed by Silverman (1986),
and is equal to b=0.9&#183;T<sup>-1.5</sup>&#183;min(s, IQR/1.34).
\(IQR\) is the interquartile range while \(s\) is the data sample standard deviation
and \(T\) is the number of time periods observed in the data.
After obtaining the joint distribution of the error term and the continuous endogenous regressor, the model parameters are estimated using
maximum likelihood estimation.
    The additional parameters used during model fitting and printed in <code>summary</code> hence are:
<dl class='dl-horizontal'>
<dt><code>rho</code></dt><dd><p>The correlation between the endogenous regressor and the error.</p></dd>
<dt><code>sigma</code></dt><dd><p>The variance of the model's error.</p></dd>
</dl>
    With more than one continuous endogenous regressor or an endogenous discrete regressor, an alternative approach to the
estimation using Gaussian copula should be applied. This approach is similar to the control function approach (Petrin and Train, 2010).
The core idea is to apply OLS estimation on the original set of explanatory variables in the model equation above, plus an additional regressor
P<sub>t</sub>&#42;=&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
Here, H(P<sub>t</sub>) is the marginal distribution of the endogenous regressor \(P\).
Including this regressor solves the correlation between the endogenous regressor and the structural error, \(\epsilon\),
OLS providing consistent parameter estimates. Due to identification problems, the discrete endogenous regressor cannot have a binomial
distribution.
    Hence, only in the case of a single continuous endogenous regressor maximum likelihood estimation is used.
In all other cases, augmented OLS based on Gaussian copula is applied. This includes cases of multiple endogenous regressors
of both discrete and continuous distributions.
    In the case of discrete endogenous regressors, a random seed needs to be assigned because the marginal distribution function of
the endogenous regressor is a step function in this case. This means that the value of P&#42;
lies between 2 values, &Phi;<sup>-1</sup>(H(P<sub>t</sub>-1)) and
&Phi;<sup>-1</sup>(H(P<sub>t</sub>)).
However, the reported upper and lower bounds of the 95% bootstrapped confidence interval gives indication of the variance of the estimates.
<p>Since the inference procedure in both cases, augmented OLS and maximum likelihood, occurs in two stages (first the empirical distribution of the endogenous
regressor is computed and then used in constructing the likelihood function), the standard errors are not correct. Therefore, in both cases, the standard errors
and the confidence intervals are obtained based on the sampling distributions resulted from bootstrapping. Since the distribution of the bootstrapped parameters
is highly skewed, we report the percentile confidence intervals. Moreover, the variance-covariance matrix is also computed based on the bootstrapped
parameters, and not based on the Hessian.</p>
    <h3>Formula parameter</h3>
    The <code>formula</code> argument follows a two part notation:
    A two-sided formula describing the model (e.g. <code>y ~ X1 + X2 + P</code>) to be estimated and a
second right-hand side part in which the endogenous regressors and their distributional
assumptions are indicated (e.g. <code>continuous(P)</code>). These two parts are separated by a single vertical bar (<code>|</code>).
In the second part, the special functions <code>continuous</code>, <code>discrete</code>, or a combination
of both, are used to indicate the endogenous regressors and their respective distribution.
Both functions use the <code>...</code> parameter in which the respective endogenous regressors is specified.
    Note that no argument to <code>continuous</code> or <code>discrete</code> is to be supplied as character
but as symbols without quotation marks.
    See the example section for illustrations on how to specify the <code>formula</code> parameter.
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Park, S. and Gupta, S., (2012), "Handling Endogenous Regressors by Joint Estimation Using Copulas", Marketing Science, 31(4), 567-86.</p>
<p>Epanechnikov V (1969). "Nonparametric Estimation of a Multidimensional Probability Density." Teoriya veroyatnostei i ee primeneniya, 14(1), 156–161.
Silverman B (1986). "Density Estimation for Statistics and Data Analysis". CRC Monographs on Statistics and Applied Probability. London: Chapman &amp; Hall.</p>
<p>Petrin A, Train K (2010). "A Control Function Approach to Endogeneity in Consumer Choice Models." Journal of Marketing Research, 47(1), 3–13.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='summary.rendo.copula.correction.html'>summary</a></code> for how fitted models are summarized</p>
<p><code><a href='vcov.rendo.boots.html'>vcov</a></code> for how the variance-covariance matrix is derived</p>
<p><code><a href='confint.rendo.boots.html'>confint</a></code> for how confidence intervals are derived</p>
<p><code><a href='https://www.rdocumentation.org/packages/optimx/topics/optimx'>optimx</a></code> for possible elements of parameter <code>optimx.arg</code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopCont"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopCont2"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDis"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDis2"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='st'>"dataCopDisCont"</span>)</div><div class='input'><span class='co'># Single continuous: log-likelihood optimization</span>
<span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above, with start.parameters and number of bootstrappings</span>
<span class='no'>c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>,
                       <span class='kw'>start.params</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"(Intercept)"</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>X1</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>X2</span><span class='kw'>=</span>-<span class='fl'>2</span>, <span class='kw'>P</span><span class='kw'>=</span>-<span class='fl'>1</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># All following examples fit linear model with Gaussian copulas</span>

<span class='co'># 2 continuous endogenous regressors</span>
<span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P1</span>, <span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 2 continuous and 0 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above</span>
<span class='no'>c2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P1</span>)+<span class='fu'>continuous</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 2 continuous and 0 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># single discrete endogenous regressor</span>
<span class='no'>d1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P</span>), <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 1 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># two discrete endogenous regressor</span>
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>)+<span class='fu'>discrete</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 2 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='co'># same as above but less bootstrap runs</span>
<span class='no'>d2</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>, <span class='no'>P2</span>), <span class='kw'>num.boots</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                       <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDis2</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 0 continuous and 2 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># single discrete, single continuous</span>
<span class='no'>cd</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P1</span>+<span class='no'>P2</span><span class='kw'>|</span><span class='fu'>discrete</span>(<span class='no'>P1</span>)+<span class='fu'>continuous</span>(<span class='no'>P2</span>),
                       <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopDisCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Fitting linear model with additional PStar copula data for 1 continuous and 1 discrete endogenous regressors.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># For single continuous only: use own optimization settings (see optimx())</span>
<span class='co'># set maximum number of iterations to 50'000</span>
<span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                           <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>itnmax</span> <span class='kw'>=</span> <span class='fl'>50000</span>),
                           <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%  |                                                                              |==============                                                        |  20%  |                                                                              |=====================                                                 |  30%  |                                                                              |============================                                          |  40%  |                                                                              |===================================                                   |  50%  |                                                                              |==========================================                            |  60%  |                                                                              |=================================================                     |  70%  |                                                                              |========================================================              |  80%  |                                                                              |===============================================================       |  90%  |                                                                              |======================================================================| 100%</div><div class='input'>
<span class='co'># print detailed tracing information on progress</span>
 <span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                            <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>6</span>)),
                            <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6066.699410
#&gt;   Scaled convergence tolerance is 9.04009e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11655.293629 5695.637199
#&gt; LO-REDUCTION       9 7765.834415 5695.637199
#&gt; LO-REDUCTION      11 7519.586333 5695.637199
#&gt; LO-REDUCTION      13 6861.295883 5695.637199
#&gt; LO-REDUCTION      15 6591.723078 5695.637199
#&gt; LO-REDUCTION      17 6330.376148 5695.637199
#&gt; REFLECTION        19 6277.490264 5673.393067
#&gt; REFLECTION        21 6066.699410 5485.576718
#&gt; LO-REDUCTION      23 5879.887795 5485.576718
#&gt; LO-REDUCTION      25 5868.216236 5485.576718
#&gt; LO-REDUCTION      27 5700.078431 5485.576718
#&gt; LO-REDUCTION      29 5695.637199 5485.576718
#&gt; LO-REDUCTION      31 5673.393067 5485.576718
#&gt; LO-REDUCTION      33 5569.952286 5485.576718
#&gt; LO-REDUCTION      35 5534.598391 5485.576718
#&gt; HI-REDUCTION      37 5528.603388 5485.576718
#&gt; LO-REDUCTION      39 5515.960624 5485.576718
#&gt; HI-REDUCTION      41 5496.374548 5485.576718
#&gt; HI-REDUCTION      43 5494.649359 5485.576718
#&gt; HI-REDUCTION      45 5493.139869 5485.441214
#&gt; REFLECTION        47 5489.798362 5484.577835
#&gt; LO-REDUCTION      49 5488.808164 5481.951305
#&gt; LO-REDUCTION      51 5485.763575 5480.324269
#&gt; HI-REDUCTION      53 5485.649342 5480.324269
#&gt; HI-REDUCTION      55 5485.576718 5480.324269
#&gt; HI-REDUCTION      57 5485.441214 5480.324269
#&gt; LO-REDUCTION      59 5484.577835 5479.718251
#&gt; HI-REDUCTION      61 5481.951305 5479.718251
#&gt; HI-REDUCTION      63 5481.493549 5479.718251
#&gt; REFLECTION        65 5481.258604 5479.042918
#&gt; HI-REDUCTION      67 5481.088674 5479.042918
#&gt; REFLECTION        69 5480.324269 5478.568166
#&gt; HI-REDUCTION      71 5480.210564 5478.568166
#&gt; LO-REDUCTION      73 5480.169553 5478.568166
#&gt; EXTENSION         75 5479.729317 5478.078801
#&gt; REFLECTION        77 5479.718251 5477.828364
#&gt; LO-REDUCTION      79 5479.215719 5477.828364
#&gt; LO-REDUCTION      81 5479.203150 5477.823854
#&gt; REFLECTION        83 5479.042918 5477.152439
#&gt; LO-REDUCTION      85 5478.568166 5477.152439
#&gt; LO-REDUCTION      87 5478.078801 5477.152439
#&gt; LO-REDUCTION      89 5477.873007 5477.152439
#&gt; LO-REDUCTION      91 5477.828364 5477.152439
#&gt; LO-REDUCTION      93 5477.823854 5477.152439
#&gt; EXTENSION         95 5477.607265 5476.526851
#&gt; LO-REDUCTION      97 5477.414512 5476.526851
#&gt; LO-REDUCTION      99 5477.407763 5476.526851
#&gt; LO-REDUCTION     101 5477.365292 5476.526851
#&gt; LO-REDUCTION     103 5477.294969 5476.526851
#&gt; LO-REDUCTION     105 5477.152439 5476.526851
#&gt; EXTENSION        107 5477.047051 5476.077909
#&gt; LO-REDUCTION     109 5476.914382 5476.077909
#&gt; LO-REDUCTION     111 5476.747256 5476.077909
#&gt; LO-REDUCTION     113 5476.700138 5476.077909
#&gt; EXTENSION        115 5476.573155 5476.006884
#&gt; LO-REDUCTION     117 5476.526851 5476.006884
#&gt; REFLECTION       119 5476.359098 5475.966940
#&gt; EXTENSION        121 5476.221765 5475.531955
#&gt; LO-REDUCTION     123 5476.209942 5475.531955
#&gt; LO-REDUCTION     125 5476.150247 5475.531955
#&gt; LO-REDUCTION     127 5476.077909 5475.531955
#&gt; LO-REDUCTION     129 5476.006884 5475.531955
#&gt; LO-REDUCTION     131 5475.966940 5475.531955
#&gt; LO-REDUCTION     133 5475.935765 5475.531955
#&gt; EXTENSION        135 5475.770072 5475.282275
#&gt; EXTENSION        137 5475.703400 5475.046043
#&gt; LO-REDUCTION     139 5475.596586 5475.046043
#&gt; LO-REDUCTION     141 5475.554207 5475.046043
#&gt; LO-REDUCTION     143 5475.535053 5475.046043
#&gt; LO-REDUCTION     145 5475.531955 5475.046043
#&gt; REFLECTION       147 5475.282275 5474.985965
#&gt; LO-REDUCTION     149 5475.201050 5474.985965
#&gt; EXTENSION        151 5475.162505 5474.914685
#&gt; LO-REDUCTION     153 5475.131559 5474.914685
#&gt; EXTENSION        155 5475.091330 5474.818176
#&gt; REFLECTION       157 5475.078835 5474.785378
#&gt; REFLECTION       159 5475.046043 5474.771218
#&gt; LO-REDUCTION     161 5474.985965 5474.771218
#&gt; LO-REDUCTION     163 5474.919264 5474.771218
#&gt; HI-REDUCTION     165 5474.914685 5474.771218
#&gt; REFLECTION       167 5474.870588 5474.737806
#&gt; LO-REDUCTION     169 5474.829996 5474.737806
#&gt; LO-REDUCTION     171 5474.818176 5474.737806
#&gt; REFLECTION       173 5474.817291 5474.723977
#&gt; EXTENSION        175 5474.785378 5474.664323
#&gt; LO-REDUCTION     177 5474.771218 5474.664323
#&gt; LO-REDUCTION     179 5474.749096 5474.664323
#&gt; LO-REDUCTION     181 5474.744778 5474.664323
#&gt; EXTENSION        183 5474.737806 5474.627580
#&gt; EXTENSION        185 5474.723977 5474.603678
#&gt; LO-REDUCTION     187 5474.690190 5474.603678
#&gt; REFLECTION       189 5474.676094 5474.600848
#&gt; REFLECTION       191 5474.671963 5474.581443
#&gt; HI-REDUCTION     193 5474.664323 5474.581443
#&gt; EXTENSION        195 5474.627580 5474.542814
#&gt; REFLECTION       197 5474.607645 5474.534732
#&gt; LO-REDUCTION     199 5474.604300 5474.534732
#&gt; HI-REDUCTION     201 5474.603678 5474.534732
#&gt; LO-REDUCTION     203 5474.600848 5474.534732
#&gt; EXTENSION        205 5474.581443 5474.474411
#&gt; LO-REDUCTION     207 5474.563653 5474.474411
#&gt; LO-REDUCTION     209 5474.557809 5474.474411
#&gt; EXTENSION        211 5474.551105 5474.447380
#&gt; LO-REDUCTION     213 5474.542814 5474.447380
#&gt; REFLECTION       215 5474.534732 5474.434785
#&gt; LO-REDUCTION     217 5474.507183 5474.434785
#&gt; EXTENSION        219 5474.497839 5474.408340
#&gt; EXTENSION        221 5474.474411 5474.372781
#&gt; LO-REDUCTION     223 5474.468972 5474.372781
#&gt; EXTENSION        225 5474.455320 5474.295481
#&gt; LO-REDUCTION     227 5474.447380 5474.295481
#&gt; LO-REDUCTION     229 5474.434785 5474.295481
#&gt; LO-REDUCTION     231 5474.408340 5474.295481
#&gt; EXTENSION        233 5474.387490 5474.265810
#&gt; LO-REDUCTION     235 5474.372781 5474.265810
#&gt; LO-REDUCTION     237 5474.351363 5474.265810
#&gt; LO-REDUCTION     239 5474.346856 5474.265810
#&gt; EXTENSION        241 5474.343541 5474.245871
#&gt; REFLECTION       243 5474.295481 5474.218162
#&gt; HI-REDUCTION     245 5474.292981 5474.218162
#&gt; EXTENSION        247 5474.290031 5474.195094
#&gt; LO-REDUCTION     249 5474.281209 5474.195094
#&gt; EXTENSION        251 5474.265810 5474.169866
#&gt; LO-REDUCTION     253 5474.260265 5474.169866
#&gt; LO-REDUCTION     255 5474.245871 5474.169866
#&gt; EXTENSION        257 5474.218162 5474.104369
#&gt; LO-REDUCTION     259 5474.209633 5474.104369
#&gt; LO-REDUCTION     261 5474.195094 5474.104369
#&gt; LO-REDUCTION     263 5474.193875 5474.104369
#&gt; EXTENSION        265 5474.181355 5474.035079
#&gt; LO-REDUCTION     267 5474.169866 5474.035079
#&gt; LO-REDUCTION     269 5474.154536 5474.035079
#&gt; EXTENSION        271 5474.129257 5473.975150
#&gt; LO-REDUCTION     273 5474.112698 5473.975150
#&gt; LO-REDUCTION     275 5474.104369 5473.975150
#&gt; LO-REDUCTION     277 5474.081845 5473.975150
#&gt; LO-REDUCTION     279 5474.062998 5473.975150
#&gt; LO-REDUCTION     281 5474.035079 5473.975150
#&gt; LO-REDUCTION     283 5474.023715 5473.975150
#&gt; EXTENSION        285 5474.020378 5473.957216
#&gt; EXTENSION        287 5473.990427 5473.937415
#&gt; REFLECTION       289 5473.988691 5473.935943
#&gt; HI-REDUCTION     291 5473.987532 5473.935943
#&gt; REFLECTION       293 5473.979800 5473.922702
#&gt; EXTENSION        295 5473.975150 5473.864352
#&gt; LO-REDUCTION     297 5473.957216 5473.864352
#&gt; LO-REDUCTION     299 5473.956967 5473.864352
#&gt; LO-REDUCTION     301 5473.937415 5473.864352
#&gt; LO-REDUCTION     303 5473.935943 5473.864352
#&gt; EXTENSION        305 5473.922702 5473.849235
#&gt; EXTENSION        307 5473.916512 5473.829827
#&gt; EXTENSION        309 5473.898706 5473.811097
#&gt; EXTENSION        311 5473.883827 5473.788518
#&gt; LO-REDUCTION     313 5473.874805 5473.788518
#&gt; LO-REDUCTION     315 5473.864352 5473.788518
#&gt; REFLECTION       317 5473.849235 5473.783659
#&gt; LO-REDUCTION     319 5473.829827 5473.783659
#&gt; HI-REDUCTION     321 5473.811097 5473.783659
#&gt; REFLECTION       323 5473.797066 5473.775061
#&gt; LO-REDUCTION     325 5473.794855 5473.775061
#&gt; EXTENSION        327 5473.792770 5473.759049
#&gt; LO-REDUCTION     329 5473.791611 5473.759049
#&gt; LO-REDUCTION     331 5473.788518 5473.758560
#&gt; LO-REDUCTION     333 5473.783659 5473.758560
#&gt; HI-REDUCTION     335 5473.775670 5473.758560
#&gt; LO-REDUCTION     337 5473.775061 5473.758560
#&gt; REFLECTION       339 5473.765389 5473.756064
#&gt; LO-REDUCTION     341 5473.764760 5473.755112
#&gt; EXTENSION        343 5473.759778 5473.741357
#&gt; HI-REDUCTION     345 5473.759146 5473.741357
#&gt; LO-REDUCTION     347 5473.759049 5473.741357
#&gt; LO-REDUCTION     349 5473.758560 5473.741357
#&gt; EXTENSION        351 5473.756064 5473.738656
#&gt; LO-REDUCTION     353 5473.755112 5473.738656
#&gt; EXTENSION        355 5473.752204 5473.732288
#&gt; REFLECTION       357 5473.748349 5473.731125
#&gt; LO-REDUCTION     359 5473.743165 5473.731125
#&gt; LO-REDUCTION     361 5473.741357 5473.731125
#&gt; LO-REDUCTION     363 5473.741351 5473.731125
#&gt; LO-REDUCTION     365 5473.738656 5473.731125
#&gt; REFLECTION       367 5473.735294 5473.729399
#&gt; EXTENSION        369 5473.733289 5473.725014
#&gt; LO-REDUCTION     371 5473.733093 5473.725014
#&gt; LO-REDUCTION     373 5473.732288 5473.725014
#&gt; LO-REDUCTION     375 5473.731173 5473.725014
#&gt; EXTENSION        377 5473.731125 5473.721626
#&gt; LO-REDUCTION     379 5473.729399 5473.721626
#&gt; LO-REDUCTION     381 5473.726415 5473.721626
#&gt; EXTENSION        383 5473.725699 5473.718097
#&gt; LO-REDUCTION     385 5473.725415 5473.718097
#&gt; LO-REDUCTION     387 5473.725014 5473.718097
#&gt; LO-REDUCTION     389 5473.722704 5473.718097
#&gt; LO-REDUCTION     391 5473.722190 5473.718097
#&gt; REFLECTION       393 5473.721626 5473.717825
#&gt; REFLECTION       395 5473.720554 5473.717053
#&gt; LO-REDUCTION     397 5473.720034 5473.716914
#&gt; REFLECTION       399 5473.718882 5473.716822
#&gt; EXTENSION        401 5473.718320 5473.714298
#&gt; LO-REDUCTION     403 5473.718097 5473.714298
#&gt; LO-REDUCTION     405 5473.717825 5473.714298
#&gt; LO-REDUCTION     407 5473.717053 5473.714298
#&gt; LO-REDUCTION     409 5473.716914 5473.714298
#&gt; LO-REDUCTION     411 5473.716822 5473.714298
#&gt; EXTENSION        413 5473.716021 5473.713447
#&gt; LO-REDUCTION     415 5473.715777 5473.713447
#&gt; EXTENSION        417 5473.715651 5473.713066
#&gt; LO-REDUCTION     419 5473.715526 5473.713066
#&gt; LO-REDUCTION     421 5473.715087 5473.713066
#&gt; LO-REDUCTION     423 5473.714363 5473.713066
#&gt; REFLECTION       425 5473.714298 5473.713028
#&gt; LO-REDUCTION     427 5473.713567 5473.713023
#&gt; HI-REDUCTION     429 5473.713447 5473.713023
#&gt; EXTENSION        431 5473.713283 5473.712235
#&gt; LO-REDUCTION     433 5473.713199 5473.712235
#&gt; LO-REDUCTION     435 5473.713154 5473.712235
#&gt; HI-REDUCTION     437 5473.713066 5473.712235
#&gt; LO-REDUCTION     439 5473.713028 5473.712235
#&gt; LO-REDUCTION     441 5473.713023 5473.712235
#&gt; LO-REDUCTION     443 5473.712862 5473.712235
#&gt; LO-REDUCTION     445 5473.712828 5473.712235
#&gt; EXTENSION        447 5473.712784 5473.711935
#&gt; EXTENSION        449 5473.712695 5473.711390
#&gt; LO-REDUCTION     451 5473.712390 5473.711390
#&gt; LO-REDUCTION     453 5473.712283 5473.711390
#&gt; LO-REDUCTION     455 5473.712246 5473.711390
#&gt; REFLECTION       457 5473.712235 5473.711337
#&gt; EXTENSION        459 5473.711935 5473.711052
#&gt; EXTENSION        461 5473.711599 5473.710490
#&gt; LO-REDUCTION     463 5473.711598 5473.710490
#&gt; EXTENSION        465 5473.711513 5473.710121
#&gt; LO-REDUCTION     467 5473.711390 5473.710121
#&gt; LO-REDUCTION     469 5473.711337 5473.710121
#&gt; LO-REDUCTION     471 5473.711052 5473.710121
#&gt; EXTENSION        473 5473.710613 5473.709455
#&gt; LO-REDUCTION     475 5473.710569 5473.709455
#&gt; LO-REDUCTION     477 5473.710558 5473.709455
#&gt; LO-REDUCTION     479 5473.710490 5473.709455
#&gt; EXTENSION        481 5473.710223 5473.709307
#&gt; LO-REDUCTION     483 5473.710121 5473.709307
#&gt; LO-REDUCTION     485 5473.710118 5473.709307
#&gt; EXTENSION        487 5473.709834 5473.708478
#&gt; LO-REDUCTION     489 5473.709516 5473.708478
#&gt; LO-REDUCTION     491 5473.709455 5473.708478
#&gt; LO-REDUCTION     493 5473.709442 5473.708478
#&gt; LO-REDUCTION     495 5473.709425 5473.708478
#&gt; EXTENSION        497 5473.709307 5473.708168
#&gt; LO-REDUCTION     499 5473.708999 5473.708168
#&gt; LO-REDUCTION     501 5473.708908 5473.708168
#&gt; EXTENSION        503 5473.708892 5473.708101
#&gt; REFLECTION       505 5473.708754 5473.707883
#&gt; REFLECTION       507 5473.708478 5473.707856
#&gt; HI-REDUCTION     509 5473.708447 5473.707856
#&gt; REFLECTION       511 5473.708360 5473.707816
#&gt; EXTENSION        513 5473.708168 5473.707045
#&gt; LO-REDUCTION     515 5473.708118 5473.707045
#&gt; LO-REDUCTION     517 5473.708101 5473.707045
#&gt; LO-REDUCTION     519 5473.707883 5473.707045
#&gt; LO-REDUCTION     521 5473.707856 5473.707045
#&gt; LO-REDUCTION     523 5473.707816 5473.707045
#&gt; LO-REDUCTION     525 5473.707804 5473.707045
#&gt; EXTENSION        527 5473.707780 5473.706881
#&gt; EXTENSION        529 5473.707482 5473.705810
#&gt; LO-REDUCTION     531 5473.707341 5473.705810
#&gt; LO-REDUCTION     533 5473.707259 5473.705810
#&gt; EXTENSION        535 5473.707135 5473.705341
#&gt; LO-REDUCTION     537 5473.707045 5473.705341
#&gt; LO-REDUCTION     539 5473.706881 5473.705341
#&gt; EXTENSION        541 5473.706373 5473.703301
#&gt; LO-REDUCTION     543 5473.706000 5473.703301
#&gt; LO-REDUCTION     545 5473.705810 5473.703301
#&gt; LO-REDUCTION     547 5473.705529 5473.703301
#&gt; LO-REDUCTION     549 5473.705436 5473.703301
#&gt; EXTENSION        551 5473.705341 5473.700935
#&gt; LO-REDUCTION     553 5473.704096 5473.700935
#&gt; LO-REDUCTION     555 5473.704022 5473.700935
#&gt; EXTENSION        557 5473.703753 5473.698947
#&gt; LO-REDUCTION     559 5473.703315 5473.698947
#&gt; EXTENSION        561 5473.703301 5473.697534
#&gt; EXTENSION        563 5473.701275 5473.693757
#&gt; LO-REDUCTION     565 5473.701019 5473.693757
#&gt; LO-REDUCTION     567 5473.700935 5473.693757
#&gt; EXTENSION        569 5473.699873 5473.691864
#&gt; EXTENSION        571 5473.698947 5473.688397
#&gt; LO-REDUCTION     573 5473.697534 5473.688397
#&gt; LO-REDUCTION     575 5473.695554 5473.688397
#&gt; LO-REDUCTION     577 5473.695159 5473.688397
#&gt; REFLECTION       579 5473.693757 5473.687221
#&gt; LO-REDUCTION     581 5473.691864 5473.687221
#&gt; EXTENSION        583 5473.689777 5473.684985
#&gt; LO-REDUCTION     585 5473.689229 5473.684985
#&gt; LO-REDUCTION     587 5473.689126 5473.684985
#&gt; EXTENSION        589 5473.688738 5473.684040
#&gt; LO-REDUCTION     591 5473.688397 5473.684040
#&gt; LO-REDUCTION     593 5473.687436 5473.684040
#&gt; EXTENSION        595 5473.687221 5473.680380
#&gt; LO-REDUCTION     597 5473.686742 5473.680380
#&gt; LO-REDUCTION     599 5473.685656 5473.680380
#&gt; LO-REDUCTION     601 5473.684985 5473.680380
#&gt; LO-REDUCTION     603 5473.684696 5473.680380
#&gt; EXTENSION        605 5473.684040 5473.676677
#&gt; LO-REDUCTION     607 5473.682830 5473.676677
#&gt; EXTENSION        609 5473.682673 5473.673979
#&gt; LO-REDUCTION     611 5473.681575 5473.673979
#&gt; EXTENSION        613 5473.680914 5473.670992
#&gt; EXTENSION        615 5473.680380 5473.665124
#&gt; LO-REDUCTION     617 5473.678465 5473.665124
#&gt; EXTENSION        619 5473.676677 5473.657691
#&gt; LO-REDUCTION     621 5473.674527 5473.657691
#&gt; LO-REDUCTION     623 5473.673979 5473.657691
#&gt; EXTENSION        625 5473.670992 5473.646617
#&gt; EXTENSION        627 5473.667211 5473.637296
#&gt; LO-REDUCTION     629 5473.665124 5473.637296
#&gt; EXTENSION        631 5473.658907 5473.624633
#&gt; LO-REDUCTION     633 5473.658045 5473.624633
#&gt; EXTENSION        635 5473.657691 5473.608922
#&gt; LO-REDUCTION     637 5473.646617 5473.608922
#&gt; EXTENSION        639 5473.639129 5473.603210
#&gt; LO-REDUCTION     641 5473.637296 5473.603210
#&gt; LO-REDUCTION     643 5473.629334 5473.603210
#&gt; REFLECTION       645 5473.624633 5473.599311
#&gt; REFLECTION       647 5473.612619 5473.597382
#&gt; HI-REDUCTION     649 5473.609880 5473.597382
#&gt; EXTENSION        651 5473.608922 5473.589403
#&gt; LO-REDUCTION     653 5473.605827 5473.589403
#&gt; LO-REDUCTION     655 5473.604253 5473.589403
#&gt; HI-REDUCTION     657 5473.603210 5473.589403
#&gt; LO-REDUCTION     659 5473.599311 5473.589403
#&gt; LO-REDUCTION     661 5473.597641 5473.589403
#&gt; LO-REDUCTION     663 5473.597382 5473.589403
#&gt; EXTENSION        665 5473.596136 5473.586795
#&gt; EXTENSION        667 5473.594133 5473.581062
#&gt; LO-REDUCTION     669 5473.593092 5473.581062
#&gt; LO-REDUCTION     671 5473.592558 5473.581062
#&gt; EXTENSION        673 5473.589644 5473.578114
#&gt; LO-REDUCTION     675 5473.589403 5473.578114
#&gt; LO-REDUCTION     677 5473.586795 5473.578114
#&gt; LO-REDUCTION     679 5473.585604 5473.578114
#&gt; EXTENSION        681 5473.582257 5473.572965
#&gt; EXTENSION        683 5473.582038 5473.568155
#&gt; LO-REDUCTION     685 5473.581062 5473.568155
#&gt; LO-REDUCTION     687 5473.578430 5473.568155
#&gt; LO-REDUCTION     689 5473.578134 5473.568155
#&gt; LO-REDUCTION     691 5473.578114 5473.568155
#&gt; LO-REDUCTION     693 5473.574117 5473.568093
#&gt; EXTENSION        695 5473.572965 5473.560840
#&gt; LO-REDUCTION     697 5473.572011 5473.560840
#&gt; EXTENSION        699 5473.569711 5473.555391
#&gt; LO-REDUCTION     701 5473.568275 5473.555391
#&gt; LO-REDUCTION     703 5473.568155 5473.555391
#&gt; LO-REDUCTION     705 5473.568093 5473.555391
#&gt; EXTENSION        707 5473.562808 5473.549032
#&gt; LO-REDUCTION     709 5473.561034 5473.549032
#&gt; LO-REDUCTION     711 5473.560840 5473.549032
#&gt; EXTENSION        713 5473.558382 5473.542850
#&gt; LO-REDUCTION     715 5473.556132 5473.542850
#&gt; LO-REDUCTION     717 5473.555391 5473.542850
#&gt; LO-REDUCTION     719 5473.554476 5473.542850
#&gt; EXTENSION        721 5473.550557 5473.542110
#&gt; LO-REDUCTION     723 5473.549032 5473.542110
#&gt; LO-REDUCTION     725 5473.548500 5473.542110
#&gt; EXTENSION        727 5473.548310 5473.540528
#&gt; LO-REDUCTION     729 5473.547261 5473.540528
#&gt; REFLECTION       731 5473.544174 5473.539355
#&gt; REFLECTION       733 5473.543366 5473.539184
#&gt; LO-REDUCTION     735 5473.542850 5473.539184
#&gt; HI-REDUCTION     737 5473.542537 5473.539184
#&gt; EXTENSION        739 5473.542110 5473.537158
#&gt; LO-REDUCTION     741 5473.540528 5473.537158
#&gt; EXTENSION        743 5473.540202 5473.534897
#&gt; LO-REDUCTION     745 5473.539540 5473.534897
#&gt; LO-REDUCTION     747 5473.539355 5473.534897
#&gt; LO-REDUCTION     749 5473.539184 5473.534897
#&gt; EXTENSION        751 5473.538490 5473.533200
#&gt; EXTENSION        753 5473.537845 5473.531098
#&gt; LO-REDUCTION     755 5473.537158 5473.531098
#&gt; EXTENSION        757 5473.536395 5473.527262
#&gt; EXTENSION        759 5473.535640 5473.522412
#&gt; LO-REDUCTION     761 5473.534897 5473.522412
#&gt; LO-REDUCTION     763 5473.533200 5473.522412
#&gt; LO-REDUCTION     765 5473.531325 5473.522412
#&gt; EXTENSION        767 5473.531098 5473.520516
#&gt; EXTENSION        769 5473.527262 5473.515047
#&gt; EXTENSION        771 5473.526691 5473.512053
#&gt; LO-REDUCTION     773 5473.523660 5473.512053
#&gt; EXTENSION        775 5473.522834 5473.505338
#&gt; LO-REDUCTION     777 5473.522412 5473.505338
#&gt; LO-REDUCTION     779 5473.520516 5473.505338
#&gt; LO-REDUCTION     781 5473.515047 5473.505338
#&gt; LO-REDUCTION     783 5473.514715 5473.505338
#&gt; LO-REDUCTION     785 5473.512804 5473.505338
#&gt; EXTENSION        787 5473.512251 5473.501068
#&gt; EXTENSION        789 5473.512053 5473.497575
#&gt; REFLECTION       791 5473.507982 5473.497255
#&gt; LO-REDUCTION     793 5473.506905 5473.497255
#&gt; EXTENSION        795 5473.505380 5473.488328
#&gt; LO-REDUCTION     797 5473.505338 5473.488328
#&gt; LO-REDUCTION     799 5473.501068 5473.488328
#&gt; LO-REDUCTION     801 5473.497707 5473.488328
#&gt; EXTENSION        803 5473.497575 5473.486172
#&gt; EXTENSION        805 5473.497255 5473.481969
#&gt; LO-REDUCTION     807 5473.494387 5473.481969
#&gt; EXTENSION        809 5473.492626 5473.475919
#&gt; REFLECTION       811 5473.488846 5473.475653
#&gt; LO-REDUCTION     813 5473.488328 5473.475653
#&gt; REFLECTION       815 5473.486172 5473.475480
#&gt; HI-REDUCTION     817 5473.483866 5473.475480
#&gt; LO-REDUCTION     819 5473.481969 5473.475480
#&gt; REFLECTION       821 5473.478810 5473.474674
#&gt; LO-REDUCTION     823 5473.477291 5473.474674
#&gt; LO-REDUCTION     825 5473.475919 5473.474674
#&gt; LO-REDUCTION     827 5473.475653 5473.474221
#&gt; HI-REDUCTION     829 5473.475496 5473.474221
#&gt; LO-REDUCTION     831 5473.475480 5473.474221
#&gt; REFLECTION       833 5473.474915 5473.473908
#&gt; LO-REDUCTION     835 5473.474742 5473.473736
#&gt; LO-REDUCTION     837 5473.474674 5473.473736
#&gt; HI-REDUCTION     839 5473.474471 5473.473736
#&gt; LO-REDUCTION     841 5473.474376 5473.473637
#&gt; HI-REDUCTION     843 5473.474221 5473.473637
#&gt; LO-REDUCTION     845 5473.473950 5473.473598
#&gt; LO-REDUCTION     847 5473.473908 5473.473585
#&gt; HI-REDUCTION     849 5473.473856 5473.473585
#&gt; LO-REDUCTION     851 5473.473820 5473.473567
#&gt; REFLECTION       853 5473.473736 5473.473487
#&gt; HI-REDUCTION     855 5473.473637 5473.473487
#&gt; LO-REDUCTION     857 5473.473625 5473.473487
#&gt; REFLECTION       859 5473.473598 5473.473432
#&gt; LO-REDUCTION     861 5473.473585 5473.473432
#&gt; LO-REDUCTION     863 5473.473567 5473.473432
#&gt; LO-REDUCTION     865 5473.473531 5473.473432
#&gt; Exiting from Nelder Mead minimizer
#&gt;     867 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0625664   1.4887824  -3.0065109  -0.9652173  -0.5257498   0.3090100 
#&gt; 
#&gt; $value
#&gt; [1] 5473.473
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      867 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.47 
#&gt; 
#&gt; Assemble the answers</div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6137.711500
#&gt;   Scaled convergence tolerance is 9.1459e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 12034.114540 5733.579694
#&gt; LO-REDUCTION       9 8023.200740 5733.579694
#&gt; LO-REDUCTION      11 7602.294180 5733.579694
#&gt; REFLECTION        13 6916.638527 5718.971026
#&gt; LO-REDUCTION      15 6570.842585 5718.971026
#&gt; LO-REDUCTION      17 6446.567451 5718.971026
#&gt; REFLECTION        19 6352.694278 5686.847061
#&gt; REFLECTION        21 6137.711500 5515.539945
#&gt; LO-REDUCTION      23 5968.950862 5515.539945
#&gt; LO-REDUCTION      25 5938.716325 5515.539945
#&gt; LO-REDUCTION      27 5733.579694 5515.539945
#&gt; HI-REDUCTION      29 5718.971026 5515.539945
#&gt; LO-REDUCTION      31 5686.847061 5515.539945
#&gt; LO-REDUCTION      33 5585.681289 5515.539945
#&gt; LO-REDUCTION      35 5562.928787 5513.028788
#&gt; LO-REDUCTION      37 5562.553572 5513.028788
#&gt; HI-REDUCTION      39 5545.258782 5513.028788
#&gt; LO-REDUCTION      41 5520.628494 5513.028788
#&gt; HI-REDUCTION      43 5516.428710 5509.672669
#&gt; REFLECTION        45 5516.315096 5506.670106
#&gt; HI-REDUCTION      47 5515.789380 5506.670106
#&gt; LO-REDUCTION      49 5515.539945 5506.670106
#&gt; HI-REDUCTION      51 5513.128870 5505.580581
#&gt; LO-REDUCTION      53 5513.028788 5505.580581
#&gt; LO-REDUCTION      55 5509.672669 5505.580581
#&gt; REFLECTION        57 5508.823244 5503.618226
#&gt; LO-REDUCTION      59 5507.674271 5503.618226
#&gt; LO-REDUCTION      61 5507.274701 5503.618226
#&gt; LO-REDUCTION      63 5506.670106 5503.618226
#&gt; HI-REDUCTION      65 5506.387436 5503.618226
#&gt; EXTENSION         67 5505.580581 5502.657379
#&gt; LO-REDUCTION      69 5505.134155 5502.657379
#&gt; LO-REDUCTION      71 5504.598525 5502.657379
#&gt; LO-REDUCTION      73 5504.435896 5502.657379
#&gt; REFLECTION        75 5504.272315 5502.339766
#&gt; REFLECTION        77 5503.618226 5501.455371
#&gt; LO-REDUCTION      79 5503.404697 5501.455371
#&gt; LO-REDUCTION      81 5502.763943 5501.455371
#&gt; HI-REDUCTION      83 5502.743281 5501.455371
#&gt; LO-REDUCTION      85 5502.657379 5501.455371
#&gt; LO-REDUCTION      87 5502.339766 5501.455371
#&gt; LO-REDUCTION      89 5502.212306 5501.455371
#&gt; LO-REDUCTION      91 5502.131909 5501.455371
#&gt; REFLECTION        93 5501.934559 5501.365494
#&gt; LO-REDUCTION      95 5501.917824 5501.350539
#&gt; LO-REDUCTION      97 5501.671306 5501.350539
#&gt; REFLECTION        99 5501.524407 5501.324909
#&gt; LO-REDUCTION     101 5501.509911 5501.324909
#&gt; LO-REDUCTION     103 5501.455371 5501.316722
#&gt; REFLECTION       105 5501.365494 5501.207732
#&gt; HI-REDUCTION     107 5501.354319 5501.207732
#&gt; HI-REDUCTION     109 5501.350539 5501.207732
#&gt; LO-REDUCTION     111 5501.326683 5501.207732
#&gt; LO-REDUCTION     113 5501.324909 5501.207732
#&gt; LO-REDUCTION     115 5501.316722 5501.207732
#&gt; REFLECTION       117 5501.269544 5501.185533
#&gt; EXTENSION        119 5501.268311 5501.138939
#&gt; LO-REDUCTION     121 5501.237253 5501.138939
#&gt; EXTENSION        123 5501.219478 5501.115275
#&gt; LO-REDUCTION     125 5501.214883 5501.115275
#&gt; LO-REDUCTION     127 5501.207732 5501.115275
#&gt; EXTENSION        129 5501.185533 5501.077916
#&gt; REFLECTION       131 5501.182045 5501.066685
#&gt; REFLECTION       133 5501.147121 5501.063789
#&gt; EXTENSION        135 5501.138939 5501.023567
#&gt; LO-REDUCTION     137 5501.126890 5501.023567
#&gt; LO-REDUCTION     139 5501.115275 5501.023567
#&gt; HI-REDUCTION     141 5501.077916 5501.023567
#&gt; EXTENSION        143 5501.066685 5501.012625
#&gt; HI-REDUCTION     145 5501.063789 5501.012625
#&gt; LO-REDUCTION     147 5501.061689 5501.012625
#&gt; REFLECTION       149 5501.059877 5501.005212
#&gt; REFLECTION       151 5501.051679 5500.992361
#&gt; LO-REDUCTION     153 5501.037450 5500.992361
#&gt; LO-REDUCTION     155 5501.023567 5500.992361
#&gt; LO-REDUCTION     157 5501.021675 5500.992361
#&gt; REFLECTION       159 5501.012625 5500.989314
#&gt; EXTENSION        161 5501.005212 5500.957931
#&gt; HI-REDUCTION     163 5501.002373 5500.957931
#&gt; LO-REDUCTION     165 5500.999686 5500.957931
#&gt; LO-REDUCTION     167 5500.995852 5500.957931
#&gt; LO-REDUCTION     169 5500.992361 5500.957931
#&gt; LO-REDUCTION     171 5500.989314 5500.957931
#&gt; LO-REDUCTION     173 5500.988936 5500.957931
#&gt; EXTENSION        175 5500.980383 5500.944812
#&gt; EXTENSION        177 5500.965632 5500.932065
#&gt; EXTENSION        179 5500.963928 5500.910265
#&gt; LO-REDUCTION     181 5500.962104 5500.910265
#&gt; LO-REDUCTION     183 5500.961501 5500.910265
#&gt; EXTENSION        185 5500.957931 5500.893346
#&gt; LO-REDUCTION     187 5500.944812 5500.893346
#&gt; REFLECTION       189 5500.932065 5500.883283
#&gt; LO-REDUCTION     191 5500.924352 5500.883283
#&gt; EXTENSION        193 5500.922971 5500.844814
#&gt; LO-REDUCTION     195 5500.910265 5500.844814
#&gt; LO-REDUCTION     197 5500.894860 5500.844814
#&gt; LO-REDUCTION     199 5500.893346 5500.844814
#&gt; EXTENSION        201 5500.889084 5500.838165
#&gt; REFLECTION       203 5500.883283 5500.836179
#&gt; REFLECTION       205 5500.872015 5500.834453
#&gt; REFLECTION       207 5500.869016 5500.820615
#&gt; EXTENSION        209 5500.845303 5500.792526
#&gt; LO-REDUCTION     211 5500.844814 5500.792526
#&gt; LO-REDUCTION     213 5500.838165 5500.792526
#&gt; LO-REDUCTION     215 5500.836179 5500.792526
#&gt; LO-REDUCTION     217 5500.834453 5500.792526
#&gt; LO-REDUCTION     219 5500.820615 5500.792526
#&gt; LO-REDUCTION     221 5500.812411 5500.792526
#&gt; EXTENSION        223 5500.810623 5500.778549
#&gt; LO-REDUCTION     225 5500.803704 5500.778549
#&gt; LO-REDUCTION     227 5500.803211 5500.778549
#&gt; LO-REDUCTION     229 5500.799205 5500.778549
#&gt; LO-REDUCTION     231 5500.795052 5500.778549
#&gt; REFLECTION       233 5500.792526 5500.775972
#&gt; LO-REDUCTION     235 5500.788476 5500.775972
#&gt; REFLECTION       237 5500.785483 5500.773188
#&gt; LO-REDUCTION     239 5500.783949 5500.773188
#&gt; LO-REDUCTION     241 5500.779625 5500.773188
#&gt; REFLECTION       243 5500.778549 5500.772162
#&gt; LO-REDUCTION     245 5500.778528 5500.772162
#&gt; EXTENSION        247 5500.776793 5500.764150
#&gt; LO-REDUCTION     249 5500.775972 5500.764150
#&gt; LO-REDUCTION     251 5500.773567 5500.764150
#&gt; LO-REDUCTION     253 5500.773188 5500.764150
#&gt; LO-REDUCTION     255 5500.773030 5500.764150
#&gt; EXTENSION        257 5500.772162 5500.751882
#&gt; LO-REDUCTION     259 5500.766933 5500.751882
#&gt; LO-REDUCTION     261 5500.765449 5500.751882
#&gt; EXTENSION        263 5500.764492 5500.746720
#&gt; LO-REDUCTION     265 5500.764302 5500.746720
#&gt; LO-REDUCTION     267 5500.764150 5500.746720
#&gt; EXTENSION        269 5500.757591 5500.728800
#&gt; LO-REDUCTION     271 5500.752982 5500.728800
#&gt; LO-REDUCTION     273 5500.751882 5500.728800
#&gt; LO-REDUCTION     275 5500.749741 5500.728800
#&gt; LO-REDUCTION     277 5500.747597 5500.728800
#&gt; EXTENSION        279 5500.746720 5500.721768
#&gt; EXTENSION        281 5500.734017 5500.710963
#&gt; LO-REDUCTION     283 5500.733233 5500.710963
#&gt; LO-REDUCTION     285 5500.731096 5500.710963
#&gt; LO-REDUCTION     287 5500.730704 5500.710963
#&gt; EXTENSION        289 5500.728800 5500.701601
#&gt; LO-REDUCTION     291 5500.721768 5500.701601
#&gt; LO-REDUCTION     293 5500.717883 5500.701601
#&gt; LO-REDUCTION     295 5500.717824 5500.701601
#&gt; REFLECTION       297 5500.714974 5500.700463
#&gt; LO-REDUCTION     299 5500.712103 5500.700463
#&gt; EXTENSION        301 5500.710963 5500.695739
#&gt; REFLECTION       303 5500.708389 5500.695119
#&gt; EXTENSION        305 5500.705527 5500.692788
#&gt; EXTENSION        307 5500.701815 5500.674964
#&gt; LO-REDUCTION     309 5500.701601 5500.674964
#&gt; LO-REDUCTION     311 5500.700463 5500.674964
#&gt; LO-REDUCTION     313 5500.695739 5500.674964
#&gt; LO-REDUCTION     315 5500.695119 5500.674964
#&gt; LO-REDUCTION     317 5500.692788 5500.674964
#&gt; EXTENSION        319 5500.688555 5500.659919
#&gt; LO-REDUCTION     321 5500.683529 5500.659919
#&gt; LO-REDUCTION     323 5500.682281 5500.659919
#&gt; EXTENSION        325 5500.677263 5500.648006
#&gt; LO-REDUCTION     327 5500.675113 5500.648006
#&gt; LO-REDUCTION     329 5500.674964 5500.648006
#&gt; REFLECTION       331 5500.666697 5500.645927
#&gt; EXTENSION        333 5500.660684 5500.634842
#&gt; LO-REDUCTION     335 5500.659919 5500.634842
#&gt; LO-REDUCTION     337 5500.653695 5500.634842
#&gt; LO-REDUCTION     339 5500.650529 5500.634842
#&gt; LO-REDUCTION     341 5500.648006 5500.634842
#&gt; LO-REDUCTION     343 5500.645927 5500.634842
#&gt; LO-REDUCTION     345 5500.645132 5500.634842
#&gt; REFLECTION       347 5500.637933 5500.632229
#&gt; LO-REDUCTION     349 5500.637573 5500.632229
#&gt; LO-REDUCTION     351 5500.637066 5500.632229
#&gt; EXTENSION        353 5500.636756 5500.629458
#&gt; EXTENSION        355 5500.635510 5500.625061
#&gt; LO-REDUCTION     357 5500.634842 5500.625061
#&gt; LO-REDUCTION     359 5500.634369 5500.625061
#&gt; LO-REDUCTION     361 5500.633831 5500.625061
#&gt; LO-REDUCTION     363 5500.632229 5500.625061
#&gt; EXTENSION        365 5500.629458 5500.618260
#&gt; LO-REDUCTION     367 5500.628811 5500.618260
#&gt; LO-REDUCTION     369 5500.627002 5500.618260
#&gt; LO-REDUCTION     371 5500.626689 5500.618260
#&gt; REFLECTION       373 5500.625758 5500.617895
#&gt; EXTENSION        375 5500.625061 5500.614202
#&gt; EXTENSION        377 5500.620785 5500.611891
#&gt; LO-REDUCTION     379 5500.620622 5500.611891
#&gt; REFLECTION       381 5500.618526 5500.610585
#&gt; LO-REDUCTION     383 5500.618260 5500.610585
#&gt; REFLECTION       385 5500.617895 5500.609741
#&gt; REFLECTION       387 5500.614202 5500.609254
#&gt; HI-REDUCTION     389 5500.613877 5500.609254
#&gt; REFLECTION       391 5500.611891 5500.607297
#&gt; LO-REDUCTION     393 5500.611550 5500.607297
#&gt; REFLECTION       395 5500.610735 5500.607135
#&gt; LO-REDUCTION     397 5500.610585 5500.607135
#&gt; LO-REDUCTION     399 5500.609741 5500.607135
#&gt; LO-REDUCTION     401 5500.609264 5500.607135
#&gt; LO-REDUCTION     403 5500.609254 5500.607135
#&gt; REFLECTION       405 5500.608308 5500.606899
#&gt; EXTENSION        407 5500.608150 5500.605953
#&gt; EXTENSION        409 5500.607941 5500.605500
#&gt; EXTENSION        411 5500.607896 5500.604005
#&gt; LO-REDUCTION     413 5500.607297 5500.604005
#&gt; EXTENSION        415 5500.607135 5500.602780
#&gt; EXTENSION        417 5500.606899 5500.600137
#&gt; LO-REDUCTION     419 5500.605953 5500.600137
#&gt; LO-REDUCTION     421 5500.605500 5500.600137
#&gt; EXTENSION        423 5500.604874 5500.598245
#&gt; EXTENSION        425 5500.604005 5500.593735
#&gt; LO-REDUCTION     427 5500.602780 5500.593735
#&gt; EXTENSION        429 5500.600878 5500.589738
#&gt; LO-REDUCTION     431 5500.600382 5500.589738
#&gt; EXTENSION        433 5500.600137 5500.585960
#&gt; LO-REDUCTION     435 5500.598245 5500.585960
#&gt; EXTENSION        437 5500.594783 5500.577962
#&gt; LO-REDUCTION     439 5500.593735 5500.577962
#&gt; LO-REDUCTION     441 5500.591674 5500.577962
#&gt; LO-REDUCTION     443 5500.589738 5500.577962
#&gt; LO-REDUCTION     445 5500.588586 5500.577962
#&gt; REFLECTION       447 5500.585960 5500.574543
#&gt; REFLECTION       449 5500.580863 5500.574279
#&gt; LO-REDUCTION     451 5500.579985 5500.574279
#&gt; LO-REDUCTION     453 5500.579542 5500.574279
#&gt; REFLECTION       455 5500.579009 5500.572685
#&gt; LO-REDUCTION     457 5500.577962 5500.572685
#&gt; EXTENSION        459 5500.574841 5500.569711
#&gt; LO-REDUCTION     461 5500.574732 5500.569711
#&gt; LO-REDUCTION     463 5500.574543 5500.569711
#&gt; LO-REDUCTION     465 5500.574279 5500.569711
#&gt; EXTENSION        467 5500.573980 5500.566835
#&gt; EXTENSION        469 5500.572685 5500.564221
#&gt; LO-REDUCTION     471 5500.571718 5500.564221
#&gt; LO-REDUCTION     473 5500.571112 5500.564221
#&gt; EXTENSION        475 5500.570477 5500.561989
#&gt; LO-REDUCTION     477 5500.569711 5500.561989
#&gt; EXTENSION        479 5500.568293 5500.559035
#&gt; EXTENSION        481 5500.566835 5500.554084
#&gt; LO-REDUCTION     483 5500.565120 5500.554084
#&gt; LO-REDUCTION     485 5500.564221 5500.554084
#&gt; LO-REDUCTION     487 5500.563731 5500.554084
#&gt; LO-REDUCTION     489 5500.561989 5500.554084
#&gt; LO-REDUCTION     491 5500.559441 5500.554084
#&gt; HI-REDUCTION     493 5500.559423 5500.554084
#&gt; LO-REDUCTION     495 5500.559035 5500.554084
#&gt; EXTENSION        497 5500.558853 5500.553249
#&gt; EXTENSION        499 5500.557525 5500.548540
#&gt; LO-REDUCTION     501 5500.556498 5500.548540
#&gt; LO-REDUCTION     503 5500.556205 5500.548540
#&gt; EXTENSION        505 5500.554852 5500.544863
#&gt; LO-REDUCTION     507 5500.554084 5500.544863
#&gt; LO-REDUCTION     509 5500.553249 5500.544863
#&gt; LO-REDUCTION     511 5500.552247 5500.544863
#&gt; EXTENSION        513 5500.549338 5500.538954
#&gt; LO-REDUCTION     515 5500.548540 5500.538954
#&gt; LO-REDUCTION     517 5500.547536 5500.538954
#&gt; LO-REDUCTION     519 5500.547438 5500.538954
#&gt; LO-REDUCTION     521 5500.545515 5500.538954
#&gt; LO-REDUCTION     523 5500.544863 5500.538954
#&gt; EXTENSION        525 5500.543699 5500.537428
#&gt; REFLECTION       527 5500.543486 5500.536694
#&gt; EXTENSION        529 5500.540286 5500.534175
#&gt; LO-REDUCTION     531 5500.539731 5500.534175
#&gt; LO-REDUCTION     533 5500.539607 5500.534175
#&gt; LO-REDUCTION     535 5500.538954 5500.534175
#&gt; HI-REDUCTION     537 5500.537428 5500.534175
#&gt; LO-REDUCTION     539 5500.537004 5500.534175
#&gt; EXTENSION        541 5500.536694 5500.531947
#&gt; LO-REDUCTION     543 5500.536134 5500.531947
#&gt; LO-REDUCTION     545 5500.535308 5500.531947
#&gt; LO-REDUCTION     547 5500.535040 5500.531947
#&gt; LO-REDUCTION     549 5500.534693 5500.531947
#&gt; LO-REDUCTION     551 5500.534175 5500.531947
#&gt; EXTENSION        553 5500.534025 5500.531477
#&gt; EXTENSION        555 5500.533571 5500.531301
#&gt; EXTENSION        557 5500.533532 5500.528833
#&gt; LO-REDUCTION     559 5500.532816 5500.528833
#&gt; LO-REDUCTION     561 5500.532391 5500.528833
#&gt; LO-REDUCTION     563 5500.531947 5500.528833
#&gt; LO-REDUCTION     565 5500.531477 5500.528833
#&gt; LO-REDUCTION     567 5500.531301 5500.528833
#&gt; EXTENSION        569 5500.530411 5500.527281
#&gt; LO-REDUCTION     571 5500.530313 5500.527281
#&gt; LO-REDUCTION     573 5500.530252 5500.527281
#&gt; EXTENSION        575 5500.529909 5500.525777
#&gt; LO-REDUCTION     577 5500.529612 5500.525777
#&gt; LO-REDUCTION     579 5500.528833 5500.525777
#&gt; REFLECTION       581 5500.528334 5500.525642
#&gt; EXTENSION        583 5500.527757 5500.522827
#&gt; LO-REDUCTION     585 5500.527281 5500.522827
#&gt; LO-REDUCTION     587 5500.526060 5500.522827
#&gt; LO-REDUCTION     589 5500.525849 5500.522827
#&gt; LO-REDUCTION     591 5500.525777 5500.522827
#&gt; LO-REDUCTION     593 5500.525642 5500.522827
#&gt; EXTENSION        595 5500.524025 5500.522154
#&gt; LO-REDUCTION     597 5500.523999 5500.522154
#&gt; REFLECTION       599 5500.523950 5500.522125
#&gt; REFLECTION       601 5500.523684 5500.521616
#&gt; REFLECTION       603 5500.523397 5500.521306
#&gt; EXTENSION        605 5500.522827 5500.520434
#&gt; HI-REDUCTION     607 5500.522672 5500.520434
#&gt; REFLECTION       609 5500.522154 5500.520425
#&gt; EXTENSION        611 5500.522125 5500.519713
#&gt; LO-REDUCTION     613 5500.521620 5500.519713
#&gt; LO-REDUCTION     615 5500.521616 5500.519713
#&gt; REFLECTION       617 5500.521306 5500.519075
#&gt; EXTENSION        619 5500.520434 5500.517486
#&gt; LO-REDUCTION     621 5500.520425 5500.517486
#&gt; LO-REDUCTION     623 5500.519927 5500.517486
#&gt; LO-REDUCTION     625 5500.519899 5500.517486
#&gt; REFLECTION       627 5500.519713 5500.517251
#&gt; LO-REDUCTION     629 5500.519075 5500.517251
#&gt; REFLECTION       631 5500.518376 5500.516775
#&gt; REFLECTION       633 5500.517798 5500.516684
#&gt; LO-REDUCTION     635 5500.517662 5500.516684
#&gt; REFLECTION       637 5500.517486 5500.516524
#&gt; LO-REDUCTION     639 5500.517342 5500.516524
#&gt; LO-REDUCTION     641 5500.517251 5500.516524
#&gt; REFLECTION       643 5500.516810 5500.516504
#&gt; REFLECTION       645 5500.516775 5500.516399
#&gt; HI-REDUCTION     647 5500.516772 5500.516399
#&gt; REFLECTION       649 5500.516684 5500.516286
#&gt; LO-REDUCTION     651 5500.516541 5500.516286
#&gt; HI-REDUCTION     653 5500.516524 5500.516286
#&gt; LO-REDUCTION     655 5500.516504 5500.516248
#&gt; LO-REDUCTION     657 5500.516460 5500.516248
#&gt; LO-REDUCTION     659 5500.516399 5500.516210
#&gt; LO-REDUCTION     661 5500.516327 5500.516204
#&gt; REFLECTION       663 5500.516288 5500.516174
#&gt; REFLECTION       665 5500.516286 5500.516118
#&gt; HI-REDUCTION     667 5500.516271 5500.516118
#&gt; HI-REDUCTION     669 5500.516248 5500.516118
#&gt; LO-REDUCTION     671 5500.516210 5500.516118
#&gt; Exiting from Nelder Mead minimizer
#&gt;     673 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0611533   1.4898648  -3.0249108  -0.9779015  -0.5047302   0.3207413 
#&gt; 
#&gt; $value
#&gt; [1] 5500.516
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      673 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.41 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==============                                                        |  20%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6207.473021
#&gt;   Scaled convergence tolerance is 9.24986e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11904.892337 5778.962658
#&gt; LO-REDUCTION       9 8018.568909 5778.962658
#&gt; LO-REDUCTION      11 7755.875272 5778.962658
#&gt; REFLECTION        13 6947.799271 5767.107347
#&gt; LO-REDUCTION      15 6719.944664 5767.107347
#&gt; LO-REDUCTION      17 6512.063210 5767.107347
#&gt; REFLECTION        19 6429.080989 5730.030331
#&gt; REFLECTION        21 6207.473021 5553.920588
#&gt; LO-REDUCTION      23 6007.028072 5553.920588
#&gt; LO-REDUCTION      25 5996.618987 5553.920588
#&gt; LO-REDUCTION      27 5778.962658 5553.920588
#&gt; HI-REDUCTION      29 5767.107347 5553.920588
#&gt; LO-REDUCTION      31 5730.030331 5553.920588
#&gt; LO-REDUCTION      33 5618.941767 5547.112120
#&gt; LO-REDUCTION      35 5609.332186 5547.112120
#&gt; LO-REDUCTION      37 5570.737587 5547.112120
#&gt; HI-REDUCTION      39 5567.845863 5547.023517
#&gt; HI-REDUCTION      41 5555.388291 5545.347940
#&gt; REFLECTION        43 5553.920588 5540.191799
#&gt; HI-REDUCTION      45 5553.373267 5540.191799
#&gt; HI-REDUCTION      47 5548.766836 5540.191799
#&gt; HI-REDUCTION      49 5547.112120 5540.191799
#&gt; HI-REDUCTION      51 5547.023517 5540.191799
#&gt; LO-REDUCTION      53 5545.347940 5540.191799
#&gt; LO-REDUCTION      55 5542.692795 5538.730370
#&gt; LO-REDUCTION      57 5542.503547 5538.108756
#&gt; LO-REDUCTION      59 5541.353078 5538.108756
#&gt; REFLECTION        61 5541.220342 5538.040567
#&gt; LO-REDUCTION      63 5540.462690 5537.849463
#&gt; REFLECTION        65 5540.191799 5537.798072
#&gt; LO-REDUCTION      67 5538.730370 5537.212048
#&gt; HI-REDUCTION      69 5538.541455 5537.183368
#&gt; LO-REDUCTION      71 5538.108756 5536.870522
#&gt; EXTENSION         73 5538.040567 5535.694850
#&gt; LO-REDUCTION      75 5537.849463 5535.694850
#&gt; LO-REDUCTION      77 5537.798072 5535.694850
#&gt; HI-REDUCTION      79 5537.212048 5535.694850
#&gt; LO-REDUCTION      81 5537.183368 5535.694850
#&gt; LO-REDUCTION      83 5536.870522 5535.694850
#&gt; LO-REDUCTION      85 5536.667263 5535.694850
#&gt; REFLECTION        87 5536.427944 5535.446435
#&gt; LO-REDUCTION      89 5536.266328 5535.446435
#&gt; EXTENSION         91 5535.989125 5534.320836
#&gt; LO-REDUCTION      93 5535.918359 5534.320836
#&gt; LO-REDUCTION      95 5535.830305 5534.320836
#&gt; HI-REDUCTION      97 5535.694850 5534.320836
#&gt; LO-REDUCTION      99 5535.449019 5534.320836
#&gt; LO-REDUCTION     101 5535.446435 5534.320836
#&gt; LO-REDUCTION     103 5535.115365 5534.320836
#&gt; REFLECTION       105 5534.760717 5534.038326
#&gt; LO-REDUCTION     107 5534.681306 5534.038326
#&gt; LO-REDUCTION     109 5534.603165 5534.038326
#&gt; REFLECTION       111 5534.386677 5534.019596
#&gt; REFLECTION       113 5534.326070 5533.987141
#&gt; LO-REDUCTION     115 5534.320836 5533.987141
#&gt; REFLECTION       117 5534.294114 5533.986905
#&gt; LO-REDUCTION     119 5534.173377 5533.936296
#&gt; LO-REDUCTION     121 5534.038326 5533.936296
#&gt; EXTENSION        123 5534.019596 5533.859441
#&gt; REFLECTION       125 5533.992849 5533.817755
#&gt; LO-REDUCTION     127 5533.987141 5533.817755
#&gt; LO-REDUCTION     129 5533.986905 5533.817755
#&gt; LO-REDUCTION     131 5533.940341 5533.817755
#&gt; EXTENSION        133 5533.936296 5533.716495
#&gt; LO-REDUCTION     135 5533.865018 5533.716495
#&gt; LO-REDUCTION     137 5533.864244 5533.716495
#&gt; LO-REDUCTION     139 5533.859441 5533.716495
#&gt; LO-REDUCTION     141 5533.851726 5533.716495
#&gt; LO-REDUCTION     143 5533.817755 5533.716495
#&gt; LO-REDUCTION     145 5533.789340 5533.716495
#&gt; LO-REDUCTION     147 5533.785163 5533.716495
#&gt; EXTENSION        149 5533.776718 5533.688160
#&gt; LO-REDUCTION     151 5533.759260 5533.688160
#&gt; EXTENSION        153 5533.752354 5533.673314
#&gt; LO-REDUCTION     155 5533.749120 5533.673314
#&gt; REFLECTION       157 5533.734934 5533.660975
#&gt; EXTENSION        159 5533.716495 5533.583731
#&gt; LO-REDUCTION     161 5533.714726 5533.583731
#&gt; EXTENSION        163 5533.688160 5533.529332
#&gt; LO-REDUCTION     165 5533.683810 5533.529332
#&gt; EXTENSION        167 5533.673314 5533.437945
#&gt; LO-REDUCTION     169 5533.660975 5533.437945
#&gt; EXTENSION        171 5533.606065 5533.380582
#&gt; EXTENSION        173 5533.583731 5533.295773
#&gt; LO-REDUCTION     175 5533.580414 5533.295773
#&gt; LO-REDUCTION     177 5533.529332 5533.295773
#&gt; EXTENSION        179 5533.518154 5533.152899
#&gt; LO-REDUCTION     181 5533.437945 5533.152899
#&gt; LO-REDUCTION     183 5533.380582 5533.152899
#&gt; LO-REDUCTION     185 5533.364166 5533.152899
#&gt; EXTENSION        187 5533.318420 5533.085767
#&gt; LO-REDUCTION     189 5533.295773 5533.085767
#&gt; LO-REDUCTION     191 5533.282481 5533.085767
#&gt; EXTENSION        193 5533.192021 5532.996744
#&gt; EXTENSION        195 5533.178859 5532.916839
#&gt; LO-REDUCTION     197 5533.152899 5532.916839
#&gt; LO-REDUCTION     199 5533.138365 5532.916839
#&gt; EXTENSION        201 5533.131731 5532.779281
#&gt; LO-REDUCTION     203 5533.085767 5532.779281
#&gt; LO-REDUCTION     205 5533.008215 5532.779281
#&gt; EXTENSION        207 5532.996744 5532.760061
#&gt; LO-REDUCTION     209 5532.993168 5532.760061
#&gt; EXTENSION        211 5532.916839 5532.656317
#&gt; LO-REDUCTION     213 5532.858676 5532.656317
#&gt; LO-REDUCTION     215 5532.843479 5532.656317
#&gt; LO-REDUCTION     217 5532.791590 5532.656317
#&gt; LO-REDUCTION     219 5532.779281 5532.656317
#&gt; HI-REDUCTION     221 5532.760061 5532.656317
#&gt; REFLECTION       223 5532.740723 5532.645769
#&gt; EXTENSION        225 5532.704275 5532.599187
#&gt; LO-REDUCTION     227 5532.703962 5532.599187
#&gt; LO-REDUCTION     229 5532.694759 5532.599187
#&gt; LO-REDUCTION     231 5532.674131 5532.599187
#&gt; LO-REDUCTION     233 5532.656317 5532.599187
#&gt; LO-REDUCTION     235 5532.645769 5532.596439
#&gt; REFLECTION       237 5532.630905 5532.595237
#&gt; REFLECTION       239 5532.612905 5532.588525
#&gt; LO-REDUCTION     241 5532.606421 5532.588525
#&gt; LO-REDUCTION     243 5532.601940 5532.585468
#&gt; HI-REDUCTION     245 5532.599187 5532.585468
#&gt; HI-REDUCTION     247 5532.596439 5532.585468
#&gt; LO-REDUCTION     249 5532.595237 5532.585468
#&gt; LO-REDUCTION     251 5532.592285 5532.585126
#&gt; EXTENSION        253 5532.589439 5532.578695
#&gt; EXTENSION        255 5532.588978 5532.574052
#&gt; LO-REDUCTION     257 5532.588525 5532.574052
#&gt; LO-REDUCTION     259 5532.586314 5532.574052
#&gt; LO-REDUCTION     261 5532.585468 5532.574052
#&gt; REFLECTION       263 5532.585126 5532.572938
#&gt; EXTENSION        265 5532.578695 5532.557511
#&gt; LO-REDUCTION     267 5532.578416 5532.557511
#&gt; LO-REDUCTION     269 5532.578382 5532.557511
#&gt; LO-REDUCTION     271 5532.576463 5532.557511
#&gt; LO-REDUCTION     273 5532.574052 5532.557511
#&gt; LO-REDUCTION     275 5532.572938 5532.557511
#&gt; EXTENSION        277 5532.569874 5532.553525
#&gt; LO-REDUCTION     279 5532.568278 5532.553525
#&gt; EXTENSION        281 5532.567446 5532.546482
#&gt; LO-REDUCTION     283 5532.562834 5532.546482
#&gt; LO-REDUCTION     285 5532.560755 5532.546482
#&gt; LO-REDUCTION     287 5532.557511 5532.546482
#&gt; LO-REDUCTION     289 5532.557333 5532.546482
#&gt; REFLECTION       291 5532.553525 5532.543769
#&gt; LO-REDUCTION     293 5532.549548 5532.543769
#&gt; LO-REDUCTION     295 5532.548643 5532.543769
#&gt; EXTENSION        297 5532.548298 5532.538528
#&gt; LO-REDUCTION     299 5532.546825 5532.538528
#&gt; LO-REDUCTION     301 5532.546482 5532.538528
#&gt; LO-REDUCTION     303 5532.545007 5532.538528
#&gt; LO-REDUCTION     305 5532.544824 5532.538528
#&gt; EXTENSION        307 5532.543769 5532.535359
#&gt; EXTENSION        309 5532.542307 5532.531757
#&gt; EXTENSION        311 5532.539850 5532.529864
#&gt; EXTENSION        313 5532.539276 5532.528353
#&gt; LO-REDUCTION     315 5532.539147 5532.528353
#&gt; LO-REDUCTION     317 5532.538528 5532.528353
#&gt; LO-REDUCTION     319 5532.535359 5532.528353
#&gt; REFLECTION       321 5532.531757 5532.526175
#&gt; REFLECTION       323 5532.530811 5532.525616
#&gt; REFLECTION       325 5532.529864 5532.524980
#&gt; HI-REDUCTION     327 5532.528397 5532.524980
#&gt; EXTENSION        329 5532.528380 5532.523867
#&gt; EXTENSION        331 5532.528353 5532.522516
#&gt; LO-REDUCTION     333 5532.526815 5532.522516
#&gt; LO-REDUCTION     335 5532.526175 5532.522516
#&gt; LO-REDUCTION     337 5532.525616 5532.522516
#&gt; REFLECTION       339 5532.524980 5532.521864
#&gt; HI-REDUCTION     341 5532.524578 5532.521864
#&gt; LO-REDUCTION     343 5532.523867 5532.521864
#&gt; LO-REDUCTION     345 5532.523232 5532.521841
#&gt; REFLECTION       347 5532.522957 5532.521673
#&gt; HI-REDUCTION     349 5532.522914 5532.521673
#&gt; REFLECTION       351 5532.522516 5532.521411
#&gt; REFLECTION       353 5532.522041 5532.521006
#&gt; LO-REDUCTION     355 5532.521938 5532.521006
#&gt; LO-REDUCTION     357 5532.521864 5532.521006
#&gt; EXTENSION        359 5532.521841 5532.520341
#&gt; LO-REDUCTION     361 5532.521673 5532.520341
#&gt; REFLECTION       363 5532.521417 5532.520293
#&gt; EXTENSION        365 5532.521411 5532.519912
#&gt; REFLECTION       367 5532.521214 5532.519816
#&gt; EXTENSION        369 5532.521006 5532.518837
#&gt; EXTENSION        371 5532.520440 5532.518203
#&gt; LO-REDUCTION     373 5532.520341 5532.518203
#&gt; REFLECTION       375 5532.520293 5532.518128
#&gt; LO-REDUCTION     377 5532.519912 5532.518128
#&gt; EXTENSION        379 5532.519816 5532.517441
#&gt; EXTENSION        381 5532.518837 5532.516782
#&gt; REFLECTION       383 5532.518826 5532.516640
#&gt; REFLECTION       385 5532.518482 5532.516066
#&gt; EXTENSION        387 5532.518203 5532.514435
#&gt; LO-REDUCTION     389 5532.518128 5532.514435
#&gt; LO-REDUCTION     391 5532.517441 5532.514435
#&gt; HI-REDUCTION     393 5532.516782 5532.514435
#&gt; EXTENSION        395 5532.516640 5532.513030
#&gt; LO-REDUCTION     397 5532.516066 5532.513030
#&gt; EXTENSION        399 5532.515717 5532.512760
#&gt; EXTENSION        401 5532.515444 5532.511688
#&gt; EXTENSION        403 5532.514771 5532.507860
#&gt; LO-REDUCTION     405 5532.514435 5532.507860
#&gt; LO-REDUCTION     407 5532.513498 5532.507860
#&gt; LO-REDUCTION     409 5532.513030 5532.507860
#&gt; LO-REDUCTION     411 5532.512760 5532.507860
#&gt; EXTENSION        413 5532.511688 5532.506363
#&gt; LO-REDUCTION     415 5532.510931 5532.506363
#&gt; EXTENSION        417 5532.509889 5532.503738
#&gt; LO-REDUCTION     419 5532.509865 5532.503738
#&gt; EXTENSION        421 5532.508273 5532.502107
#&gt; EXTENSION        423 5532.507860 5532.498872
#&gt; LO-REDUCTION     425 5532.507253 5532.498872
#&gt; LO-REDUCTION     427 5532.506363 5532.498872
#&gt; LO-REDUCTION     429 5532.504897 5532.498872
#&gt; EXTENSION        431 5532.503738 5532.498111
#&gt; LO-REDUCTION     433 5532.502107 5532.498111
#&gt; LO-REDUCTION     435 5532.501908 5532.498111
#&gt; EXTENSION        437 5532.500646 5532.496484
#&gt; LO-REDUCTION     439 5532.500588 5532.496484
#&gt; LO-REDUCTION     441 5532.500269 5532.496484
#&gt; REFLECTION       443 5532.498872 5532.496293
#&gt; HI-REDUCTION     445 5532.498817 5532.496293
#&gt; LO-REDUCTION     447 5532.498264 5532.496293
#&gt; EXTENSION        449 5532.498111 5532.493650
#&gt; LO-REDUCTION     451 5532.497343 5532.493650
#&gt; LO-REDUCTION     453 5532.497079 5532.493650
#&gt; LO-REDUCTION     455 5532.496853 5532.493650
#&gt; EXTENSION        457 5532.496484 5532.493027
#&gt; REFLECTION       459 5532.496293 5532.493003
#&gt; EXTENSION        461 5532.495413 5532.492134
#&gt; REFLECTION       463 5532.494726 5532.491494
#&gt; EXTENSION        465 5532.494422 5532.490797
#&gt; LO-REDUCTION     467 5532.493650 5532.490797
#&gt; LO-REDUCTION     469 5532.493027 5532.490797
#&gt; EXTENSION        471 5532.493003 5532.488094
#&gt; LO-REDUCTION     473 5532.492134 5532.488094
#&gt; LO-REDUCTION     475 5532.491494 5532.488094
#&gt; LO-REDUCTION     477 5532.491326 5532.488094
#&gt; LO-REDUCTION     479 5532.490799 5532.488094
#&gt; LO-REDUCTION     481 5532.490797 5532.488094
#&gt; LO-REDUCTION     483 5532.490187 5532.488094
#&gt; LO-REDUCTION     485 5532.489977 5532.488094
#&gt; LO-REDUCTION     487 5532.489882 5532.488094
#&gt; EXTENSION        489 5532.489115 5532.486038
#&gt; LO-REDUCTION     491 5532.488793 5532.486038
#&gt; LO-REDUCTION     493 5532.488654 5532.486038
#&gt; LO-REDUCTION     495 5532.488469 5532.486038
#&gt; LO-REDUCTION     497 5532.488343 5532.486038
#&gt; EXTENSION        499 5532.488094 5532.484773
#&gt; EXTENSION        501 5532.487316 5532.483619
#&gt; LO-REDUCTION     503 5532.486960 5532.483619
#&gt; EXTENSION        505 5532.486424 5532.482266
#&gt; LO-REDUCTION     507 5532.486047 5532.482266
#&gt; LO-REDUCTION     509 5532.486038 5532.482266
#&gt; LO-REDUCTION     511 5532.484773 5532.482266
#&gt; REFLECTION       513 5532.484026 5532.481837
#&gt; LO-REDUCTION     515 5532.483623 5532.481837
#&gt; LO-REDUCTION     517 5532.483619 5532.481837
#&gt; LO-REDUCTION     519 5532.482651 5532.481819
#&gt; EXTENSION        521 5532.482578 5532.481371
#&gt; EXTENSION        523 5532.482567 5532.480879
#&gt; EXTENSION        525 5532.482266 5532.480391
#&gt; LO-REDUCTION     527 5532.481913 5532.480391
#&gt; EXTENSION        529 5532.481837 5532.480074
#&gt; EXTENSION        531 5532.481819 5532.478802
#&gt; LO-REDUCTION     533 5532.481371 5532.478802
#&gt; LO-REDUCTION     535 5532.480940 5532.478802
#&gt; LO-REDUCTION     537 5532.480879 5532.478802
#&gt; LO-REDUCTION     539 5532.480391 5532.478802
#&gt; LO-REDUCTION     541 5532.480074 5532.478802
#&gt; REFLECTION       543 5532.480069 5532.478791
#&gt; EXTENSION        545 5532.479396 5532.477474
#&gt; LO-REDUCTION     547 5532.479351 5532.477474
#&gt; LO-REDUCTION     549 5532.479085 5532.477474
#&gt; LO-REDUCTION     551 5532.479075 5532.477474
#&gt; LO-REDUCTION     553 5532.478802 5532.477474
#&gt; LO-REDUCTION     555 5532.478791 5532.477474
#&gt; EXTENSION        557 5532.478521 5532.477277
#&gt; EXTENSION        559 5532.478226 5532.477217
#&gt; LO-REDUCTION     561 5532.478212 5532.477217
#&gt; REFLECTION       563 5532.478071 5532.476863
#&gt; EXTENSION        565 5532.477566 5532.476465
#&gt; LO-REDUCTION     567 5532.477474 5532.476465
#&gt; HI-REDUCTION     569 5532.477277 5532.476465
#&gt; LO-REDUCTION     571 5532.477274 5532.476465
#&gt; LO-REDUCTION     573 5532.477217 5532.476465
#&gt; EXTENSION        575 5532.476949 5532.476177
#&gt; LO-REDUCTION     577 5532.476871 5532.476177
#&gt; LO-REDUCTION     579 5532.476863 5532.476177
#&gt; LO-REDUCTION     581 5532.476682 5532.476177
#&gt; LO-REDUCTION     583 5532.476659 5532.476177
#&gt; LO-REDUCTION     585 5532.476588 5532.476177
#&gt; EXTENSION        587 5532.476465 5532.476040
#&gt; LO-REDUCTION     589 5532.476349 5532.476040
#&gt; EXTENSION        591 5532.476298 5532.475947
#&gt; LO-REDUCTION     593 5532.476229 5532.475947
#&gt; HI-REDUCTION     595 5532.476216 5532.475947
#&gt; LO-REDUCTION     597 5532.476177 5532.475947
#&gt; LO-REDUCTION     599 5532.476116 5532.475947
#&gt; REFLECTION       601 5532.476073 5532.475922
#&gt; HI-REDUCTION     603 5532.476040 5532.475922
#&gt; HI-REDUCTION     605 5532.476039 5532.475922
#&gt; EXTENSION        607 5532.476027 5532.475873
#&gt; EXTENSION        609 5532.475981 5532.475808
#&gt; LO-REDUCTION     611 5532.475979 5532.475808
#&gt; LO-REDUCTION     613 5532.475970 5532.475808
#&gt; LO-REDUCTION     615 5532.475947 5532.475808
#&gt; LO-REDUCTION     617 5532.475922 5532.475808
#&gt; Exiting from Nelder Mead minimizer
#&gt;     619 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0175191   1.4870102  -2.9962856  -0.9725363  -0.5348829   0.3263247 
#&gt; 
#&gt; $value
#&gt; [1] 5532.476
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      619 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.34 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=====================                                                 |  30%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6123.451738
#&gt;   Scaled convergence tolerance is 9.12465e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11701.321369 5729.144144
#&gt; LO-REDUCTION       9 7873.998431 5729.144144
#&gt; LO-REDUCTION      11 7531.069852 5729.144144
#&gt; LO-REDUCTION      13 6887.942147 5729.144144
#&gt; LO-REDUCTION      15 6606.933236 5729.144144
#&gt; LO-REDUCTION      17 6408.587236 5729.144144
#&gt; REFLECTION        19 6336.198644 5702.681606
#&gt; REFLECTION        21 6123.451738 5519.724524
#&gt; LO-REDUCTION      23 5934.545834 5519.724524
#&gt; LO-REDUCTION      25 5932.141141 5519.724524
#&gt; LO-REDUCTION      27 5733.187806 5519.724524
#&gt; LO-REDUCTION      29 5729.144144 5519.724524
#&gt; LO-REDUCTION      31 5702.681606 5519.724524
#&gt; LO-REDUCTION      33 5590.273631 5519.724524
#&gt; LO-REDUCTION      35 5562.814748 5518.845232
#&gt; HI-REDUCTION      37 5553.861833 5518.845232
#&gt; LO-REDUCTION      39 5546.241531 5518.845232
#&gt; HI-REDUCTION      41 5523.867224 5518.845232
#&gt; HI-REDUCTION      43 5523.797691 5515.689518
#&gt; HI-REDUCTION      45 5523.375501 5515.319934
#&gt; LO-REDUCTION      47 5522.698346 5513.812308
#&gt; LO-REDUCTION      49 5519.724524 5513.427689
#&gt; HI-REDUCTION      51 5519.566802 5513.427689
#&gt; LO-REDUCTION      53 5518.845232 5513.427689
#&gt; LO-REDUCTION      55 5515.689518 5512.137373
#&gt; LO-REDUCTION      57 5515.319934 5511.825223
#&gt; HI-REDUCTION      59 5513.920301 5511.825223
#&gt; REFLECTION        61 5513.812308 5511.676922
#&gt; HI-REDUCTION      63 5513.465398 5511.676922
#&gt; HI-REDUCTION      65 5513.427689 5511.676922
#&gt; LO-REDUCTION      67 5512.289353 5511.548320
#&gt; REFLECTION        69 5512.137373 5510.942136
#&gt; HI-REDUCTION      71 5511.837899 5510.942136
#&gt; LO-REDUCTION      73 5511.825223 5510.882750
#&gt; HI-REDUCTION      75 5511.778480 5510.882750
#&gt; LO-REDUCTION      77 5511.676922 5510.866060
#&gt; LO-REDUCTION      79 5511.548320 5510.866060
#&gt; LO-REDUCTION      81 5511.296147 5510.852771
#&gt; REFLECTION        83 5511.097795 5510.541562
#&gt; LO-REDUCTION      85 5511.013676 5510.541562
#&gt; REFLECTION        87 5510.942136 5510.436080
#&gt; LO-REDUCTION      89 5510.882750 5510.436080
#&gt; LO-REDUCTION      91 5510.866060 5510.436080
#&gt; LO-REDUCTION      93 5510.852771 5510.436080
#&gt; REFLECTION        95 5510.603326 5510.268747
#&gt; LO-REDUCTION      97 5510.598127 5510.268747
#&gt; LO-REDUCTION      99 5510.549211 5510.268747
#&gt; LO-REDUCTION     101 5510.541562 5510.268747
#&gt; LO-REDUCTION     103 5510.449908 5510.260725
#&gt; LO-REDUCTION     105 5510.436080 5510.259257
#&gt; LO-REDUCTION     107 5510.393167 5510.234363
#&gt; LO-REDUCTION     109 5510.308715 5510.234363
#&gt; LO-REDUCTION     111 5510.292637 5510.234363
#&gt; LO-REDUCTION     113 5510.268747 5510.232589
#&gt; REFLECTION       115 5510.260725 5510.220541
#&gt; LO-REDUCTION     117 5510.259257 5510.220541
#&gt; EXTENSION        119 5510.247421 5510.188808
#&gt; LO-REDUCTION     121 5510.241840 5510.188808
#&gt; LO-REDUCTION     123 5510.234363 5510.188808
#&gt; LO-REDUCTION     125 5510.232589 5510.188808
#&gt; LO-REDUCTION     127 5510.229898 5510.188808
#&gt; REFLECTION       129 5510.220541 5510.168716
#&gt; LO-REDUCTION     131 5510.199470 5510.168716
#&gt; LO-REDUCTION     133 5510.197243 5510.168716
#&gt; EXTENSION        135 5510.195940 5510.138440
#&gt; LO-REDUCTION     137 5510.190527 5510.138440
#&gt; LO-REDUCTION     139 5510.188808 5510.138440
#&gt; LO-REDUCTION     141 5510.178180 5510.138440
#&gt; EXTENSION        143 5510.178103 5510.125967
#&gt; EXTENSION        145 5510.168716 5510.100014
#&gt; EXTENSION        147 5510.161722 5510.075012
#&gt; LO-REDUCTION     149 5510.141685 5510.075012
#&gt; LO-REDUCTION     151 5510.138563 5510.075012
#&gt; EXTENSION        153 5510.138440 5510.060119
#&gt; LO-REDUCTION     155 5510.125967 5510.060119
#&gt; LO-REDUCTION     157 5510.100014 5510.059382
#&gt; REFLECTION       159 5510.099702 5510.057752
#&gt; REFLECTION       161 5510.088075 5510.035672
#&gt; LO-REDUCTION     163 5510.075012 5510.035672
#&gt; HI-REDUCTION     165 5510.065312 5510.035672
#&gt; HI-REDUCTION     167 5510.060119 5510.035672
#&gt; EXTENSION        169 5510.059382 5510.023387
#&gt; LO-REDUCTION     171 5510.057752 5510.023387
#&gt; LO-REDUCTION     173 5510.052537 5510.023387
#&gt; LO-REDUCTION     175 5510.051203 5510.023387
#&gt; LO-REDUCTION     177 5510.049563 5510.023387
#&gt; EXTENSION        179 5510.037487 5509.981681
#&gt; LO-REDUCTION     181 5510.035672 5509.981681
#&gt; LO-REDUCTION     183 5510.030290 5509.981681
#&gt; LO-REDUCTION     185 5510.025958 5509.981681
#&gt; EXTENSION        187 5510.023930 5509.955820
#&gt; LO-REDUCTION     189 5510.023387 5509.955820
#&gt; EXTENSION        191 5510.001100 5509.900626
#&gt; LO-REDUCTION     193 5509.995196 5509.900626
#&gt; LO-REDUCTION     195 5509.988037 5509.900626
#&gt; EXTENSION        197 5509.981681 5509.833314
#&gt; LO-REDUCTION     199 5509.964463 5509.833314
#&gt; EXTENSION        201 5509.955820 5509.785399
#&gt; EXTENSION        203 5509.924681 5509.724407
#&gt; LO-REDUCTION     205 5509.907375 5509.724407
#&gt; EXTENSION        207 5509.900626 5509.617752
#&gt; EXTENSION        209 5509.842899 5509.490182
#&gt; LO-REDUCTION     211 5509.833314 5509.490182
#&gt; LO-REDUCTION     213 5509.785399 5509.490182
#&gt; LO-REDUCTION     215 5509.750157 5509.490182
#&gt; EXTENSION        217 5509.724407 5509.338242
#&gt; LO-REDUCTION     219 5509.617752 5509.338242
#&gt; EXTENSION        221 5509.573648 5509.313653
#&gt; REFLECTION       223 5509.522391 5509.292238
#&gt; REFLECTION       225 5509.520189 5509.290759
#&gt; REFLECTION       227 5509.490182 5509.265130
#&gt; HI-REDUCTION     229 5509.372921 5509.265130
#&gt; REFLECTION       231 5509.338242 5509.232828
#&gt; LO-REDUCTION     233 5509.337146 5509.232828
#&gt; HI-REDUCTION     235 5509.313653 5509.232828
#&gt; LO-REDUCTION     237 5509.292238 5509.232828
#&gt; REFLECTION       239 5509.290759 5509.232505
#&gt; REFLECTION       241 5509.274759 5509.212937
#&gt; LO-REDUCTION     243 5509.265130 5509.212937
#&gt; LO-REDUCTION     245 5509.250899 5509.212937
#&gt; REFLECTION       247 5509.250700 5509.207864
#&gt; REFLECTION       249 5509.232828 5509.203579
#&gt; LO-REDUCTION     251 5509.232662 5509.203579
#&gt; EXTENSION        253 5509.232505 5509.186190
#&gt; EXTENSION        255 5509.220141 5509.139445
#&gt; LO-REDUCTION     257 5509.215423 5509.139445
#&gt; LO-REDUCTION     259 5509.212937 5509.139445
#&gt; LO-REDUCTION     261 5509.207864 5509.139445
#&gt; REFLECTION       263 5509.203579 5509.134335
#&gt; REFLECTION       265 5509.186190 5509.126440
#&gt; EXTENSION        267 5509.173682 5509.088877
#&gt; EXTENSION        269 5509.148120 5509.073067
#&gt; EXTENSION        271 5509.143829 5509.014588
#&gt; LO-REDUCTION     273 5509.139445 5509.014588
#&gt; LO-REDUCTION     275 5509.134335 5509.014588
#&gt; EXTENSION        277 5509.126440 5508.987658
#&gt; EXTENSION        279 5509.088877 5508.947751
#&gt; LO-REDUCTION     281 5509.073067 5508.947751
#&gt; LO-REDUCTION     283 5509.063085 5508.947751
#&gt; EXTENSION        285 5509.015754 5508.902095
#&gt; LO-REDUCTION     287 5509.014588 5508.902095
#&gt; LO-REDUCTION     289 5508.987658 5508.902095
#&gt; LO-REDUCTION     291 5508.966465 5508.902095
#&gt; LO-REDUCTION     293 5508.960327 5508.902095
#&gt; LO-REDUCTION     295 5508.947751 5508.902095
#&gt; LO-REDUCTION     297 5508.931135 5508.902095
#&gt; REFLECTION       299 5508.919757 5508.890652
#&gt; REFLECTION       301 5508.916512 5508.888861
#&gt; LO-REDUCTION     303 5508.910300 5508.888835
#&gt; LO-REDUCTION     305 5508.906887 5508.888835
#&gt; HI-REDUCTION     307 5508.902993 5508.888835
#&gt; REFLECTION       309 5508.902095 5508.888829
#&gt; LO-REDUCTION     311 5508.893355 5508.886320
#&gt; REFLECTION       313 5508.891030 5508.882387
#&gt; LO-REDUCTION     315 5508.890652 5508.882387
#&gt; HI-REDUCTION     317 5508.888861 5508.882387
#&gt; HI-REDUCTION     319 5508.888835 5508.882387
#&gt; HI-REDUCTION     321 5508.888829 5508.882387
#&gt; LO-REDUCTION     323 5508.886320 5508.882387
#&gt; LO-REDUCTION     325 5508.885250 5508.882387
#&gt; LO-REDUCTION     327 5508.885088 5508.882387
#&gt; LO-REDUCTION     329 5508.885036 5508.882387
#&gt; REFLECTION       331 5508.884680 5508.881210
#&gt; LO-REDUCTION     333 5508.883309 5508.881210
#&gt; LO-REDUCTION     335 5508.883097 5508.881210
#&gt; EXTENSION        337 5508.882787 5508.878944
#&gt; LO-REDUCTION     339 5508.882765 5508.878944
#&gt; LO-REDUCTION     341 5508.882387 5508.878944
#&gt; LO-REDUCTION     343 5508.881661 5508.878944
#&gt; LO-REDUCTION     345 5508.881567 5508.878944
#&gt; LO-REDUCTION     347 5508.881210 5508.878944
#&gt; EXTENSION        349 5508.881110 5508.878028
#&gt; REFLECTION       351 5508.880100 5508.877578
#&gt; EXTENSION        353 5508.879692 5508.876306
#&gt; LO-REDUCTION     355 5508.879354 5508.876306
#&gt; EXTENSION        357 5508.879186 5508.875330
#&gt; EXTENSION        359 5508.878944 5508.872754
#&gt; LO-REDUCTION     361 5508.878028 5508.872754
#&gt; LO-REDUCTION     363 5508.877578 5508.872754
#&gt; LO-REDUCTION     365 5508.877266 5508.872754
#&gt; EXTENSION        367 5508.876306 5508.871447
#&gt; LO-REDUCTION     369 5508.875330 5508.871447
#&gt; EXTENSION        371 5508.874262 5508.868058
#&gt; LO-REDUCTION     373 5508.874251 5508.868058
#&gt; LO-REDUCTION     375 5508.874057 5508.868058
#&gt; LO-REDUCTION     377 5508.872827 5508.868058
#&gt; EXTENSION        379 5508.872754 5508.867524
#&gt; LO-REDUCTION     381 5508.871447 5508.867524
#&gt; EXTENSION        383 5508.870516 5508.865534
#&gt; EXTENSION        385 5508.870090 5508.863046
#&gt; LO-REDUCTION     387 5508.868405 5508.863046
#&gt; EXTENSION        389 5508.868148 5508.861145
#&gt; LO-REDUCTION     391 5508.868058 5508.861145
#&gt; LO-REDUCTION     393 5508.867524 5508.861145
#&gt; REFLECTION       395 5508.865534 5508.860922
#&gt; EXTENSION        397 5508.863560 5508.857061
#&gt; LO-REDUCTION     399 5508.863276 5508.857061
#&gt; LO-REDUCTION     401 5508.863046 5508.857061
#&gt; LO-REDUCTION     403 5508.861866 5508.857061
#&gt; EXTENSION        405 5508.861145 5508.851750
#&gt; LO-REDUCTION     407 5508.860922 5508.851750
#&gt; LO-REDUCTION     409 5508.858726 5508.851750
#&gt; EXTENSION        411 5508.857914 5508.848996
#&gt; LO-REDUCTION     413 5508.857471 5508.848996
#&gt; LO-REDUCTION     415 5508.857061 5508.848996
#&gt; EXTENSION        417 5508.855669 5508.842014
#&gt; EXTENSION        419 5508.851974 5508.834554
#&gt; LO-REDUCTION     421 5508.851750 5508.834554
#&gt; LO-REDUCTION     423 5508.850791 5508.834554
#&gt; EXTENSION        425 5508.849762 5508.826575
#&gt; LO-REDUCTION     427 5508.848996 5508.826575
#&gt; EXTENSION        429 5508.842014 5508.820597
#&gt; LO-REDUCTION     431 5508.841844 5508.820597
#&gt; EXTENSION        433 5508.839072 5508.804999
#&gt; EXTENSION        435 5508.834554 5508.793104
#&gt; LO-REDUCTION     437 5508.828820 5508.793104
#&gt; LO-REDUCTION     439 5508.826575 5508.793104
#&gt; LO-REDUCTION     441 5508.821412 5508.793104
#&gt; LO-REDUCTION     443 5508.820597 5508.793104
#&gt; EXTENSION        445 5508.804999 5508.771812
#&gt; LO-REDUCTION     447 5508.803276 5508.771812
#&gt; LO-REDUCTION     449 5508.801823 5508.771812
#&gt; LO-REDUCTION     451 5508.798617 5508.771812
#&gt; LO-REDUCTION     453 5508.798145 5508.771812
#&gt; EXTENSION        455 5508.793104 5508.763357
#&gt; LO-REDUCTION     457 5508.790101 5508.763357
#&gt; EXTENSION        459 5508.779595 5508.747749
#&gt; LO-REDUCTION     461 5508.775144 5508.747749
#&gt; LO-REDUCTION     463 5508.774433 5508.747749
#&gt; LO-REDUCTION     465 5508.771812 5508.747749
#&gt; LO-REDUCTION     467 5508.771023 5508.747749
#&gt; LO-REDUCTION     469 5508.763357 5508.747749
#&gt; LO-REDUCTION     471 5508.759707 5508.747749
#&gt; LO-REDUCTION     473 5508.759022 5508.747749
#&gt; EXTENSION        475 5508.758989 5508.740832
#&gt; LO-REDUCTION     477 5508.757025 5508.740832
#&gt; LO-REDUCTION     479 5508.757005 5508.740832
#&gt; EXTENSION        481 5508.752539 5508.728244
#&gt; LO-REDUCTION     483 5508.750437 5508.728244
#&gt; EXTENSION        485 5508.747749 5508.720121
#&gt; EXTENSION        487 5508.743839 5508.702034
#&gt; LO-REDUCTION     489 5508.742047 5508.702034
#&gt; LO-REDUCTION     491 5508.740832 5508.702034
#&gt; EXTENSION        493 5508.730796 5508.685021
#&gt; LO-REDUCTION     495 5508.728244 5508.685021
#&gt; EXTENSION        497 5508.720121 5508.655176
#&gt; LO-REDUCTION     499 5508.713128 5508.655176
#&gt; LO-REDUCTION     501 5508.709655 5508.655176
#&gt; EXTENSION        503 5508.702034 5508.631869
#&gt; LO-REDUCTION     505 5508.695856 5508.631869
#&gt; EXTENSION        507 5508.685021 5508.587077
#&gt; LO-REDUCTION     509 5508.667225 5508.587077
#&gt; LO-REDUCTION     511 5508.660587 5508.587077
#&gt; LO-REDUCTION     513 5508.659119 5508.587077
#&gt; EXTENSION        515 5508.655176 5508.518357
#&gt; LO-REDUCTION     517 5508.631869 5508.518357
#&gt; LO-REDUCTION     519 5508.602275 5508.518357
#&gt; EXTENSION        521 5508.600244 5508.480789
#&gt; EXTENSION        523 5508.591505 5508.430334
#&gt; LO-REDUCTION     525 5508.587077 5508.430334
#&gt; EXTENSION        527 5508.556329 5508.412792
#&gt; EXTENSION        529 5508.519145 5508.289899
#&gt; LO-REDUCTION     531 5508.518357 5508.289899
#&gt; LO-REDUCTION     533 5508.480789 5508.289899
#&gt; LO-REDUCTION     535 5508.455757 5508.289899
#&gt; REFLECTION       537 5508.430334 5508.272476
#&gt; LO-REDUCTION     539 5508.412792 5508.272476
#&gt; EXTENSION        541 5508.352554 5508.182875
#&gt; LO-REDUCTION     543 5508.312725 5508.182875
#&gt; LO-REDUCTION     545 5508.301562 5508.182875
#&gt; LO-REDUCTION     547 5508.299938 5508.182875
#&gt; EXTENSION        549 5508.289899 5508.161702
#&gt; LO-REDUCTION     551 5508.272476 5508.161702
#&gt; LO-REDUCTION     553 5508.227490 5508.161702
#&gt; REFLECTION       555 5508.220110 5508.151362
#&gt; REFLECTION       557 5508.199444 5508.136388
#&gt; HI-REDUCTION     559 5508.187675 5508.136388
#&gt; LO-REDUCTION     561 5508.182875 5508.136388
#&gt; LO-REDUCTION     563 5508.171083 5508.136388
#&gt; EXTENSION        565 5508.166019 5508.099814
#&gt; HI-REDUCTION     567 5508.161702 5508.099814
#&gt; LO-REDUCTION     569 5508.151362 5508.099814
#&gt; LO-REDUCTION     571 5508.144883 5508.099814
#&gt; LO-REDUCTION     573 5508.143100 5508.099814
#&gt; EXTENSION        575 5508.142616 5508.081347
#&gt; LO-REDUCTION     577 5508.136388 5508.081347
#&gt; EXTENSION        579 5508.118296 5508.033407
#&gt; LO-REDUCTION     581 5508.116259 5508.033407
#&gt; EXTENSION        583 5508.103269 5507.997155
#&gt; LO-REDUCTION     585 5508.099814 5507.997155
#&gt; LO-REDUCTION     587 5508.085733 5507.997155
#&gt; EXTENSION        589 5508.081347 5507.924715
#&gt; LO-REDUCTION     591 5508.049509 5507.924715
#&gt; LO-REDUCTION     593 5508.033407 5507.924715
#&gt; EXTENSION        595 5508.012217 5507.875451
#&gt; LO-REDUCTION     597 5508.000609 5507.875451
#&gt; LO-REDUCTION     599 5507.997155 5507.875451
#&gt; REFLECTION       601 5507.962057 5507.868478
#&gt; EXTENSION        603 5507.946469 5507.843420
#&gt; EXTENSION        605 5507.924715 5507.745635
#&gt; LO-REDUCTION     607 5507.897016 5507.745635
#&gt; LO-REDUCTION     609 5507.886438 5507.745635
#&gt; LO-REDUCTION     611 5507.875451 5507.745635
#&gt; LO-REDUCTION     613 5507.868478 5507.745635
#&gt; LO-REDUCTION     615 5507.843420 5507.745635
#&gt; LO-REDUCTION     617 5507.830168 5507.745635
#&gt; EXTENSION        619 5507.812996 5507.709989
#&gt; LO-REDUCTION     621 5507.807746 5507.709989
#&gt; EXTENSION        623 5507.803958 5507.620510
#&gt; LO-REDUCTION     625 5507.764464 5507.620510
#&gt; LO-REDUCTION     627 5507.758911 5507.620510
#&gt; EXTENSION        629 5507.745635 5507.592777
#&gt; LO-REDUCTION     631 5507.727929 5507.592777
#&gt; EXTENSION        633 5507.709989 5507.468544
#&gt; LO-REDUCTION     635 5507.657428 5507.468544
#&gt; LO-REDUCTION     637 5507.633413 5507.468544
#&gt; EXTENSION        639 5507.620510 5507.439041
#&gt; LO-REDUCTION     641 5507.597465 5507.439041
#&gt; REFLECTION       643 5507.592777 5507.431087
#&gt; EXTENSION        645 5507.496642 5507.339767
#&gt; LO-REDUCTION     647 5507.475087 5507.339767
#&gt; EXTENSION        649 5507.471853 5507.294032
#&gt; LO-REDUCTION     651 5507.468544 5507.294032
#&gt; LO-REDUCTION     653 5507.439041 5507.294032
#&gt; EXTENSION        655 5507.431087 5507.243439
#&gt; LO-REDUCTION     657 5507.384571 5507.243439
#&gt; LO-REDUCTION     659 5507.372362 5507.243439
#&gt; LO-REDUCTION     661 5507.363784 5507.243439
#&gt; LO-REDUCTION     663 5507.339767 5507.243439
#&gt; LO-REDUCTION     665 5507.322766 5507.243439
#&gt; EXTENSION        667 5507.308767 5507.208327
#&gt; EXTENSION        669 5507.294032 5507.167727
#&gt; LO-REDUCTION     671 5507.263576 5507.167727
#&gt; LO-REDUCTION     673 5507.257404 5507.167727
#&gt; EXTENSION        675 5507.247290 5507.097914
#&gt; LO-REDUCTION     677 5507.243439 5507.097914
#&gt; LO-REDUCTION     679 5507.208327 5507.097914
#&gt; EXTENSION        681 5507.200839 5507.044322
#&gt; LO-REDUCTION     683 5507.187283 5507.044322
#&gt; LO-REDUCTION     685 5507.167727 5507.044322
#&gt; LO-REDUCTION     687 5507.161328 5507.044322
#&gt; EXTENSION        689 5507.154806 5506.969774
#&gt; EXTENSION        691 5507.116605 5506.865134
#&gt; LO-REDUCTION     693 5507.097914 5506.865134
#&gt; LO-REDUCTION     695 5507.092239 5506.865134
#&gt; EXTENSION        697 5507.073603 5506.736582
#&gt; LO-REDUCTION     699 5507.044322 5506.736582
#&gt; EXTENSION        701 5506.969774 5506.615124
#&gt; EXTENSION        703 5506.916393 5506.420685
#&gt; LO-REDUCTION     705 5506.915741 5506.420685
#&gt; EXTENSION        707 5506.865134 5506.216372
#&gt; LO-REDUCTION     709 5506.759934 5506.216372
#&gt; LO-REDUCTION     711 5506.736582 5506.216372
#&gt; EXTENSION        713 5506.615124 5506.058251
#&gt; EXTENSION        715 5506.512234 5505.717350
#&gt; LO-REDUCTION     717 5506.420685 5505.717350
#&gt; LO-REDUCTION     719 5506.259154 5505.717350
#&gt; LO-REDUCTION     721 5506.235214 5505.717350
#&gt; LO-REDUCTION     723 5506.216372 5505.717350
#&gt; LO-REDUCTION     725 5506.058251 5505.717350
#&gt; REFLECTION       727 5505.936990 5505.675970
#&gt; EXTENSION        729 5505.870685 5505.554313
#&gt; LO-REDUCTION     731 5505.807262 5505.554313
#&gt; REFLECTION       733 5505.793767 5505.539112
#&gt; LO-REDUCTION     735 5505.758617 5505.539112
#&gt; LO-REDUCTION     737 5505.717350 5505.539112
#&gt; LO-REDUCTION     739 5505.675970 5505.539112
#&gt; REFLECTION       741 5505.588004 5505.525395
#&gt; LO-REDUCTION     743 5505.564012 5505.525395
#&gt; REFLECTION       745 5505.561409 5505.522082
#&gt; HI-REDUCTION     747 5505.555415 5505.522082
#&gt; EXTENSION        749 5505.554313 5505.499372
#&gt; REFLECTION       751 5505.539112 5505.493693
#&gt; LO-REDUCTION     753 5505.532837 5505.493693
#&gt; LO-REDUCTION     755 5505.531007 5505.493693
#&gt; LO-REDUCTION     757 5505.525395 5505.493693
#&gt; REFLECTION       759 5505.522082 5505.486331
#&gt; EXTENSION        761 5505.503984 5505.468347
#&gt; LO-REDUCTION     763 5505.500920 5505.468347
#&gt; REFLECTION       765 5505.499666 5505.464501
#&gt; LO-REDUCTION     767 5505.499372 5505.464501
#&gt; LO-REDUCTION     769 5505.493693 5505.464501
#&gt; LO-REDUCTION     771 5505.486331 5505.464501
#&gt; LO-REDUCTION     773 5505.479701 5505.463715
#&gt; EXTENSION        775 5505.476545 5505.442248
#&gt; LO-REDUCTION     777 5505.473188 5505.442248
#&gt; LO-REDUCTION     779 5505.468347 5505.442248
#&gt; LO-REDUCTION     781 5505.465636 5505.442248
#&gt; LO-REDUCTION     783 5505.464501 5505.442248
#&gt; EXTENSION        785 5505.463715 5505.433820
#&gt; EXTENSION        787 5505.451483 5505.407995
#&gt; LO-REDUCTION     789 5505.446538 5505.407995
#&gt; LO-REDUCTION     791 5505.444900 5505.407995
#&gt; LO-REDUCTION     793 5505.444649 5505.407995
#&gt; LO-REDUCTION     795 5505.442248 5505.407995
#&gt; LO-REDUCTION     797 5505.433820 5505.407995
#&gt; LO-REDUCTION     799 5505.429343 5505.407995
#&gt; LO-REDUCTION     801 5505.428728 5505.407995
#&gt; EXTENSION        803 5505.425122 5505.399259
#&gt; EXTENSION        805 5505.415602 5505.389890
#&gt; LO-REDUCTION     807 5505.412956 5505.389890
#&gt; LO-REDUCTION     809 5505.410101 5505.389890
#&gt; REFLECTION       811 5505.409494 5505.386388
#&gt; LO-REDUCTION     813 5505.407995 5505.386388
#&gt; LO-REDUCTION     815 5505.399259 5505.386388
#&gt; REFLECTION       817 5505.391648 5505.381592
#&gt; HI-REDUCTION     819 5505.390598 5505.381592
#&gt; LO-REDUCTION     821 5505.390052 5505.381592
#&gt; LO-REDUCTION     823 5505.389890 5505.381592
#&gt; EXTENSION        825 5505.386930 5505.372974
#&gt; LO-REDUCTION     827 5505.386388 5505.372974
#&gt; LO-REDUCTION     829 5505.385908 5505.372974
#&gt; EXTENSION        831 5505.384925 5505.371302
#&gt; EXTENSION        833 5505.381943 5505.357906
#&gt; LO-REDUCTION     835 5505.381592 5505.357906
#&gt; EXTENSION        837 5505.377855 5505.351887
#&gt; LO-REDUCTION     839 5505.375324 5505.351887
#&gt; EXTENSION        841 5505.372974 5505.346113
#&gt; LO-REDUCTION     843 5505.371302 5505.346113
#&gt; EXTENSION        845 5505.364808 5505.311575
#&gt; LO-REDUCTION     847 5505.357906 5505.311575
#&gt; LO-REDUCTION     849 5505.356418 5505.311575
#&gt; LO-REDUCTION     851 5505.351887 5505.311575
#&gt; LO-REDUCTION     853 5505.346345 5505.311575
#&gt; LO-REDUCTION     855 5505.346113 5505.311575
#&gt; EXTENSION        857 5505.341084 5505.288445
#&gt; LO-REDUCTION     859 5505.327276 5505.288445
#&gt; EXTENSION        861 5505.324552 5505.270874
#&gt; LO-REDUCTION     863 5505.322996 5505.270874
#&gt; EXTENSION        865 5505.315625 5505.240848
#&gt; LO-REDUCTION     867 5505.311575 5505.240848
#&gt; EXTENSION        869 5505.289929 5505.231503
#&gt; LO-REDUCTION     871 5505.288445 5505.231503
#&gt; EXTENSION        873 5505.282453 5505.192487
#&gt; LO-REDUCTION     875 5505.270874 5505.192487
#&gt; LO-REDUCTION     877 5505.249412 5505.192487
#&gt; LO-REDUCTION     879 5505.241859 5505.192487
#&gt; EXTENSION        881 5505.240848 5505.170439
#&gt; LO-REDUCTION     883 5505.231503 5505.170439
#&gt; LO-REDUCTION     885 5505.211368 5505.170439
#&gt; EXTENSION        887 5505.203768 5505.156225
#&gt; EXTENSION        889 5505.198037 5505.132002
#&gt; LO-REDUCTION     891 5505.195221 5505.132002
#&gt; LO-REDUCTION     893 5505.192487 5505.132002
#&gt; LO-REDUCTION     895 5505.172874 5505.132002
#&gt; REFLECTION       897 5505.170439 5505.131006
#&gt; EXTENSION        899 5505.156225 5505.118570
#&gt; LO-REDUCTION     901 5505.145334 5505.118570
#&gt; EXTENSION        903 5505.145270 5505.106336
#&gt; EXTENSION        905 5505.141035 5505.099521
#&gt; LO-REDUCTION     907 5505.132002 5505.099521
#&gt; LO-REDUCTION     909 5505.131006 5505.099521
#&gt; LO-REDUCTION     911 5505.125066 5505.099521
#&gt; LO-REDUCTION     913 5505.118570 5505.096235
#&gt; LO-REDUCTION     915 5505.106336 5505.096235
#&gt; REFLECTION       917 5505.102733 5505.093965
#&gt; REFLECTION       919 5505.102592 5505.090305
#&gt; EXTENSION        921 5505.100327 5505.086394
#&gt; HI-REDUCTION     923 5505.099521 5505.086394
#&gt; LO-REDUCTION     925 5505.098905 5505.086394
#&gt; REFLECTION       927 5505.096235 5505.083802
#&gt; LO-REDUCTION     929 5505.093965 5505.083802
#&gt; REFLECTION       931 5505.092017 5505.081677
#&gt; REFLECTION       933 5505.091647 5505.080675
#&gt; REFLECTION       935 5505.090305 5505.079840
#&gt; REFLECTION       937 5505.086394 5505.079671
#&gt; REFLECTION       939 5505.083927 5505.075076
#&gt; EXTENSION        941 5505.083802 5505.065745
#&gt; LO-REDUCTION     943 5505.081677 5505.065745
#&gt; LO-REDUCTION     945 5505.080675 5505.065745
#&gt; LO-REDUCTION     947 5505.079840 5505.065745
#&gt; LO-REDUCTION     949 5505.079671 5505.065745
#&gt; REFLECTION       951 5505.076158 5505.065004
#&gt; LO-REDUCTION     953 5505.075076 5505.065004
#&gt; REFLECTION       955 5505.074294 5505.062078
#&gt; REFLECTION       957 5505.067606 5505.059248
#&gt; LO-REDUCTION     959 5505.066838 5505.059248
#&gt; LO-REDUCTION     961 5505.065855 5505.059248
#&gt; EXTENSION        963 5505.065745 5505.057442
#&gt; EXTENSION        965 5505.065004 5505.051666
#&gt; EXTENSION        967 5505.062078 5505.049594
#&gt; LO-REDUCTION     969 5505.061497 5505.049594
#&gt; EXTENSION        971 5505.060612 5505.048997
#&gt; REFLECTION       973 5505.059248 5505.046321
#&gt; LO-REDUCTION     975 5505.057442 5505.046321
#&gt; REFLECTION       977 5505.054741 5505.043360
#&gt; LO-REDUCTION     979 5505.051666 5505.043360
#&gt; LO-REDUCTION     981 5505.049594 5505.043360
#&gt; HI-REDUCTION     983 5505.049435 5505.043360
#&gt; EXTENSION        985 5505.048997 5505.040409
#&gt; LO-REDUCTION     987 5505.046321 5505.040409
#&gt; LO-REDUCTION     989 5505.046258 5505.040409
#&gt; LO-REDUCTION     991 5505.045926 5505.040409
#&gt; LO-REDUCTION     993 5505.045034 5505.040409
#&gt; LO-REDUCTION     995 5505.043360 5505.040409
#&gt; LO-REDUCTION     997 5505.043238 5505.040409
#&gt; LO-REDUCTION     999 5505.043194 5505.040409
#&gt; LO-REDUCTION    1001 5505.042106 5505.040409
#&gt; LO-REDUCTION    1003 5505.041208 5505.040409
#&gt; EXTENSION       1005 5505.041149 5505.039844
#&gt; LO-REDUCTION    1007 5505.041067 5505.039844
#&gt; EXTENSION       1009 5505.040779 5505.039619
#&gt; REFLECTION      1011 5505.040672 5505.039583
#&gt; EXTENSION       1013 5505.040587 5505.039099
#&gt; LO-REDUCTION    1015 5505.040409 5505.039099
#&gt; REFLECTION      1017 5505.040219 5505.038834
#&gt; LO-REDUCTION    1019 5505.039844 5505.038834
#&gt; EXTENSION       1021 5505.039619 5505.038026
#&gt; LO-REDUCTION    1023 5505.039583 5505.038026
#&gt; LO-REDUCTION    1025 5505.039206 5505.038026
#&gt; LO-REDUCTION    1027 5505.039099 5505.038026
#&gt; REFLECTION      1029 5505.038885 5505.037926
#&gt; EXTENSION       1031 5505.038834 5505.036784
#&gt; LO-REDUCTION    1033 5505.038617 5505.036784
#&gt; EXTENSION       1035 5505.038212 5505.035580
#&gt; LO-REDUCTION    1037 5505.038032 5505.035580
#&gt; LO-REDUCTION    1039 5505.038026 5505.035580
#&gt; EXTENSION       1041 5505.037926 5505.034711
#&gt; EXTENSION       1043 5505.037105 5505.032312
#&gt; LO-REDUCTION    1045 5505.036784 5505.032312
#&gt; LO-REDUCTION    1047 5505.036581 5505.032312
#&gt; EXTENSION       1049 5505.036007 5505.030841
#&gt; EXTENSION       1051 5505.035580 5505.029664
#&gt; EXTENSION       1053 5505.034711 5505.027756
#&gt; EXTENSION       1055 5505.033569 5505.023105
#&gt; LO-REDUCTION    1057 5505.032783 5505.023105
#&gt; LO-REDUCTION    1059 5505.032312 5505.023105
#&gt; LO-REDUCTION    1061 5505.030841 5505.023105
#&gt; LO-REDUCTION    1063 5505.029664 5505.023105
#&gt; EXTENSION       1065 5505.027756 5505.017136
#&gt; LO-REDUCTION    1067 5505.026243 5505.017136
#&gt; LO-REDUCTION    1069 5505.026096 5505.017136
#&gt; EXTENSION       1071 5505.024337 5505.012068
#&gt; LO-REDUCTION    1073 5505.023551 5505.012068
#&gt; EXTENSION       1075 5505.023105 5505.006700
#&gt; LO-REDUCTION    1077 5505.019614 5505.006700
#&gt; EXTENSION       1079 5505.018590 5505.003778
#&gt; EXTENSION       1081 5505.017136 5505.001780
#&gt; LO-REDUCTION    1083 5505.014727 5505.001780
#&gt; EXTENSION       1085 5505.012068 5504.996790
#&gt; LO-REDUCTION    1087 5505.009139 5504.996790
#&gt; REFLECTION      1089 5505.006700 5504.996425
#&gt; HI-REDUCTION    1091 5505.003778 5504.996425
#&gt; LO-REDUCTION    1093 5505.003596 5504.996425
#&gt; REFLECTION      1095 5505.001780 5504.993701
#&gt; LO-REDUCTION    1097 5504.999480 5504.993701
#&gt; HI-REDUCTION    1099 5504.997955 5504.993701
#&gt; LO-REDUCTION    1101 5504.997903 5504.993701
#&gt; REFLECTION      1103 5504.996790 5504.993521
#&gt; EXTENSION       1105 5504.996425 5504.990069
#&gt; LO-REDUCTION    1107 5504.995990 5504.990069
#&gt; LO-REDUCTION    1109 5504.995732 5504.990069
#&gt; EXTENSION       1111 5504.994339 5504.988069
#&gt; LO-REDUCTION    1113 5504.993701 5504.988069
#&gt; LO-REDUCTION    1115 5504.993521 5504.988069
#&gt; EXTENSION       1117 5504.992185 5504.984229
#&gt; LO-REDUCTION    1119 5504.991175 5504.984229
#&gt; EXTENSION       1121 5504.990069 5504.981548
#&gt; LO-REDUCTION    1123 5504.988824 5504.981548
#&gt; LO-REDUCTION    1125 5504.988652 5504.981548
#&gt; LO-REDUCTION    1127 5504.988069 5504.981548
#&gt; LO-REDUCTION    1129 5504.986125 5504.981548
#&gt; LO-REDUCTION    1131 5504.984979 5504.981548
#&gt; EXTENSION       1133 5504.984313 5504.980763
#&gt; LO-REDUCTION    1135 5504.984229 5504.980763
#&gt; LO-REDUCTION    1137 5504.984105 5504.980763
#&gt; EXTENSION       1139 5504.982254 5504.978506
#&gt; LO-REDUCTION    1141 5504.981930 5504.978506
#&gt; LO-REDUCTION    1143 5504.981548 5504.978506
#&gt; HI-REDUCTION    1145 5504.981392 5504.978506
#&gt; REFLECTION      1147 5504.981294 5504.978409
#&gt; REFLECTION      1149 5504.980763 5504.977970
#&gt; REFLECTION      1151 5504.980045 5504.977962
#&gt; LO-REDUCTION    1153 5504.979682 5504.977962
#&gt; LO-REDUCTION    1155 5504.979171 5504.977926
#&gt; LO-REDUCTION    1157 5504.978506 5504.977926
#&gt; REFLECTION      1159 5504.978450 5504.977870
#&gt; EXTENSION       1161 5504.978409 5504.976923
#&gt; LO-REDUCTION    1163 5504.977970 5504.976923
#&gt; LO-REDUCTION    1165 5504.977962 5504.976923
#&gt; LO-REDUCTION    1167 5504.977937 5504.976923
#&gt; LO-REDUCTION    1169 5504.977926 5504.976923
#&gt; LO-REDUCTION    1171 5504.977870 5504.976923
#&gt; EXTENSION       1173 5504.977489 5504.976166
#&gt; LO-REDUCTION    1175 5504.977192 5504.976166
#&gt; LO-REDUCTION    1177 5504.977192 5504.976166
#&gt; LO-REDUCTION    1179 5504.976961 5504.976166
#&gt; REFLECTION      1181 5504.976941 5504.976008
#&gt; LO-REDUCTION    1183 5504.976923 5504.976008
#&gt; EXTENSION       1185 5504.976398 5504.975572
#&gt; EXTENSION       1187 5504.976305 5504.975356
#&gt; LO-REDUCTION    1189 5504.976257 5504.975356
#&gt; LO-REDUCTION    1191 5504.976166 5504.975356
#&gt; REFLECTION      1193 5504.976114 5504.975309
#&gt; REFLECTION      1195 5504.976008 5504.975093
#&gt; LO-REDUCTION    1197 5504.975646 5504.975093
#&gt; LO-REDUCTION    1199 5504.975572 5504.975093
#&gt; LO-REDUCTION    1201 5504.975541 5504.975093
#&gt; LO-REDUCTION    1203 5504.975450 5504.975093
#&gt; LO-REDUCTION    1205 5504.975356 5504.975093
#&gt; LO-REDUCTION    1207 5504.975309 5504.975093
#&gt; LO-REDUCTION    1209 5504.975258 5504.975093
#&gt; REFLECTION      1211 5504.975207 5504.975042
#&gt; REFLECTION      1213 5504.975202 5504.975022
#&gt; REFLECTION      1215 5504.975139 5504.974994
#&gt; REFLECTION      1217 5504.975124 5504.974994
#&gt; LO-REDUCTION    1219 5504.975114 5504.974994
#&gt; REFLECTION      1221 5504.975093 5504.974951
#&gt; EXTENSION       1223 5504.975042 5504.974901
#&gt; LO-REDUCTION    1225 5504.975022 5504.974901
#&gt; LO-REDUCTION    1227 5504.975020 5504.974901
#&gt; LO-REDUCTION    1229 5504.974994 5504.974901
#&gt; REFLECTION      1231 5504.974994 5504.974887
#&gt; EXTENSION       1233 5504.974951 5504.974784
#&gt; LO-REDUCTION    1235 5504.974936 5504.974784
#&gt; LO-REDUCTION    1237 5504.974920 5504.974784
#&gt; LO-REDUCTION    1239 5504.974901 5504.974784
#&gt; EXTENSION       1241 5504.974901 5504.974777
#&gt; REFLECTION      1243 5504.974887 5504.974752
#&gt; EXTENSION       1245 5504.974858 5504.974706
#&gt; LO-REDUCTION    1247 5504.974846 5504.974706
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1249 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0378578   1.4907865  -3.0066028  -0.9656939  -0.5834678   0.3142697 
#&gt; 
#&gt; $value
#&gt; [1] 5504.975
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1249 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.86 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |============================                                          |  40%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6041.256163
#&gt;   Scaled convergence tolerance is 9.00217e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11690.097538 5680.470321
#&gt; LO-REDUCTION       9 7661.801107 5680.470321
#&gt; LO-REDUCTION      11 7360.797983 5680.470321
#&gt; LO-REDUCTION      13 6811.349770 5680.470321
#&gt; LO-REDUCTION      15 6532.299965 5680.470321
#&gt; LO-REDUCTION      17 6344.092295 5680.470321
#&gt; REFLECTION        19 6238.800821 5658.207153
#&gt; REFLECTION        21 6041.256163 5505.099863
#&gt; LO-REDUCTION      23 5881.406372 5505.099863
#&gt; LO-REDUCTION      25 5877.606410 5505.099863
#&gt; LO-REDUCTION      27 5736.378831 5505.099863
#&gt; LO-REDUCTION      29 5680.470321 5505.099863
#&gt; LO-REDUCTION      31 5658.207153 5505.099863
#&gt; LO-REDUCTION      33 5581.631262 5501.794825
#&gt; LO-REDUCTION      35 5555.183996 5501.794825
#&gt; LO-REDUCTION      37 5539.922569 5501.794825
#&gt; HI-REDUCTION      39 5538.113409 5501.794825
#&gt; LO-REDUCTION      41 5516.612002 5501.794825
#&gt; REFLECTION        43 5510.902555 5495.630399
#&gt; LO-REDUCTION      45 5510.015524 5495.630399
#&gt; LO-REDUCTION      47 5507.821864 5495.630399
#&gt; HI-REDUCTION      49 5507.327655 5495.630399
#&gt; LO-REDUCTION      51 5505.099863 5495.481043
#&gt; LO-REDUCTION      53 5501.794825 5495.481043
#&gt; REFLECTION        55 5497.630588 5493.614180
#&gt; LO-REDUCTION      57 5497.248340 5493.300890
#&gt; LO-REDUCTION      59 5497.136438 5493.001511
#&gt; LO-REDUCTION      61 5496.357369 5492.711726
#&gt; LO-REDUCTION      63 5495.630399 5492.711726
#&gt; LO-REDUCTION      65 5495.481043 5492.314694
#&gt; LO-REDUCTION      67 5493.614180 5492.016823
#&gt; HI-REDUCTION      69 5493.300890 5492.016823
#&gt; LO-REDUCTION      71 5493.267756 5492.016823
#&gt; LO-REDUCTION      73 5493.001511 5492.016823
#&gt; HI-REDUCTION      75 5492.711726 5492.016823
#&gt; HI-REDUCTION      77 5492.314694 5492.016823
#&gt; HI-REDUCTION      79 5492.284757 5491.918152
#&gt; REFLECTION        81 5492.263285 5491.786052
#&gt; LO-REDUCTION      83 5492.166401 5491.786052
#&gt; REFLECTION        85 5492.125208 5491.679810
#&gt; LO-REDUCTION      87 5492.077345 5491.679810
#&gt; REFLECTION        89 5492.016823 5491.547015
#&gt; HI-REDUCTION      91 5491.918152 5491.547015
#&gt; LO-REDUCTION      93 5491.885641 5491.547015
#&gt; REFLECTION        95 5491.786052 5491.517210
#&gt; LO-REDUCTION      97 5491.710550 5491.517210
#&gt; REFLECTION        99 5491.704371 5491.513752
#&gt; EXTENSION        101 5491.679810 5491.216492
#&gt; LO-REDUCTION     103 5491.572670 5491.216492
#&gt; LO-REDUCTION     105 5491.567177 5491.216492
#&gt; LO-REDUCTION     107 5491.547015 5491.216492
#&gt; LO-REDUCTION     109 5491.517210 5491.216492
#&gt; LO-REDUCTION     111 5491.513752 5491.216492
#&gt; EXTENSION        113 5491.396581 5490.858220
#&gt; LO-REDUCTION     115 5491.325373 5490.858220
#&gt; LO-REDUCTION     117 5491.319094 5490.858220
#&gt; LO-REDUCTION     119 5491.309957 5490.858220
#&gt; LO-REDUCTION     121 5491.283451 5490.858220
#&gt; LO-REDUCTION     123 5491.216492 5490.858220
#&gt; EXTENSION        125 5491.112798 5490.613785
#&gt; LO-REDUCTION     127 5491.096481 5490.613785
#&gt; LO-REDUCTION     129 5491.017296 5490.613785
#&gt; EXTENSION        131 5490.978322 5490.353981
#&gt; LO-REDUCTION     133 5490.899058 5490.353981
#&gt; EXTENSION        135 5490.858220 5490.097053
#&gt; LO-REDUCTION     137 5490.711165 5490.097053
#&gt; EXTENSION        139 5490.616021 5490.042127
#&gt; LO-REDUCTION     141 5490.613785 5490.042127
#&gt; EXTENSION        143 5490.363833 5489.789141
#&gt; LO-REDUCTION     145 5490.353981 5489.789141
#&gt; LO-REDUCTION     147 5490.179245 5489.789141
#&gt; LO-REDUCTION     149 5490.097053 5489.789141
#&gt; HI-REDUCTION     151 5490.079270 5489.789141
#&gt; REFLECTION       153 5490.042127 5489.730598
#&gt; LO-REDUCTION     155 5489.904702 5489.730598
#&gt; EXTENSION        157 5489.900891 5489.633820
#&gt; LO-REDUCTION     159 5489.854484 5489.633820
#&gt; LO-REDUCTION     161 5489.824394 5489.633820
#&gt; LO-REDUCTION     163 5489.789141 5489.633820
#&gt; EXTENSION        165 5489.765226 5489.516930
#&gt; LO-REDUCTION     167 5489.747712 5489.516930
#&gt; LO-REDUCTION     169 5489.730598 5489.516930
#&gt; LO-REDUCTION     171 5489.719060 5489.516930
#&gt; EXTENSION        173 5489.649863 5489.287089
#&gt; LO-REDUCTION     175 5489.633820 5489.287089
#&gt; LO-REDUCTION     177 5489.568528 5489.287089
#&gt; LO-REDUCTION     179 5489.565194 5489.287089
#&gt; LO-REDUCTION     181 5489.531035 5489.287089
#&gt; EXTENSION        183 5489.516930 5489.240524
#&gt; EXTENSION        185 5489.430024 5488.967024
#&gt; LO-REDUCTION     187 5489.365732 5488.967024
#&gt; LO-REDUCTION     189 5489.332898 5488.967024
#&gt; EXTENSION        191 5489.300904 5488.812735
#&gt; LO-REDUCTION     193 5489.287089 5488.812735
#&gt; LO-REDUCTION     195 5489.240524 5488.812735
#&gt; EXTENSION        197 5489.013608 5488.346167
#&gt; LO-REDUCTION     199 5488.974420 5488.346167
#&gt; LO-REDUCTION     201 5488.967024 5488.346167
#&gt; LO-REDUCTION     203 5488.888093 5488.346167
#&gt; LO-REDUCTION     205 5488.883653 5488.346167
#&gt; EXTENSION        207 5488.812735 5488.116848
#&gt; LO-REDUCTION     209 5488.675811 5488.116848
#&gt; EXTENSION        211 5488.673778 5487.796047
#&gt; LO-REDUCTION     213 5488.514673 5487.796047
#&gt; LO-REDUCTION     215 5488.430620 5487.796047
#&gt; EXTENSION        217 5488.346167 5487.631054
#&gt; LO-REDUCTION     219 5488.158493 5487.631054
#&gt; LO-REDUCTION     221 5488.116848 5487.631054
#&gt; REFLECTION       223 5487.933609 5487.592169
#&gt; EXTENSION        225 5487.817157 5487.240780
#&gt; LO-REDUCTION     227 5487.796047 5487.240780
#&gt; LO-REDUCTION     229 5487.749046 5487.240780
#&gt; LO-REDUCTION     231 5487.684984 5487.240780
#&gt; LO-REDUCTION     233 5487.631054 5487.240780
#&gt; LO-REDUCTION     235 5487.592169 5487.240780
#&gt; LO-REDUCTION     237 5487.579923 5487.240780
#&gt; EXTENSION        239 5487.530337 5487.049933
#&gt; LO-REDUCTION     241 5487.479541 5487.049933
#&gt; LO-REDUCTION     243 5487.399255 5487.049933
#&gt; LO-REDUCTION     245 5487.327453 5487.049933
#&gt; LO-REDUCTION     247 5487.327243 5487.049933
#&gt; EXTENSION        249 5487.240780 5486.939034
#&gt; LO-REDUCTION     251 5487.115477 5486.939034
#&gt; REFLECTION       253 5487.108029 5486.932954
#&gt; EXTENSION        255 5487.089985 5486.732988
#&gt; LO-REDUCTION     257 5487.070768 5486.732988
#&gt; LO-REDUCTION     259 5487.049933 5486.732988
#&gt; LO-REDUCTION     261 5486.959243 5486.732988
#&gt; LO-REDUCTION     263 5486.939034 5486.732988
#&gt; LO-REDUCTION     265 5486.932954 5486.732988
#&gt; EXTENSION        267 5486.871189 5486.679433
#&gt; EXTENSION        269 5486.829257 5486.550583
#&gt; LO-REDUCTION     271 5486.799149 5486.550583
#&gt; LO-REDUCTION     273 5486.764826 5486.550583
#&gt; REFLECTION       275 5486.747133 5486.533296
#&gt; LO-REDUCTION     277 5486.732988 5486.533296
#&gt; LO-REDUCTION     279 5486.679433 5486.519271
#&gt; LO-REDUCTION     281 5486.593543 5486.519271
#&gt; REFLECTION       283 5486.555063 5486.505262
#&gt; LO-REDUCTION     285 5486.550583 5486.505262
#&gt; LO-REDUCTION     287 5486.547491 5486.505262
#&gt; HI-REDUCTION     289 5486.537907 5486.505262
#&gt; LO-REDUCTION     291 5486.533296 5486.505262
#&gt; LO-REDUCTION     293 5486.519271 5486.504637
#&gt; LO-REDUCTION     295 5486.518499 5486.504493
#&gt; LO-REDUCTION     297 5486.516414 5486.504493
#&gt; LO-REDUCTION     299 5486.513417 5486.504493
#&gt; HI-REDUCTION     301 5486.512445 5486.504493
#&gt; EXTENSION        303 5486.507929 5486.495773
#&gt; LO-REDUCTION     305 5486.506699 5486.495773
#&gt; LO-REDUCTION     307 5486.505262 5486.495773
#&gt; LO-REDUCTION     309 5486.504898 5486.495773
#&gt; LO-REDUCTION     311 5486.504637 5486.495773
#&gt; EXTENSION        313 5486.504493 5486.486441
#&gt; LO-REDUCTION     315 5486.500290 5486.486441
#&gt; LO-REDUCTION     317 5486.499696 5486.486441
#&gt; LO-REDUCTION     319 5486.499243 5486.486441
#&gt; LO-REDUCTION     321 5486.496259 5486.486441
#&gt; LO-REDUCTION     323 5486.495773 5486.486441
#&gt; EXTENSION        325 5486.494159 5486.479466
#&gt; EXTENSION        327 5486.489790 5486.474298
#&gt; LO-REDUCTION     329 5486.488785 5486.474298
#&gt; LO-REDUCTION     331 5486.488653 5486.474298
#&gt; LO-REDUCTION     333 5486.486507 5486.474298
#&gt; LO-REDUCTION     335 5486.486441 5486.474298
#&gt; LO-REDUCTION     337 5486.479466 5486.474298
#&gt; EXTENSION        339 5486.478105 5486.470802
#&gt; EXTENSION        341 5486.476549 5486.470011
#&gt; EXTENSION        343 5486.475484 5486.467458
#&gt; LO-REDUCTION     345 5486.474791 5486.467458
#&gt; EXTENSION        347 5486.474565 5486.460215
#&gt; LO-REDUCTION     349 5486.474298 5486.460215
#&gt; LO-REDUCTION     351 5486.470802 5486.460215
#&gt; LO-REDUCTION     353 5486.470011 5486.460215
#&gt; LO-REDUCTION     355 5486.469102 5486.460215
#&gt; EXTENSION        357 5486.467458 5486.458152
#&gt; LO-REDUCTION     359 5486.467414 5486.458152
#&gt; EXTENSION        361 5486.465789 5486.450174
#&gt; LO-REDUCTION     363 5486.463879 5486.450174
#&gt; LO-REDUCTION     365 5486.460786 5486.450174
#&gt; LO-REDUCTION     367 5486.460615 5486.450174
#&gt; EXTENSION        369 5486.460215 5486.439443
#&gt; LO-REDUCTION     371 5486.458152 5486.439443
#&gt; LO-REDUCTION     373 5486.451356 5486.439443
#&gt; LO-REDUCTION     375 5486.450961 5486.439443
#&gt; EXTENSION        377 5486.450576 5486.429563
#&gt; LO-REDUCTION     379 5486.450174 5486.429563
#&gt; EXTENSION        381 5486.443737 5486.428789
#&gt; REFLECTION       383 5486.441772 5486.428532
#&gt; EXTENSION        385 5486.440200 5486.417560
#&gt; LO-REDUCTION     387 5486.439443 5486.417560
#&gt; LO-REDUCTION     389 5486.433751 5486.417560
#&gt; EXTENSION        391 5486.429563 5486.408534
#&gt; LO-REDUCTION     393 5486.428789 5486.408534
#&gt; LO-REDUCTION     395 5486.428532 5486.408534
#&gt; LO-REDUCTION     397 5486.419238 5486.408534
#&gt; EXTENSION        399 5486.418936 5486.408323
#&gt; REFLECTION       401 5486.417662 5486.404873
#&gt; LO-REDUCTION     403 5486.417560 5486.404873
#&gt; REFLECTION       405 5486.412564 5486.400489
#&gt; EXTENSION        407 5486.411047 5486.393068
#&gt; LO-REDUCTION     409 5486.408534 5486.393068
#&gt; LO-REDUCTION     411 5486.408323 5486.393068
#&gt; LO-REDUCTION     413 5486.406123 5486.393068
#&gt; EXTENSION        415 5486.404873 5486.382834
#&gt; LO-REDUCTION     417 5486.400489 5486.382834
#&gt; LO-REDUCTION     419 5486.397986 5486.382834
#&gt; LO-REDUCTION     421 5486.397190 5486.382834
#&gt; LO-REDUCTION     423 5486.396469 5486.382834
#&gt; LO-REDUCTION     425 5486.393068 5486.382834
#&gt; REFLECTION       427 5486.389865 5486.382299
#&gt; LO-REDUCTION     429 5486.388690 5486.382299
#&gt; LO-REDUCTION     431 5486.388350 5486.382299
#&gt; EXTENSION        433 5486.387275 5486.379209
#&gt; LO-REDUCTION     435 5486.384118 5486.379209
#&gt; EXTENSION        437 5486.383454 5486.374689
#&gt; LO-REDUCTION     439 5486.382834 5486.374689
#&gt; LO-REDUCTION     441 5486.382526 5486.374689
#&gt; LO-REDUCTION     443 5486.382299 5486.374689
#&gt; LO-REDUCTION     445 5486.380150 5486.374689
#&gt; EXTENSION        447 5486.379209 5486.370328
#&gt; LO-REDUCTION     449 5486.377964 5486.370328
#&gt; LO-REDUCTION     451 5486.377230 5486.370328
#&gt; EXTENSION        453 5486.376571 5486.365306
#&gt; LO-REDUCTION     455 5486.375823 5486.365306
#&gt; EXTENSION        457 5486.374689 5486.361851
#&gt; LO-REDUCTION     459 5486.370616 5486.361851
#&gt; EXTENSION        461 5486.370401 5486.357058
#&gt; LO-REDUCTION     463 5486.370328 5486.357058
#&gt; LO-REDUCTION     465 5486.368483 5486.357058
#&gt; EXTENSION        467 5486.365306 5486.350700
#&gt; LO-REDUCTION     469 5486.361917 5486.350700
#&gt; LO-REDUCTION     471 5486.361851 5486.350700
#&gt; LO-REDUCTION     473 5486.360767 5486.350700
#&gt; LO-REDUCTION     475 5486.358297 5486.350700
#&gt; REFLECTION       477 5486.357058 5486.349758
#&gt; LO-REDUCTION     479 5486.354167 5486.349758
#&gt; REFLECTION       481 5486.353315 5486.348550
#&gt; LO-REDUCTION     483 5486.351434 5486.348550
#&gt; EXTENSION        485 5486.351024 5486.346371
#&gt; HI-REDUCTION     487 5486.350700 5486.346371
#&gt; LO-REDUCTION     489 5486.349871 5486.346371
#&gt; LO-REDUCTION     491 5486.349758 5486.346371
#&gt; EXTENSION        493 5486.348850 5486.344830
#&gt; LO-REDUCTION     495 5486.348624 5486.344830
#&gt; LO-REDUCTION     497 5486.348550 5486.344830
#&gt; EXTENSION        499 5486.347346 5486.342973
#&gt; LO-REDUCTION     501 5486.346511 5486.342973
#&gt; EXTENSION        503 5486.346371 5486.342033
#&gt; LO-REDUCTION     505 5486.345970 5486.342033
#&gt; LO-REDUCTION     507 5486.345746 5486.342033
#&gt; LO-REDUCTION     509 5486.344830 5486.342033
#&gt; LO-REDUCTION     511 5486.343353 5486.341972
#&gt; REFLECTION       513 5486.342989 5486.341968
#&gt; LO-REDUCTION     515 5486.342973 5486.341790
#&gt; LO-REDUCTION     517 5486.342333 5486.341713
#&gt; LO-REDUCTION     519 5486.342251 5486.341713
#&gt; HI-REDUCTION     521 5486.342033 5486.341713
#&gt; HI-REDUCTION     523 5486.341972 5486.341713
#&gt; REFLECTION       525 5486.341968 5486.341654
#&gt; REFLECTION       527 5486.341818 5486.341574
#&gt; LO-REDUCTION     529 5486.341790 5486.341574
#&gt; LO-REDUCTION     531 5486.341765 5486.341574
#&gt; LO-REDUCTION     533 5486.341729 5486.341572
#&gt; LO-REDUCTION     535 5486.341713 5486.341572
#&gt; LO-REDUCTION     537 5486.341654 5486.341547
#&gt; Exiting from Nelder Mead minimizer
#&gt;     539 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9666287   1.5020375  -2.9964761  -0.9416437  -0.6144657   0.3014643 
#&gt; 
#&gt; $value
#&gt; [1] 5486.342
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      539 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.51 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===================================                                   |  50%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6181.997532
#&gt;   Scaled convergence tolerance is 9.21189e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11894.383327 5773.505814
#&gt; LO-REDUCTION       9 7931.511344 5773.505814
#&gt; HI-REDUCTION      11 7866.986981 5773.505814
#&gt; LO-REDUCTION      13 7047.117198 5773.505814
#&gt; LO-REDUCTION      15 6647.869726 5773.505814
#&gt; LO-REDUCTION      17 6456.204541 5773.505814
#&gt; REFLECTION        19 6412.384306 5667.441473
#&gt; REFLECTION        21 6208.467221 5532.661939
#&gt; LO-REDUCTION      23 6181.997532 5532.661939
#&gt; LO-REDUCTION      25 5793.128207 5532.661939
#&gt; HI-REDUCTION      27 5788.769010 5532.661939
#&gt; LO-REDUCTION      29 5773.505814 5532.661939
#&gt; HI-REDUCTION      31 5668.113572 5532.661939
#&gt; LO-REDUCTION      33 5667.441473 5532.661939
#&gt; LO-REDUCTION      35 5611.836262 5530.284425
#&gt; LO-REDUCTION      37 5611.150668 5522.999416
#&gt; LO-REDUCTION      39 5549.232089 5522.999416
#&gt; HI-REDUCTION      41 5535.756851 5522.999416
#&gt; HI-REDUCTION      43 5534.380861 5522.066798
#&gt; REFLECTION        45 5532.661939 5517.969720
#&gt; HI-REDUCTION      47 5530.284425 5517.969720
#&gt; LO-REDUCTION      49 5525.930769 5515.917588
#&gt; HI-REDUCTION      51 5525.701777 5515.917588
#&gt; LO-REDUCTION      53 5522.999416 5515.917588
#&gt; HI-REDUCTION      55 5522.066798 5515.865941
#&gt; LO-REDUCTION      57 5520.044439 5514.717533
#&gt; LO-REDUCTION      59 5518.051761 5514.717533
#&gt; LO-REDUCTION      61 5517.969720 5514.717533
#&gt; LO-REDUCTION      63 5516.817515 5514.704672
#&gt; LO-REDUCTION      65 5516.219755 5514.500123
#&gt; REFLECTION        67 5515.917588 5514.165353
#&gt; LO-REDUCTION      69 5515.865941 5514.165353
#&gt; REFLECTION        71 5514.944793 5513.949760
#&gt; REFLECTION        73 5514.717533 5513.944306
#&gt; HI-REDUCTION      75 5514.704672 5513.751986
#&gt; REFLECTION        77 5514.500123 5512.930198
#&gt; HI-REDUCTION      79 5514.334644 5512.930198
#&gt; LO-REDUCTION      81 5514.165353 5512.930198
#&gt; HI-REDUCTION      83 5513.949760 5512.930198
#&gt; HI-REDUCTION      85 5513.944306 5512.930198
#&gt; LO-REDUCTION      87 5513.751986 5512.930198
#&gt; EXTENSION         89 5513.599283 5512.422564
#&gt; LO-REDUCTION      91 5513.407698 5512.422564
#&gt; LO-REDUCTION      93 5513.318200 5512.422564
#&gt; EXTENSION         95 5513.225470 5511.792505
#&gt; LO-REDUCTION      97 5513.114822 5511.792505
#&gt; EXTENSION         99 5512.930198 5510.945414
#&gt; EXTENSION        101 5512.561138 5510.481340
#&gt; LO-REDUCTION     103 5512.539953 5510.481340
#&gt; LO-REDUCTION     105 5512.422564 5510.481340
#&gt; REFLECTION       107 5511.868882 5510.228900
#&gt; LO-REDUCTION     109 5511.792505 5510.228900
#&gt; EXTENSION        111 5511.263421 5509.100431
#&gt; EXTENSION        113 5510.945414 5508.104430
#&gt; LO-REDUCTION     115 5510.931739 5508.104430
#&gt; EXTENSION        117 5510.481340 5507.131579
#&gt; LO-REDUCTION     119 5510.240747 5507.131579
#&gt; EXTENSION        121 5510.228900 5506.333063
#&gt; LO-REDUCTION     123 5509.293558 5506.333063
#&gt; EXTENSION        125 5509.100431 5506.240604
#&gt; REFLECTION       127 5508.490202 5505.645420
#&gt; EXTENSION        129 5508.104430 5504.900350
#&gt; LO-REDUCTION     131 5507.131579 5504.900350
#&gt; LO-REDUCTION     133 5507.072062 5504.900350
#&gt; LO-REDUCTION     135 5506.333063 5504.900350
#&gt; LO-REDUCTION     137 5506.240604 5504.900350
#&gt; LO-REDUCTION     139 5506.064731 5504.900350
#&gt; REFLECTION       141 5505.645420 5504.729092
#&gt; HI-REDUCTION     143 5505.545090 5504.729092
#&gt; LO-REDUCTION     145 5505.456331 5504.729092
#&gt; LO-REDUCTION     147 5505.330528 5504.729092
#&gt; LO-REDUCTION     149 5505.194803 5504.728925
#&gt; EXTENSION        151 5505.161280 5504.437641
#&gt; LO-REDUCTION     153 5504.900350 5504.437641
#&gt; LO-REDUCTION     155 5504.894744 5504.437641
#&gt; REFLECTION       157 5504.743023 5504.352995
#&gt; LO-REDUCTION     159 5504.729092 5504.352995
#&gt; LO-REDUCTION     161 5504.728925 5504.339056
#&gt; LO-REDUCTION     163 5504.559881 5504.306578
#&gt; EXTENSION        165 5504.440803 5504.162478
#&gt; HI-REDUCTION     167 5504.438287 5504.162478
#&gt; LO-REDUCTION     169 5504.437641 5504.162478
#&gt; HI-REDUCTION     171 5504.352995 5504.162478
#&gt; EXTENSION        173 5504.339056 5504.111814
#&gt; EXTENSION        175 5504.306578 5504.031007
#&gt; LO-REDUCTION     177 5504.291615 5504.031007
#&gt; LO-REDUCTION     179 5504.287424 5504.031007
#&gt; LO-REDUCTION     181 5504.240433 5504.031007
#&gt; REFLECTION       183 5504.162478 5504.008067
#&gt; EXTENSION        185 5504.111814 5503.941106
#&gt; LO-REDUCTION     187 5504.096545 5503.941106
#&gt; EXTENSION        189 5504.087281 5503.854329
#&gt; LO-REDUCTION     191 5504.064996 5503.854329
#&gt; EXTENSION        193 5504.031007 5503.826127
#&gt; LO-REDUCTION     195 5504.008067 5503.826127
#&gt; LO-REDUCTION     197 5504.001306 5503.826127
#&gt; LO-REDUCTION     199 5503.941106 5503.826127
#&gt; REFLECTION       201 5503.923380 5503.809925
#&gt; REFLECTION       203 5503.866034 5503.779590
#&gt; LO-REDUCTION     205 5503.854329 5503.779590
#&gt; HI-REDUCTION     207 5503.843138 5503.779590
#&gt; REFLECTION       209 5503.841355 5503.772384
#&gt; REFLECTION       211 5503.826127 5503.767822
#&gt; REFLECTION       213 5503.809925 5503.767296
#&gt; REFLECTION       215 5503.807864 5503.755241
#&gt; LO-REDUCTION     217 5503.785562 5503.749197
#&gt; REFLECTION       219 5503.779590 5503.739288
#&gt; LO-REDUCTION     221 5503.772384 5503.739288
#&gt; EXTENSION        223 5503.767822 5503.703984
#&gt; LO-REDUCTION     225 5503.767296 5503.703984
#&gt; LO-REDUCTION     227 5503.755241 5503.703984
#&gt; LO-REDUCTION     229 5503.749197 5503.703984
#&gt; EXTENSION        231 5503.739811 5503.678425
#&gt; LO-REDUCTION     233 5503.739288 5503.678425
#&gt; LO-REDUCTION     235 5503.730649 5503.678425
#&gt; EXTENSION        237 5503.727127 5503.671298
#&gt; LO-REDUCTION     239 5503.718519 5503.671298
#&gt; LO-REDUCTION     241 5503.703984 5503.670416
#&gt; EXTENSION        243 5503.696125 5503.647430
#&gt; LO-REDUCTION     245 5503.688821 5503.647430
#&gt; LO-REDUCTION     247 5503.679888 5503.647430
#&gt; LO-REDUCTION     249 5503.678425 5503.647430
#&gt; LO-REDUCTION     251 5503.671298 5503.647430
#&gt; REFLECTION       253 5503.670416 5503.644686
#&gt; HI-REDUCTION     255 5503.660443 5503.644686
#&gt; LO-REDUCTION     257 5503.652452 5503.644686
#&gt; HI-REDUCTION     259 5503.650621 5503.644686
#&gt; LO-REDUCTION     261 5503.650263 5503.644686
#&gt; LO-REDUCTION     263 5503.650107 5503.644686
#&gt; HI-REDUCTION     265 5503.647430 5503.644686
#&gt; REFLECTION       267 5503.646923 5503.643932
#&gt; HI-REDUCTION     269 5503.646405 5503.643932
#&gt; EXTENSION        271 5503.646141 5503.642269
#&gt; LO-REDUCTION     273 5503.645731 5503.642269
#&gt; LO-REDUCTION     275 5503.645322 5503.642269
#&gt; LO-REDUCTION     277 5503.644931 5503.642269
#&gt; LO-REDUCTION     279 5503.644686 5503.642269
#&gt; LO-REDUCTION     281 5503.643932 5503.642269
#&gt; LO-REDUCTION     283 5503.643756 5503.642269
#&gt; REFLECTION       285 5503.643355 5503.642018
#&gt; LO-REDUCTION     287 5503.643207 5503.642018
#&gt; LO-REDUCTION     289 5503.643195 5503.642018
#&gt; LO-REDUCTION     291 5503.642681 5503.642018
#&gt; LO-REDUCTION     293 5503.642346 5503.642018
#&gt; LO-REDUCTION     295 5503.642273 5503.642018
#&gt; HI-REDUCTION     297 5503.642269 5503.642018
#&gt; LO-REDUCTION     299 5503.642266 5503.642017
#&gt; Exiting from Nelder Mead minimizer
#&gt;     301 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9909773   1.4973399  -2.9946536  -0.9608636  -0.7230604   0.3063385 
#&gt; 
#&gt; $value
#&gt; [1] 5503.642
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      301 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.25 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==========================================                            |  60%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6094.504897
#&gt;   Scaled convergence tolerance is 9.08152e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11639.845540 5714.276139
#&gt; LO-REDUCTION       9 7681.543715 5714.276139
#&gt; HI-REDUCTION      11 7648.157440 5714.276139
#&gt; LO-REDUCTION      13 6946.378866 5714.276139
#&gt; LO-REDUCTION      15 6495.627916 5714.276139
#&gt; LO-REDUCTION      17 6346.503323 5714.276139
#&gt; REFLECTION        19 6310.952941 5630.467485
#&gt; REFLECTION        21 6112.006804 5503.006410
#&gt; LO-REDUCTION      23 6094.504897 5503.006410
#&gt; LO-REDUCTION      25 5744.329409 5497.856978
#&gt; HI-REDUCTION      27 5736.956749 5497.856978
#&gt; LO-REDUCTION      29 5714.276139 5497.856978
#&gt; HI-REDUCTION      31 5630.467485 5497.856978
#&gt; LO-REDUCTION      33 5630.223093 5497.856978
#&gt; LO-REDUCTION      35 5581.854950 5497.856978
#&gt; LO-REDUCTION      37 5575.361922 5493.719721
#&gt; LO-REDUCTION      39 5516.402495 5493.719721
#&gt; HI-REDUCTION      41 5503.006410 5493.719721
#&gt; HI-REDUCTION      43 5502.749330 5491.419889
#&gt; REFLECTION        45 5501.728324 5485.452891
#&gt; LO-REDUCTION      47 5497.856978 5485.452891
#&gt; LO-REDUCTION      49 5495.811524 5485.452891
#&gt; LO-REDUCTION      51 5495.292042 5485.062488
#&gt; LO-REDUCTION      53 5493.719721 5485.062488
#&gt; HI-REDUCTION      55 5491.419889 5485.062488
#&gt; LO-REDUCTION      57 5486.511790 5485.062488
#&gt; REFLECTION        59 5486.255691 5484.162516
#&gt; HI-REDUCTION      61 5485.945215 5483.820313
#&gt; HI-REDUCTION      63 5485.517939 5483.820313
#&gt; LO-REDUCTION      65 5485.452891 5483.601644
#&gt; REFLECTION        67 5485.404762 5482.637569
#&gt; LO-REDUCTION      69 5485.062488 5482.637569
#&gt; HI-REDUCTION      71 5484.162516 5482.637569
#&gt; LO-REDUCTION      73 5483.967708 5482.637569
#&gt; LO-REDUCTION      75 5483.820313 5482.637569
#&gt; LO-REDUCTION      77 5483.601644 5482.637569
#&gt; LO-REDUCTION      79 5483.487582 5482.637569
#&gt; REFLECTION        81 5483.252414 5482.498723
#&gt; LO-REDUCTION      83 5483.215405 5482.406416
#&gt; LO-REDUCTION      85 5482.903559 5482.406416
#&gt; REFLECTION        87 5482.715602 5482.327041
#&gt; LO-REDUCTION      89 5482.706608 5482.304830
#&gt; HI-REDUCTION      91 5482.637569 5482.304830
#&gt; REFLECTION        93 5482.508791 5482.180826
#&gt; REFLECTION        95 5482.498723 5482.058493
#&gt; LO-REDUCTION      97 5482.406416 5482.058493
#&gt; LO-REDUCTION      99 5482.382754 5482.058493
#&gt; EXTENSION        101 5482.327041 5481.737661
#&gt; LO-REDUCTION     103 5482.304830 5481.737661
#&gt; LO-REDUCTION     105 5482.211477 5481.737661
#&gt; LO-REDUCTION     107 5482.192852 5481.737661
#&gt; LO-REDUCTION     109 5482.180826 5481.737661
#&gt; EXTENSION        111 5482.058493 5481.430684
#&gt; LO-REDUCTION     113 5482.028149 5481.430684
#&gt; LO-REDUCTION     115 5481.997179 5481.430684
#&gt; LO-REDUCTION     117 5481.897026 5481.430684
#&gt; EXTENSION        119 5481.868768 5480.940296
#&gt; LO-REDUCTION     121 5481.737661 5480.940296
#&gt; LO-REDUCTION     123 5481.538561 5480.940296
#&gt; LO-REDUCTION     125 5481.525672 5480.940296
#&gt; LO-REDUCTION     127 5481.522854 5480.940296
#&gt; EXTENSION        129 5481.459323 5480.652787
#&gt; EXTENSION        131 5481.430684 5480.330382
#&gt; LO-REDUCTION     133 5481.095846 5480.330382
#&gt; EXTENSION        135 5481.073043 5479.993977
#&gt; LO-REDUCTION     137 5481.050278 5479.993977
#&gt; LO-REDUCTION     139 5480.940296 5479.993977
#&gt; EXTENSION        141 5480.652787 5479.451195
#&gt; EXTENSION        143 5480.336107 5479.137606
#&gt; LO-REDUCTION     145 5480.330382 5479.137606
#&gt; LO-REDUCTION     147 5480.154099 5479.137606
#&gt; LO-REDUCTION     149 5480.116643 5479.137606
#&gt; EXTENSION        151 5479.993977 5478.278515
#&gt; LO-REDUCTION     153 5479.629682 5478.278515
#&gt; LO-REDUCTION     155 5479.481064 5478.278515
#&gt; LO-REDUCTION     157 5479.451195 5478.278515
#&gt; LO-REDUCTION     159 5479.334421 5478.278515
#&gt; LO-REDUCTION     161 5479.166170 5478.278515
#&gt; EXTENSION        163 5479.137606 5477.751352
#&gt; LO-REDUCTION     165 5478.799604 5477.751352
#&gt; LO-REDUCTION     167 5478.756561 5477.751352
#&gt; EXTENSION        169 5478.635131 5477.525240
#&gt; EXTENSION        171 5478.353083 5476.824827
#&gt; LO-REDUCTION     173 5478.278515 5476.824827
#&gt; LO-REDUCTION     175 5478.184006 5476.824827
#&gt; LO-REDUCTION     177 5478.039396 5476.824827
#&gt; EXTENSION        179 5477.751352 5476.567347
#&gt; LO-REDUCTION     181 5477.525240 5476.567347
#&gt; EXTENSION        183 5477.356252 5476.449589
#&gt; REFLECTION       185 5477.225077 5476.406400
#&gt; REFLECTION       187 5477.056597 5476.185117
#&gt; LO-REDUCTION     189 5476.824827 5476.185117
#&gt; HI-REDUCTION     191 5476.750469 5476.185117
#&gt; LO-REDUCTION     193 5476.567347 5476.185117
#&gt; LO-REDUCTION     195 5476.449589 5476.185117
#&gt; LO-REDUCTION     197 5476.433479 5476.185117
#&gt; HI-REDUCTION     199 5476.406400 5476.185117
#&gt; EXTENSION        201 5476.340196 5476.106382
#&gt; LO-REDUCTION     203 5476.325904 5476.106382
#&gt; LO-REDUCTION     205 5476.291471 5476.106382
#&gt; LO-REDUCTION     207 5476.290321 5476.106382
#&gt; EXTENSION        209 5476.253948 5475.962589
#&gt; LO-REDUCTION     211 5476.185117 5475.962589
#&gt; LO-REDUCTION     213 5476.182815 5475.962589
#&gt; EXTENSION        215 5476.125839 5475.846119
#&gt; LO-REDUCTION     217 5476.114837 5475.846119
#&gt; LO-REDUCTION     219 5476.106382 5475.846119
#&gt; REFLECTION       221 5476.049554 5475.824477
#&gt; REFLECTION       223 5475.964056 5475.770463
#&gt; LO-REDUCTION     225 5475.962589 5475.770463
#&gt; LO-REDUCTION     227 5475.906741 5475.770463
#&gt; LO-REDUCTION     229 5475.877692 5475.770463
#&gt; REFLECTION       231 5475.846119 5475.763963
#&gt; LO-REDUCTION     233 5475.826102 5475.763963
#&gt; EXTENSION        235 5475.824477 5475.745779
#&gt; LO-REDUCTION     237 5475.805750 5475.745779
#&gt; LO-REDUCTION     239 5475.802889 5475.745779
#&gt; EXTENSION        241 5475.800074 5475.680546
#&gt; LO-REDUCTION     243 5475.770463 5475.680546
#&gt; LO-REDUCTION     245 5475.763963 5475.680546
#&gt; LO-REDUCTION     247 5475.761576 5475.680546
#&gt; LO-REDUCTION     249 5475.751721 5475.680546
#&gt; EXTENSION        251 5475.745779 5475.635496
#&gt; LO-REDUCTION     253 5475.714818 5475.635496
#&gt; EXTENSION        255 5475.706469 5475.577604
#&gt; LO-REDUCTION     257 5475.694149 5475.577604
#&gt; LO-REDUCTION     259 5475.691897 5475.577604
#&gt; REFLECTION       261 5475.680546 5475.574789
#&gt; EXTENSION        263 5475.639001 5475.510444
#&gt; LO-REDUCTION     265 5475.635496 5475.510444
#&gt; EXTENSION        267 5475.584413 5475.451899
#&gt; LO-REDUCTION     269 5475.584128 5475.451899
#&gt; LO-REDUCTION     271 5475.577604 5475.451899
#&gt; LO-REDUCTION     273 5475.574789 5475.451899
#&gt; REFLECTION       275 5475.530671 5475.433466
#&gt; LO-REDUCTION     277 5475.510444 5475.433466
#&gt; LO-REDUCTION     279 5475.504126 5475.433466
#&gt; EXTENSION        281 5475.487274 5475.396416
#&gt; LO-REDUCTION     283 5475.478553 5475.396416
#&gt; LO-REDUCTION     285 5475.457888 5475.396416
#&gt; EXTENSION        287 5475.451899 5475.355273
#&gt; LO-REDUCTION     289 5475.450384 5475.355273
#&gt; REFLECTION       291 5475.433466 5475.345357
#&gt; HI-REDUCTION     293 5475.406659 5475.345357
#&gt; EXTENSION        295 5475.398311 5475.319840
#&gt; LO-REDUCTION     297 5475.396416 5475.319840
#&gt; EXTENSION        299 5475.386414 5475.287057
#&gt; LO-REDUCTION     301 5475.378602 5475.287057
#&gt; EXTENSION        303 5475.355273 5475.268650
#&gt; LO-REDUCTION     305 5475.345357 5475.268650
#&gt; LO-REDUCTION     307 5475.345048 5475.268650
#&gt; LO-REDUCTION     309 5475.319840 5475.268650
#&gt; REFLECTION       311 5475.316312 5475.255041
#&gt; REFLECTION       313 5475.290146 5475.239327
#&gt; LO-REDUCTION     315 5475.287057 5475.239327
#&gt; HI-REDUCTION     317 5475.277569 5475.239327
#&gt; LO-REDUCTION     319 5475.269825 5475.239327
#&gt; EXTENSION        321 5475.268650 5475.224748
#&gt; LO-REDUCTION     323 5475.262414 5475.224748
#&gt; LO-REDUCTION     325 5475.255041 5475.224748
#&gt; LO-REDUCTION     327 5475.252724 5475.224748
#&gt; LO-REDUCTION     329 5475.250258 5475.224748
#&gt; REFLECTION       331 5475.242867 5475.221735
#&gt; REFLECTION       333 5475.239773 5475.221083
#&gt; EXTENSION        335 5475.239327 5475.196313
#&gt; LO-REDUCTION     337 5475.227161 5475.196313
#&gt; LO-REDUCTION     339 5475.224951 5475.196313
#&gt; LO-REDUCTION     341 5475.224748 5475.196313
#&gt; LO-REDUCTION     343 5475.221735 5475.196313
#&gt; EXTENSION        345 5475.221083 5475.178783
#&gt; EXTENSION        347 5475.207513 5475.169269
#&gt; LO-REDUCTION     349 5475.204509 5475.169269
#&gt; EXTENSION        351 5475.203061 5475.163594
#&gt; EXTENSION        353 5475.202544 5475.151486
#&gt; EXTENSION        355 5475.196313 5475.086519
#&gt; LO-REDUCTION     357 5475.178783 5475.086519
#&gt; LO-REDUCTION     359 5475.170487 5475.086519
#&gt; LO-REDUCTION     361 5475.169269 5475.086519
#&gt; LO-REDUCTION     363 5475.163594 5475.086519
#&gt; LO-REDUCTION     365 5475.151486 5475.086519
#&gt; EXTENSION        367 5475.142914 5475.067021
#&gt; EXTENSION        369 5475.136716 5475.039067
#&gt; EXTENSION        371 5475.130104 5474.990916
#&gt; EXTENSION        373 5475.108185 5474.930785
#&gt; LO-REDUCTION     375 5475.107861 5474.930785
#&gt; LO-REDUCTION     377 5475.086519 5474.930785
#&gt; LO-REDUCTION     379 5475.067021 5474.930785
#&gt; EXTENSION        381 5475.039067 5474.794804
#&gt; LO-REDUCTION     383 5474.990916 5474.794804
#&gt; LO-REDUCTION     385 5474.980424 5474.794804
#&gt; LO-REDUCTION     387 5474.953459 5474.794804
#&gt; EXTENSION        389 5474.933888 5474.735026
#&gt; EXTENSION        391 5474.930785 5474.620052
#&gt; LO-REDUCTION     393 5474.858833 5474.620052
#&gt; LO-REDUCTION     395 5474.827085 5474.620052
#&gt; EXTENSION        397 5474.823931 5474.505267
#&gt; LO-REDUCTION     399 5474.794804 5474.505267
#&gt; LO-REDUCTION     401 5474.735026 5474.505267
#&gt; EXTENSION        403 5474.690998 5474.457649
#&gt; LO-REDUCTION     405 5474.673877 5474.457649
#&gt; EXTENSION        407 5474.620052 5474.333852
#&gt; LO-REDUCTION     409 5474.596345 5474.333852
#&gt; EXTENSION        411 5474.579754 5474.199826
#&gt; LO-REDUCTION     413 5474.505267 5474.199826
#&gt; LO-REDUCTION     415 5474.469139 5474.199826
#&gt; LO-REDUCTION     417 5474.457649 5474.199826
#&gt; REFLECTION       419 5474.425512 5474.180899
#&gt; REFLECTION       421 5474.333852 5474.143569
#&gt; LO-REDUCTION     423 5474.320680 5474.143569
#&gt; EXTENSION        425 5474.252360 5474.038884
#&gt; LO-REDUCTION     427 5474.214264 5474.038884
#&gt; LO-REDUCTION     429 5474.199826 5474.038884
#&gt; LO-REDUCTION     431 5474.180899 5474.038884
#&gt; LO-REDUCTION     433 5474.148147 5474.038884
#&gt; LO-REDUCTION     435 5474.143569 5474.038884
#&gt; LO-REDUCTION     437 5474.097431 5474.038884
#&gt; LO-REDUCTION     439 5474.088593 5474.038884
#&gt; LO-REDUCTION     441 5474.086021 5474.038884
#&gt; REFLECTION       443 5474.069906 5474.037435
#&gt; LO-REDUCTION     445 5474.065309 5474.037435
#&gt; LO-REDUCTION     447 5474.059885 5474.037435
#&gt; LO-REDUCTION     449 5474.056859 5474.037435
#&gt; LO-REDUCTION     451 5474.051540 5474.037435
#&gt; REFLECTION       453 5474.047375 5474.032466
#&gt; EXTENSION        455 5474.043093 5474.028348
#&gt; EXTENSION        457 5474.040297 5474.025669
#&gt; LO-REDUCTION     459 5474.038884 5474.025669
#&gt; LO-REDUCTION     461 5474.037661 5474.025669
#&gt; REFLECTION       463 5474.037435 5474.019915
#&gt; EXTENSION        465 5474.032466 5473.998192
#&gt; LO-REDUCTION     467 5474.028348 5473.998192
#&gt; LO-REDUCTION     469 5474.026670 5473.998192
#&gt; LO-REDUCTION     471 5474.025977 5473.998192
#&gt; LO-REDUCTION     473 5474.025669 5473.998192
#&gt; LO-REDUCTION     475 5474.021807 5473.998192
#&gt; LO-REDUCTION     477 5474.019915 5473.998192
#&gt; EXTENSION        479 5474.016820 5473.994112
#&gt; EXTENSION        481 5474.011795 5473.974497
#&gt; EXTENSION        483 5474.009024 5473.957720
#&gt; LO-REDUCTION     485 5474.000154 5473.957720
#&gt; LO-REDUCTION     487 5473.999564 5473.957720
#&gt; LO-REDUCTION     489 5473.998192 5473.957720
#&gt; REFLECTION       491 5473.994112 5473.954125
#&gt; EXTENSION        493 5473.974497 5473.909728
#&gt; LO-REDUCTION     495 5473.970442 5473.909728
#&gt; LO-REDUCTION     497 5473.964945 5473.909728
#&gt; LO-REDUCTION     499 5473.959974 5473.909728
#&gt; EXTENSION        501 5473.957720 5473.897530
#&gt; REFLECTION       503 5473.954125 5473.895731
#&gt; EXTENSION        505 5473.929720 5473.873326
#&gt; LO-REDUCTION     507 5473.919950 5473.873326
#&gt; REFLECTION       509 5473.911941 5473.870153
#&gt; LO-REDUCTION     511 5473.909728 5473.870153
#&gt; LO-REDUCTION     513 5473.897530 5473.870153
#&gt; REFLECTION       515 5473.895731 5473.867126
#&gt; HI-REDUCTION     517 5473.881214 5473.867126
#&gt; REFLECTION       519 5473.879583 5473.862488
#&gt; LO-REDUCTION     521 5473.875060 5473.862488
#&gt; HI-REDUCTION     523 5473.873508 5473.862488
#&gt; LO-REDUCTION     525 5473.873326 5473.862488
#&gt; REFLECTION       527 5473.870153 5473.861375
#&gt; REFLECTION       529 5473.867126 5473.856807
#&gt; LO-REDUCTION     531 5473.866865 5473.856807
#&gt; LO-REDUCTION     533 5473.863882 5473.856807
#&gt; REFLECTION       535 5473.862754 5473.854697
#&gt; LO-REDUCTION     537 5473.862488 5473.854697
#&gt; REFLECTION       539 5473.861375 5473.854578
#&gt; LO-REDUCTION     541 5473.858739 5473.854117
#&gt; REFLECTION       543 5473.857293 5473.852606
#&gt; EXTENSION        545 5473.856807 5473.850066
#&gt; LO-REDUCTION     547 5473.855436 5473.850066
#&gt; LO-REDUCTION     549 5473.854697 5473.850066
#&gt; EXTENSION        551 5473.854578 5473.847593
#&gt; LO-REDUCTION     553 5473.854117 5473.847593
#&gt; LO-REDUCTION     555 5473.852606 5473.847593
#&gt; LO-REDUCTION     557 5473.851770 5473.847593
#&gt; LO-REDUCTION     559 5473.851710 5473.847461
#&gt; REFLECTION       561 5473.850066 5473.846363
#&gt; LO-REDUCTION     563 5473.848702 5473.846363
#&gt; LO-REDUCTION     565 5473.848519 5473.846363
#&gt; LO-REDUCTION     567 5473.847857 5473.846342
#&gt; HI-REDUCTION     569 5473.847593 5473.846342
#&gt; REFLECTION       571 5473.847461 5473.846190
#&gt; EXTENSION        573 5473.846840 5473.844527
#&gt; LO-REDUCTION     575 5473.846626 5473.844527
#&gt; LO-REDUCTION     577 5473.846479 5473.844527
#&gt; LO-REDUCTION     579 5473.846363 5473.844527
#&gt; LO-REDUCTION     581 5473.846342 5473.844527
#&gt; LO-REDUCTION     583 5473.846190 5473.844527
#&gt; EXTENSION        585 5473.845625 5473.844354
#&gt; EXTENSION        587 5473.845570 5473.843521
#&gt; EXTENSION        589 5473.845532 5473.842992
#&gt; EXTENSION        591 5473.845200 5473.842332
#&gt; EXTENSION        593 5473.844604 5473.842148
#&gt; LO-REDUCTION     595 5473.844527 5473.842148
#&gt; LO-REDUCTION     597 5473.844354 5473.842148
#&gt; EXTENSION        599 5473.843521 5473.839514
#&gt; HI-REDUCTION     601 5473.843114 5473.839514
#&gt; LO-REDUCTION     603 5473.842992 5473.839514
#&gt; LO-REDUCTION     605 5473.842332 5473.839514
#&gt; LO-REDUCTION     607 5473.842232 5473.839514
#&gt; LO-REDUCTION     609 5473.842148 5473.839514
#&gt; REFLECTION       611 5473.842091 5473.839404
#&gt; REFLECTION       613 5473.840756 5473.838911
#&gt; EXTENSION        615 5473.840658 5473.837789
#&gt; EXTENSION        617 5473.840183 5473.836627
#&gt; LO-REDUCTION     619 5473.839533 5473.836627
#&gt; LO-REDUCTION     621 5473.839514 5473.836627
#&gt; LO-REDUCTION     623 5473.839404 5473.836627
#&gt; REFLECTION       625 5473.838911 5473.836379
#&gt; LO-REDUCTION     627 5473.837789 5473.836379
#&gt; LO-REDUCTION     629 5473.837649 5473.836379
#&gt; EXTENSION        631 5473.837306 5473.835231
#&gt; LO-REDUCTION     633 5473.836925 5473.835231
#&gt; EXTENSION        635 5473.836715 5473.834741
#&gt; EXTENSION        637 5473.836629 5473.833449
#&gt; LO-REDUCTION     639 5473.836627 5473.833449
#&gt; LO-REDUCTION     641 5473.836379 5473.833449
#&gt; REFLECTION       643 5473.835531 5473.833277
#&gt; EXTENSION        645 5473.835231 5473.831434
#&gt; EXTENSION        647 5473.834741 5473.829841
#&gt; EXTENSION        649 5473.833705 5473.827955
#&gt; LO-REDUCTION     651 5473.833579 5473.827955
#&gt; LO-REDUCTION     653 5473.833449 5473.827955
#&gt; REFLECTION       655 5473.833277 5473.827727
#&gt; EXTENSION        657 5473.831434 5473.822149
#&gt; LO-REDUCTION     659 5473.829841 5473.822149
#&gt; LO-REDUCTION     661 5473.829578 5473.822149
#&gt; EXTENSION        663 5473.828328 5473.821091
#&gt; EXTENSION        665 5473.827955 5473.815772
#&gt; LO-REDUCTION     667 5473.827727 5473.815772
#&gt; EXTENSION        669 5473.824588 5473.808033
#&gt; LO-REDUCTION     671 5473.822827 5473.808033
#&gt; LO-REDUCTION     673 5473.822149 5473.808033
#&gt; LO-REDUCTION     675 5473.821091 5473.808033
#&gt; LO-REDUCTION     677 5473.819871 5473.808033
#&gt; EXTENSION        679 5473.815772 5473.804933
#&gt; LO-REDUCTION     681 5473.815622 5473.804933
#&gt; EXTENSION        683 5473.814886 5473.801696
#&gt; EXTENSION        685 5473.813899 5473.797162
#&gt; EXTENSION        687 5473.809726 5473.795683
#&gt; LO-REDUCTION     689 5473.808033 5473.795683
#&gt; LO-REDUCTION     691 5473.807704 5473.795683
#&gt; REFLECTION       693 5473.804933 5473.794562
#&gt; LO-REDUCTION     695 5473.801696 5473.794562
#&gt; LO-REDUCTION     697 5473.799969 5473.794562
#&gt; EXTENSION        699 5473.798177 5473.791131
#&gt; LO-REDUCTION     701 5473.797288 5473.791131
#&gt; LO-REDUCTION     703 5473.797162 5473.791131
#&gt; LO-REDUCTION     705 5473.796069 5473.791131
#&gt; EXTENSION        707 5473.795683 5473.788033
#&gt; LO-REDUCTION     709 5473.794562 5473.788033
#&gt; LO-REDUCTION     711 5473.793948 5473.788033
#&gt; LO-REDUCTION     713 5473.793088 5473.788033
#&gt; LO-REDUCTION     715 5473.792475 5473.788033
#&gt; LO-REDUCTION     717 5473.791293 5473.788033
#&gt; REFLECTION       719 5473.791131 5473.787640
#&gt; EXTENSION        721 5473.790334 5473.785235
#&gt; EXTENSION        723 5473.788945 5473.783414
#&gt; LO-REDUCTION     725 5473.788561 5473.783414
#&gt; LO-REDUCTION     727 5473.788377 5473.783414
#&gt; LO-REDUCTION     729 5473.788033 5473.783414
#&gt; LO-REDUCTION     731 5473.787640 5473.783414
#&gt; REFLECTION       733 5473.785517 5473.783059
#&gt; LO-REDUCTION     735 5473.785235 5473.783059
#&gt; LO-REDUCTION     737 5473.784960 5473.783059
#&gt; LO-REDUCTION     739 5473.784926 5473.783059
#&gt; EXTENSION        741 5473.784484 5473.780839
#&gt; LO-REDUCTION     743 5473.783738 5473.780839
#&gt; LO-REDUCTION     745 5473.783586 5473.780839
#&gt; LO-REDUCTION     747 5473.783414 5473.780839
#&gt; LO-REDUCTION     749 5473.783282 5473.780839
#&gt; EXTENSION        751 5473.783059 5473.779221
#&gt; LO-REDUCTION     753 5473.782092 5473.779221
#&gt; LO-REDUCTION     755 5473.781739 5473.779221
#&gt; EXTENSION        757 5473.781706 5473.777875
#&gt; EXTENSION        759 5473.781034 5473.776005
#&gt; LO-REDUCTION     761 5473.780839 5473.776005
#&gt; LO-REDUCTION     763 5473.779556 5473.776005
#&gt; EXTENSION        765 5473.779452 5473.775541
#&gt; EXTENSION        767 5473.779221 5473.773915
#&gt; REFLECTION       769 5473.777875 5473.773771
#&gt; LO-REDUCTION     771 5473.776400 5473.773771
#&gt; LO-REDUCTION     773 5473.776394 5473.773771
#&gt; LO-REDUCTION     775 5473.776005 5473.773739
#&gt; LO-REDUCTION     777 5473.775541 5473.773739
#&gt; REFLECTION       779 5473.774466 5473.773250
#&gt; EXTENSION        781 5473.774282 5473.772095
#&gt; LO-REDUCTION     783 5473.774188 5473.772095
#&gt; LO-REDUCTION     785 5473.773915 5473.772095
#&gt; LO-REDUCTION     787 5473.773771 5473.772095
#&gt; EXTENSION        789 5473.773739 5473.771533
#&gt; LO-REDUCTION     791 5473.773250 5473.771533
#&gt; EXTENSION        793 5473.772511 5473.769498
#&gt; LO-REDUCTION     795 5473.772475 5473.769498
#&gt; LO-REDUCTION     797 5473.772365 5473.769498
#&gt; LO-REDUCTION     799 5473.772095 5473.769498
#&gt; EXTENSION        801 5473.771834 5473.767659
#&gt; EXTENSION        803 5473.771533 5473.765735
#&gt; LO-REDUCTION     805 5473.771113 5473.765735
#&gt; EXTENSION        807 5473.770492 5473.763002
#&gt; LO-REDUCTION     809 5473.769807 5473.763002
#&gt; EXTENSION        811 5473.769498 5473.759537
#&gt; EXTENSION        813 5473.767659 5473.755052
#&gt; LO-REDUCTION     815 5473.767396 5473.755052
#&gt; EXTENSION        817 5473.765735 5473.749389
#&gt; LO-REDUCTION     819 5473.763714 5473.749389
#&gt; EXTENSION        821 5473.763002 5473.745718
#&gt; EXTENSION        823 5473.759537 5473.737299
#&gt; LO-REDUCTION     825 5473.757645 5473.737299
#&gt; LO-REDUCTION     827 5473.755052 5473.737299
#&gt; REFLECTION       829 5473.750580 5473.736900
#&gt; LO-REDUCTION     831 5473.749389 5473.736900
#&gt; LO-REDUCTION     833 5473.745718 5473.736818
#&gt; EXTENSION        835 5473.740172 5473.726512
#&gt; LO-REDUCTION     837 5473.738907 5473.726512
#&gt; LO-REDUCTION     839 5473.738744 5473.726512
#&gt; LO-REDUCTION     841 5473.737299 5473.726512
#&gt; LO-REDUCTION     843 5473.736900 5473.726512
#&gt; EXTENSION        845 5473.736818 5473.723092
#&gt; EXTENSION        847 5473.731503 5473.717112
#&gt; LO-REDUCTION     849 5473.731117 5473.717112
#&gt; LO-REDUCTION     851 5473.730067 5473.717112
#&gt; EXTENSION        853 5473.728858 5473.712339
#&gt; LO-REDUCTION     855 5473.726512 5473.712339
#&gt; LO-REDUCTION     857 5473.723092 5473.712339
#&gt; EXTENSION        859 5473.717862 5473.704628
#&gt; LO-REDUCTION     861 5473.717544 5473.704628
#&gt; LO-REDUCTION     863 5473.717112 5473.704628
#&gt; LO-REDUCTION     865 5473.716366 5473.704628
#&gt; LO-REDUCTION     867 5473.714095 5473.704628
#&gt; LO-REDUCTION     869 5473.712791 5473.704628
#&gt; LO-REDUCTION     871 5473.712339 5473.704628
#&gt; LO-REDUCTION     873 5473.711250 5473.704628
#&gt; EXTENSION        875 5473.710166 5473.700342
#&gt; LO-REDUCTION     877 5473.708555 5473.700342
#&gt; EXTENSION        879 5473.706855 5473.696791
#&gt; LO-REDUCTION     881 5473.706375 5473.696791
#&gt; EXTENSION        883 5473.704984 5473.690286
#&gt; LO-REDUCTION     885 5473.704628 5473.690286
#&gt; LO-REDUCTION     887 5473.703547 5473.690286
#&gt; EXTENSION        889 5473.700342 5473.684064
#&gt; LO-REDUCTION     891 5473.698049 5473.684064
#&gt; LO-REDUCTION     893 5473.696791 5473.684064
#&gt; EXTENSION        895 5473.694606 5473.681874
#&gt; EXTENSION        897 5473.694261 5473.677524
#&gt; EXTENSION        899 5473.690286 5473.674723
#&gt; LO-REDUCTION     901 5473.686705 5473.674723
#&gt; LO-REDUCTION     903 5473.685476 5473.674723
#&gt; REFLECTION       905 5473.684064 5473.674622
#&gt; LO-REDUCTION     907 5473.681874 5473.674622
#&gt; LO-REDUCTION     909 5473.679268 5473.674622
#&gt; EXTENSION        911 5473.677524 5473.668658
#&gt; HI-REDUCTION     913 5473.676168 5473.668658
#&gt; LO-REDUCTION     915 5473.675163 5473.668658
#&gt; LO-REDUCTION     917 5473.675141 5473.668658
#&gt; LO-REDUCTION     919 5473.674723 5473.668658
#&gt; LO-REDUCTION     921 5473.674622 5473.668658
#&gt; REFLECTION       923 5473.673273 5473.668239
#&gt; LO-REDUCTION     925 5473.672723 5473.668239
#&gt; EXTENSION        927 5473.670870 5473.664155
#&gt; LO-REDUCTION     929 5473.670240 5473.664155
#&gt; LO-REDUCTION     931 5473.669551 5473.664155
#&gt; EXTENSION        933 5473.668688 5473.661380
#&gt; LO-REDUCTION     935 5473.668658 5473.661380
#&gt; LO-REDUCTION     937 5473.668239 5473.661380
#&gt; EXTENSION        939 5473.665180 5473.658746
#&gt; LO-REDUCTION     941 5473.664914 5473.658746
#&gt; LO-REDUCTION     943 5473.664308 5473.658746
#&gt; LO-REDUCTION     945 5473.664155 5473.658746
#&gt; REFLECTION       947 5473.662539 5473.658533
#&gt; EXTENSION        949 5473.661380 5473.657291
#&gt; LO-REDUCTION     951 5473.661213 5473.657291
#&gt; LO-REDUCTION     953 5473.660590 5473.657291
#&gt; LO-REDUCTION     955 5473.659413 5473.657291
#&gt; LO-REDUCTION     957 5473.658746 5473.657291
#&gt; HI-REDUCTION     959 5473.658724 5473.657291
#&gt; REFLECTION       961 5473.658533 5473.657173
#&gt; LO-REDUCTION     963 5473.658374 5473.657173
#&gt; EXTENSION        965 5473.657980 5473.655952
#&gt; LO-REDUCTION     967 5473.657736 5473.655952
#&gt; LO-REDUCTION     969 5473.657719 5473.655952
#&gt; LO-REDUCTION     971 5473.657650 5473.655952
#&gt; LO-REDUCTION     973 5473.657291 5473.655952
#&gt; EXTENSION        975 5473.657173 5473.655550
#&gt; LO-REDUCTION     977 5473.656947 5473.655550
#&gt; LO-REDUCTION     979 5473.656749 5473.655550
#&gt; EXTENSION        981 5473.656479 5473.655033
#&gt; LO-REDUCTION     983 5473.656448 5473.655033
#&gt; LO-REDUCTION     985 5473.655952 5473.655033
#&gt; LO-REDUCTION     987 5473.655816 5473.655033
#&gt; EXTENSION        989 5473.655556 5473.654585
#&gt; LO-REDUCTION     991 5473.655550 5473.654585
#&gt; LO-REDUCTION     993 5473.655260 5473.654585
#&gt; EXTENSION        995 5473.655132 5473.654170
#&gt; LO-REDUCTION     997 5473.655051 5473.654170
#&gt; LO-REDUCTION     999 5473.655033 5473.654170
#&gt; LO-REDUCTION    1001 5473.654974 5473.654170
#&gt; LO-REDUCTION    1003 5473.654799 5473.654170
#&gt; LO-REDUCTION    1005 5473.654733 5473.654170
#&gt; LO-REDUCTION    1007 5473.654634 5473.654170
#&gt; EXTENSION       1009 5473.654585 5473.653950
#&gt; LO-REDUCTION    1011 5473.654557 5473.653950
#&gt; EXTENSION       1013 5473.654282 5473.653327
#&gt; LO-REDUCTION    1015 5473.654228 5473.653327
#&gt; LO-REDUCTION    1017 5473.654215 5473.653327
#&gt; LO-REDUCTION    1019 5473.654170 5473.653327
#&gt; LO-REDUCTION    1021 5473.653957 5473.653327
#&gt; EXTENSION       1023 5473.653950 5473.653082
#&gt; EXTENSION       1025 5473.653697 5473.652919
#&gt; EXTENSION       1027 5473.653656 5473.652440
#&gt; LO-REDUCTION    1029 5473.653579 5473.652440
#&gt; EXTENSION       1031 5473.653434 5473.651761
#&gt; LO-REDUCTION    1033 5473.653327 5473.651761
#&gt; LO-REDUCTION    1035 5473.653082 5473.651761
#&gt; EXTENSION       1037 5473.652919 5473.651403
#&gt; EXTENSION       1039 5473.652823 5473.651074
#&gt; EXTENSION       1041 5473.652440 5473.649862
#&gt; LO-REDUCTION    1043 5473.652319 5473.649862
#&gt; EXTENSION       1045 5473.652097 5473.648600
#&gt; LO-REDUCTION    1047 5473.651761 5473.648600
#&gt; LO-REDUCTION    1049 5473.651403 5473.648600
#&gt; EXTENSION       1051 5473.651074 5473.647920
#&gt; LO-REDUCTION    1053 5473.650934 5473.647920
#&gt; EXTENSION       1055 5473.649862 5473.645818
#&gt; LO-REDUCTION    1057 5473.649434 5473.645818
#&gt; LO-REDUCTION    1059 5473.649174 5473.645818
#&gt; EXTENSION       1061 5473.648600 5473.645063
#&gt; LO-REDUCTION    1063 5473.648418 5473.645063
#&gt; LO-REDUCTION    1065 5473.647920 5473.645063
#&gt; EXTENSION       1067 5473.647393 5473.644423
#&gt; REFLECTION      1069 5473.646232 5473.644117
#&gt; EXTENSION       1071 5473.645829 5473.642346
#&gt; LO-REDUCTION    1073 5473.645818 5473.642346
#&gt; LO-REDUCTION    1075 5473.645783 5473.642346
#&gt; LO-REDUCTION    1077 5473.645063 5473.642346
#&gt; LO-REDUCTION    1079 5473.644476 5473.642346
#&gt; LO-REDUCTION    1081 5473.644423 5473.642346
#&gt; LO-REDUCTION    1083 5473.644117 5473.642346
#&gt; EXTENSION       1085 5473.643666 5473.641529
#&gt; LO-REDUCTION    1087 5473.643594 5473.641529
#&gt; EXTENSION       1089 5473.643409 5473.640948
#&gt; EXTENSION       1091 5473.642464 5473.639343
#&gt; LO-REDUCTION    1093 5473.642353 5473.639343
#&gt; LO-REDUCTION    1095 5473.642346 5473.639343
#&gt; LO-REDUCTION    1097 5473.641742 5473.639343
#&gt; LO-REDUCTION    1099 5473.641529 5473.639343
#&gt; LO-REDUCTION    1101 5473.640948 5473.639343
#&gt; EXTENSION       1103 5473.640699 5473.638491
#&gt; LO-REDUCTION    1105 5473.640625 5473.638491
#&gt; LO-REDUCTION    1107 5473.640343 5473.638491
#&gt; EXTENSION       1109 5473.640018 5473.637300
#&gt; LO-REDUCTION    1111 5473.639532 5473.637300
#&gt; EXTENSION       1113 5473.639343 5473.636054
#&gt; LO-REDUCTION    1115 5473.638917 5473.636054
#&gt; EXTENSION       1117 5473.638684 5473.634795
#&gt; LO-REDUCTION    1119 5473.638491 5473.634795
#&gt; EXTENSION       1121 5473.637486 5473.632479
#&gt; LO-REDUCTION    1123 5473.637300 5473.632479
#&gt; LO-REDUCTION    1125 5473.637044 5473.632479
#&gt; LO-REDUCTION    1127 5473.636054 5473.632479
#&gt; LO-REDUCTION    1129 5473.635970 5473.632479
#&gt; EXTENSION       1131 5473.635278 5473.630777
#&gt; LO-REDUCTION    1133 5473.634795 5473.630777
#&gt; LO-REDUCTION    1135 5473.633996 5473.630777
#&gt; LO-REDUCTION    1137 5473.633809 5473.630777
#&gt; EXTENSION       1139 5473.633642 5473.630022
#&gt; EXTENSION       1141 5473.632479 5473.627710
#&gt; LO-REDUCTION    1143 5473.631971 5473.627710
#&gt; LO-REDUCTION    1145 5473.631421 5473.627710
#&gt; LO-REDUCTION    1147 5473.631114 5473.627710
#&gt; LO-REDUCTION    1149 5473.630777 5473.627710
#&gt; LO-REDUCTION    1151 5473.630022 5473.627710
#&gt; EXTENSION       1153 5473.629770 5473.627069
#&gt; REFLECTION      1155 5473.628695 5473.626950
#&gt; EXTENSION       1157 5473.628427 5473.625660
#&gt; LO-REDUCTION    1159 5473.628409 5473.625660
#&gt; LO-REDUCTION    1161 5473.628405 5473.625660
#&gt; LO-REDUCTION    1163 5473.627710 5473.625660
#&gt; LO-REDUCTION    1165 5473.627069 5473.625660
#&gt; EXTENSION       1167 5473.626950 5473.624310
#&gt; LO-REDUCTION    1169 5473.626321 5473.624310
#&gt; LO-REDUCTION    1171 5473.626246 5473.624310
#&gt; EXTENSION       1173 5473.625997 5473.623529
#&gt; EXTENSION       1175 5473.625733 5473.622930
#&gt; LO-REDUCTION    1177 5473.625660 5473.622930
#&gt; EXTENSION       1179 5473.625045 5473.622201
#&gt; LO-REDUCTION    1181 5473.624561 5473.622201
#&gt; LO-REDUCTION    1183 5473.624310 5473.622201
#&gt; REFLECTION      1185 5473.623529 5473.621762
#&gt; REFLECTION      1187 5473.623014 5473.621528
#&gt; LO-REDUCTION    1189 5473.622930 5473.621528
#&gt; LO-REDUCTION    1191 5473.622532 5473.621528
#&gt; REFLECTION      1193 5473.622348 5473.621425
#&gt; HI-REDUCTION    1195 5473.622201 5473.621425
#&gt; LO-REDUCTION    1197 5473.621998 5473.621425
#&gt; EXTENSION       1199 5473.621880 5473.621230
#&gt; EXTENSION       1201 5473.621762 5473.620713
#&gt; LO-REDUCTION    1203 5473.621751 5473.620713
#&gt; LO-REDUCTION    1205 5473.621668 5473.620713
#&gt; EXTENSION       1207 5473.621528 5473.620091
#&gt; EXTENSION       1209 5473.621425 5473.619820
#&gt; EXTENSION       1211 5473.621230 5473.619316
#&gt; EXTENSION       1213 5473.620942 5473.617808
#&gt; LO-REDUCTION    1215 5473.620723 5473.617808
#&gt; LO-REDUCTION    1217 5473.620713 5473.617808
#&gt; LO-REDUCTION    1219 5473.620091 5473.617808
#&gt; REFLECTION      1221 5473.619820 5473.617142
#&gt; EXTENSION       1223 5473.619316 5473.615355
#&gt; LO-REDUCTION    1225 5473.618518 5473.615355
#&gt; EXTENSION       1227 5473.617927 5473.613045
#&gt; LO-REDUCTION    1229 5473.617866 5473.613045
#&gt; LO-REDUCTION    1231 5473.617808 5473.613045
#&gt; REFLECTION      1233 5473.617142 5473.612819
#&gt; REFLECTION      1235 5473.615644 5473.611839
#&gt; EXTENSION       1237 5473.615355 5473.610451
#&gt; EXTENSION       1239 5473.613748 5473.607589
#&gt; LO-REDUCTION    1241 5473.613269 5473.607589
#&gt; LO-REDUCTION    1243 5473.613045 5473.607589
#&gt; REFLECTION      1245 5473.612819 5473.607551
#&gt; REFLECTION      1247 5473.611839 5473.606228
#&gt; REFLECTION      1249 5473.610451 5473.605590
#&gt; LO-REDUCTION    1251 5473.608998 5473.605590
#&gt; EXTENSION       1253 5473.608697 5473.602137
#&gt; LO-REDUCTION    1255 5473.607589 5473.602137
#&gt; LO-REDUCTION    1257 5473.607551 5473.602137
#&gt; LO-REDUCTION    1259 5473.606329 5473.602137
#&gt; EXTENSION       1261 5473.606228 5473.600110
#&gt; EXTENSION       1263 5473.605590 5473.598798
#&gt; LO-REDUCTION    1265 5473.604391 5473.598798
#&gt; EXTENSION       1267 5473.604117 5473.593965
#&gt; LO-REDUCTION    1269 5473.603475 5473.593965
#&gt; EXTENSION       1271 5473.602137 5473.589459
#&gt; LO-REDUCTION    1273 5473.600110 5473.589459
#&gt; LO-REDUCTION    1275 5473.599370 5473.589459
#&gt; LO-REDUCTION    1277 5473.598798 5473.589459
#&gt; EXTENSION       1279 5473.596946 5473.587567
#&gt; EXTENSION       1281 5473.593965 5473.583164
#&gt; LO-REDUCTION    1283 5473.593347 5473.583164
#&gt; REFLECTION      1285 5473.591511 5473.583003
#&gt; REFLECTION      1287 5473.591399 5473.582154
#&gt; LO-REDUCTION    1289 5473.589459 5473.582126
#&gt; LO-REDUCTION    1291 5473.587567 5473.581705
#&gt; LO-REDUCTION    1293 5473.586076 5473.581705
#&gt; EXTENSION       1295 5473.583424 5473.579003
#&gt; LO-REDUCTION    1297 5473.583164 5473.579003
#&gt; LO-REDUCTION    1299 5473.583003 5473.579003
#&gt; LO-REDUCTION    1301 5473.582154 5473.579003
#&gt; LO-REDUCTION    1303 5473.582126 5473.579003
#&gt; REFLECTION      1305 5473.581705 5473.578617
#&gt; REFLECTION      1307 5473.580903 5473.578443
#&gt; EXTENSION       1309 5473.579615 5473.576509
#&gt; HI-REDUCTION    1311 5473.579562 5473.576509
#&gt; LO-REDUCTION    1313 5473.579398 5473.576509
#&gt; LO-REDUCTION    1315 5473.579003 5473.576509
#&gt; LO-REDUCTION    1317 5473.578617 5473.576509
#&gt; REFLECTION      1319 5473.578443 5473.576204
#&gt; REFLECTION      1321 5473.578177 5473.575777
#&gt; LO-REDUCTION    1323 5473.577591 5473.575777
#&gt; EXTENSION       1325 5473.577320 5473.573721
#&gt; LO-REDUCTION    1327 5473.576666 5473.573721
#&gt; HI-REDUCTION    1329 5473.576560 5473.573721
#&gt; LO-REDUCTION    1331 5473.576509 5473.573721
#&gt; EXTENSION       1333 5473.576204 5473.572967
#&gt; EXTENSION       1335 5473.575777 5473.572668
#&gt; REFLECTION      1337 5473.575532 5473.572581
#&gt; EXTENSION       1339 5473.574238 5473.570209
#&gt; LO-REDUCTION    1341 5473.574227 5473.570209
#&gt; LO-REDUCTION    1343 5473.573721 5473.570209
#&gt; LO-REDUCTION    1345 5473.572967 5473.570209
#&gt; LO-REDUCTION    1347 5473.572668 5473.570209
#&gt; LO-REDUCTION    1349 5473.572581 5473.570209
#&gt; REFLECTION      1351 5473.571421 5473.569931
#&gt; REFLECTION      1353 5473.570896 5473.569697
#&gt; LO-REDUCTION    1355 5473.570809 5473.569697
#&gt; EXTENSION       1357 5473.570703 5473.569358
#&gt; REFLECTION      1359 5473.570678 5473.569285
#&gt; LO-REDUCTION    1361 5473.570209 5473.569285
#&gt; EXTENSION       1363 5473.569961 5473.568420
#&gt; EXTENSION       1365 5473.569931 5473.567670
#&gt; LO-REDUCTION    1367 5473.569697 5473.567670
#&gt; LO-REDUCTION    1369 5473.569449 5473.567670
#&gt; EXTENSION       1371 5473.569358 5473.566885
#&gt; LO-REDUCTION    1373 5473.569285 5473.566885
#&gt; LO-REDUCTION    1375 5473.568623 5473.566885
#&gt; EXTENSION       1377 5473.568420 5473.566710
#&gt; REFLECTION      1379 5473.568199 5473.566284
#&gt; EXTENSION       1381 5473.567670 5473.565823
#&gt; LO-REDUCTION    1383 5473.567618 5473.565823
#&gt; LO-REDUCTION    1385 5473.567186 5473.565823
#&gt; EXTENSION       1387 5473.566885 5473.564506
#&gt; LO-REDUCTION    1389 5473.566710 5473.564506
#&gt; LO-REDUCTION    1391 5473.566284 5473.564506
#&gt; HI-REDUCTION    1393 5473.566110 5473.564506
#&gt; EXTENSION       1395 5473.565834 5473.563758
#&gt; LO-REDUCTION    1397 5473.565823 5473.563758
#&gt; LO-REDUCTION    1399 5473.565733 5473.563758
#&gt; EXTENSION       1401 5473.565520 5473.562943
#&gt; LO-REDUCTION    1403 5473.565124 5473.562943
#&gt; EXTENSION       1405 5473.564737 5473.562830
#&gt; EXTENSION       1407 5473.564506 5473.560759
#&gt; LO-REDUCTION    1409 5473.564236 5473.560759
#&gt; LO-REDUCTION    1411 5473.563758 5473.560759
#&gt; LO-REDUCTION    1413 5473.563441 5473.560759
#&gt; EXTENSION       1415 5473.562943 5473.559220
#&gt; LO-REDUCTION    1417 5473.562830 5473.559220
#&gt; LO-REDUCTION    1419 5473.561461 5473.559220
#&gt; LO-REDUCTION    1421 5473.561206 5473.559220
#&gt; LO-REDUCTION    1423 5473.560959 5473.559220
#&gt; EXTENSION       1425 5473.560759 5473.558431
#&gt; LO-REDUCTION    1427 5473.560642 5473.558431
#&gt; LO-REDUCTION    1429 5473.559684 5473.558431
#&gt; LO-REDUCTION    1431 5473.559523 5473.558431
#&gt; LO-REDUCTION    1433 5473.559511 5473.558431
#&gt; LO-REDUCTION    1435 5473.559220 5473.558431
#&gt; LO-REDUCTION    1437 5473.559089 5473.558431
#&gt; LO-REDUCTION    1439 5473.558863 5473.558431
#&gt; EXTENSION       1441 5473.558713 5473.558334
#&gt; REFLECTION      1443 5473.558707 5473.558311
#&gt; REFLECTION      1445 5473.558701 5473.558220
#&gt; HI-REDUCTION    1447 5473.558546 5473.558220
#&gt; REFLECTION      1449 5473.558511 5473.558187
#&gt; LO-REDUCTION    1451 5473.558431 5473.558187
#&gt; EXTENSION       1453 5473.558408 5473.558073
#&gt; LO-REDUCTION    1455 5473.558334 5473.558073
#&gt; EXTENSION       1457 5473.558311 5473.557850
#&gt; LO-REDUCTION    1459 5473.558220 5473.557850
#&gt; LO-REDUCTION    1461 5473.558211 5473.557850
#&gt; EXTENSION       1463 5473.558199 5473.557637
#&gt; LO-REDUCTION    1465 5473.558187 5473.557637
#&gt; LO-REDUCTION    1467 5473.558073 5473.557637
#&gt; REFLECTION      1469 5473.557980 5473.557613
#&gt; LO-REDUCTION    1471 5473.557945 5473.557613
#&gt; EXTENSION       1473 5473.557850 5473.557266
#&gt; LO-REDUCTION    1475 5473.557684 5473.557266
#&gt; LO-REDUCTION    1477 5473.557681 5473.557266
#&gt; LO-REDUCTION    1479 5473.557637 5473.557266
#&gt; LO-REDUCTION    1481 5473.557626 5473.557266
#&gt; EXTENSION       1483 5473.557613 5473.556750
#&gt; LO-REDUCTION    1485 5473.557416 5473.556750
#&gt; LO-REDUCTION    1487 5473.557310 5473.556750
#&gt; LO-REDUCTION    1489 5473.557276 5473.556750
#&gt; LO-REDUCTION    1491 5473.557267 5473.556750
#&gt; LO-REDUCTION    1493 5473.557266 5473.556750
#&gt; EXTENSION       1495 5473.557066 5473.556555
#&gt; LO-REDUCTION    1497 5473.557021 5473.556555
#&gt; EXTENSION       1499 5473.556988 5473.556335
#&gt; LO-REDUCTION    1501 5473.556987 5473.556335
#&gt; EXTENSION       1503 5473.556814 5473.556201
#&gt; LO-REDUCTION    1505 5473.556750 5473.556201
#&gt; LO-REDUCTION    1507 5473.556698 5473.556201
#&gt; LO-REDUCTION    1509 5473.556555 5473.556201
#&gt; REFLECTION      1511 5473.556446 5473.556141
#&gt; LO-REDUCTION    1513 5473.556335 5473.556141
#&gt; LO-REDUCTION    1515 5473.556326 5473.556141
#&gt; LO-REDUCTION    1517 5473.556300 5473.556141
#&gt; LO-REDUCTION    1519 5473.556297 5473.556141
#&gt; LO-REDUCTION    1521 5473.556240 5473.556141
#&gt; EXTENSION       1523 5473.556202 5473.556107
#&gt; EXTENSION       1525 5473.556201 5473.556074
#&gt; LO-REDUCTION    1527 5473.556191 5473.556074
#&gt; LO-REDUCTION    1529 5473.556184 5473.556074
#&gt; Exiting from Nelder Mead minimizer
#&gt;     1531 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9820258   1.5018619  -2.9909460  -0.9655340  -0.6019056   0.3033625 
#&gt; 
#&gt; $value
#&gt; [1] 5473.556
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;     1531 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      1.12 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=================================================                     |  70%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6035.692101
#&gt;   Scaled convergence tolerance is 8.99388e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11543.933259 5686.523727
#&gt; LO-REDUCTION       9 7722.060455 5686.523727
#&gt; LO-REDUCTION      11 7629.239634 5686.523727
#&gt; REFLECTION        13 6879.133853 5666.186544
#&gt; LO-REDUCTION      15 6611.967243 5666.186544
#&gt; LO-REDUCTION      17 6305.240645 5666.186544
#&gt; REFLECTION        19 6252.715980 5633.958388
#&gt; REFLECTION        21 6035.692101 5447.811016
#&gt; LO-REDUCTION      23 5826.056382 5447.811016
#&gt; LO-REDUCTION      25 5811.562502 5447.811016
#&gt; LO-REDUCTION      27 5686.523727 5447.811016
#&gt; HI-REDUCTION      29 5666.186544 5447.811016
#&gt; LO-REDUCTION      31 5633.958388 5447.811016
#&gt; LO-REDUCTION      33 5545.569937 5447.811016
#&gt; LO-REDUCTION      35 5528.283994 5447.811016
#&gt; LO-REDUCTION      37 5490.460003 5447.811016
#&gt; HI-REDUCTION      39 5486.966756 5447.811016
#&gt; HI-REDUCTION      41 5466.582700 5447.811016
#&gt; LO-REDUCTION      43 5462.834065 5447.811016
#&gt; LO-REDUCTION      45 5462.146987 5447.811016
#&gt; LO-REDUCTION      47 5460.742842 5447.811016
#&gt; LO-REDUCTION      49 5458.728836 5447.811016
#&gt; LO-REDUCTION      51 5457.260359 5446.681961
#&gt; HI-REDUCTION      53 5450.725858 5446.681961
#&gt; HI-REDUCTION      55 5449.696555 5446.681961
#&gt; REFLECTION        57 5449.559883 5446.454925
#&gt; EXTENSION         59 5449.080460 5442.624885
#&gt; LO-REDUCTION      61 5449.077380 5442.624885
#&gt; HI-REDUCTION      63 5447.811016 5442.624885
#&gt; LO-REDUCTION      65 5447.547628 5442.624885
#&gt; REFLECTION        67 5446.681961 5442.120976
#&gt; LO-REDUCTION      69 5446.454925 5442.120976
#&gt; LO-REDUCTION      71 5445.500006 5442.120976
#&gt; REFLECTION        73 5444.696760 5441.215207
#&gt; LO-REDUCTION      75 5444.138936 5441.215207
#&gt; LO-REDUCTION      77 5443.874455 5441.215207
#&gt; LO-REDUCTION      79 5442.624885 5441.136121
#&gt; LO-REDUCTION      81 5442.338181 5441.136121
#&gt; REFLECTION        83 5442.120976 5441.056645
#&gt; LO-REDUCTION      85 5441.787975 5441.056645
#&gt; REFLECTION        87 5441.313242 5440.902060
#&gt; REFLECTION        89 5441.215207 5440.860674
#&gt; REFLECTION        91 5441.168606 5440.631941
#&gt; HI-REDUCTION      93 5441.155332 5440.631941
#&gt; LO-REDUCTION      95 5441.136121 5440.631941
#&gt; LO-REDUCTION      97 5441.056645 5440.631941
#&gt; LO-REDUCTION      99 5440.902060 5440.631941
#&gt; HI-REDUCTION     101 5440.860674 5440.631941
#&gt; HI-REDUCTION     103 5440.805864 5440.631941
#&gt; LO-REDUCTION     105 5440.798816 5440.631941
#&gt; EXTENSION        107 5440.733532 5440.444745
#&gt; LO-REDUCTION     109 5440.708565 5440.444745
#&gt; LO-REDUCTION     111 5440.691792 5440.444745
#&gt; LO-REDUCTION     113 5440.684854 5440.444745
#&gt; LO-REDUCTION     115 5440.646093 5440.444745
#&gt; REFLECTION       117 5440.631941 5440.432013
#&gt; REFLECTION       119 5440.596206 5440.371475
#&gt; EXTENSION        121 5440.511242 5440.186573
#&gt; LO-REDUCTION     123 5440.497589 5440.186573
#&gt; LO-REDUCTION     125 5440.467448 5440.186573
#&gt; LO-REDUCTION     127 5440.444745 5440.186573
#&gt; LO-REDUCTION     129 5440.432013 5440.186573
#&gt; LO-REDUCTION     131 5440.371475 5440.186573
#&gt; LO-REDUCTION     133 5440.343528 5440.186573
#&gt; REFLECTION       135 5440.328902 5440.174723
#&gt; EXTENSION        137 5440.302104 5440.070389
#&gt; LO-REDUCTION     139 5440.240178 5440.070389
#&gt; LO-REDUCTION     141 5440.227571 5440.070389
#&gt; EXTENSION        143 5440.191888 5439.862112
#&gt; LO-REDUCTION     145 5440.186573 5439.862112
#&gt; LO-REDUCTION     147 5440.174723 5439.862112
#&gt; LO-REDUCTION     149 5440.077210 5439.862112
#&gt; LO-REDUCTION     151 5440.071268 5439.862112
#&gt; LO-REDUCTION     153 5440.070389 5439.862112
#&gt; EXTENSION        155 5440.058333 5439.734219
#&gt; LO-REDUCTION     157 5439.953412 5439.734219
#&gt; LO-REDUCTION     159 5439.952928 5439.734219
#&gt; EXTENSION        161 5439.950028 5439.654442
#&gt; EXTENSION        163 5439.929160 5439.453115
#&gt; LO-REDUCTION     165 5439.862112 5439.453115
#&gt; LO-REDUCTION     167 5439.786925 5439.453115
#&gt; EXTENSION        169 5439.777783 5439.308091
#&gt; EXTENSION        171 5439.734219 5439.068739
#&gt; LO-REDUCTION     173 5439.654442 5439.068739
#&gt; LO-REDUCTION     175 5439.594490 5439.068739
#&gt; EXTENSION        177 5439.486861 5438.625420
#&gt; LO-REDUCTION     179 5439.453115 5438.625420
#&gt; LO-REDUCTION     181 5439.308091 5438.625420
#&gt; EXTENSION        183 5439.126824 5438.300908
#&gt; LO-REDUCTION     185 5439.125092 5438.300908
#&gt; EXTENSION        187 5439.068739 5438.186461
#&gt; EXTENSION        189 5438.829285 5437.875896
#&gt; EXTENSION        191 5438.625579 5437.587762
#&gt; LO-REDUCTION     193 5438.625420 5437.587762
#&gt; LO-REDUCTION     195 5438.334924 5437.587762
#&gt; HI-REDUCTION     197 5438.300908 5437.587762
#&gt; LO-REDUCTION     199 5438.186461 5437.587762
#&gt; EXTENSION        201 5437.904653 5437.090953
#&gt; LO-REDUCTION     203 5437.875896 5437.090953
#&gt; LO-REDUCTION     205 5437.693939 5437.090953
#&gt; LO-REDUCTION     207 5437.691440 5437.090953
#&gt; LO-REDUCTION     209 5437.682623 5437.090953
#&gt; LO-REDUCTION     211 5437.587762 5437.090953
#&gt; LO-REDUCTION     213 5437.569661 5437.090953
#&gt; LO-REDUCTION     215 5437.430941 5437.090953
#&gt; LO-REDUCTION     217 5437.325154 5437.090953
#&gt; EXTENSION        219 5437.315528 5437.020471
#&gt; LO-REDUCTION     221 5437.276601 5437.020471
#&gt; REFLECTION       223 5437.212658 5436.985765
#&gt; EXTENSION        225 5437.122071 5436.833672
#&gt; EXTENSION        227 5437.103479 5436.743071
#&gt; LO-REDUCTION     229 5437.090953 5436.743071
#&gt; LO-REDUCTION     231 5437.062170 5436.743071
#&gt; EXTENSION        233 5437.020471 5436.699940
#&gt; LO-REDUCTION     235 5436.985765 5436.699940
#&gt; REFLECTION       237 5436.883556 5436.689210
#&gt; REFLECTION       239 5436.840950 5436.599740
#&gt; LO-REDUCTION     241 5436.833672 5436.599740
#&gt; LO-REDUCTION     243 5436.743071 5436.599740
#&gt; HI-REDUCTION     245 5436.741166 5436.599740
#&gt; LO-REDUCTION     247 5436.699940 5436.599740
#&gt; HI-REDUCTION     249 5436.689210 5436.599740
#&gt; EXTENSION        251 5436.658601 5436.521436
#&gt; LO-REDUCTION     253 5436.635450 5436.521436
#&gt; LO-REDUCTION     255 5436.634445 5436.521436
#&gt; EXTENSION        257 5436.630317 5436.469781
#&gt; EXTENSION        259 5436.607206 5436.445039
#&gt; LO-REDUCTION     261 5436.599740 5436.445039
#&gt; REFLECTION       263 5436.571958 5436.427419
#&gt; EXTENSION        265 5436.556607 5436.394169
#&gt; LO-REDUCTION     267 5436.521436 5436.394169
#&gt; REFLECTION       269 5436.484855 5436.362095
#&gt; EXTENSION        271 5436.469781 5436.255491
#&gt; LO-REDUCTION     273 5436.445039 5436.255491
#&gt; LO-REDUCTION     275 5436.427419 5436.255491
#&gt; LO-REDUCTION     277 5436.416569 5436.255491
#&gt; LO-REDUCTION     279 5436.394169 5436.255491
#&gt; EXTENSION        281 5436.362095 5436.228805
#&gt; LO-REDUCTION     283 5436.356270 5436.228805
#&gt; LO-REDUCTION     285 5436.355760 5436.228805
#&gt; EXTENSION        287 5436.318913 5436.177542
#&gt; REFLECTION       289 5436.276606 5436.163702
#&gt; LO-REDUCTION     291 5436.269041 5436.163702
#&gt; LO-REDUCTION     293 5436.255491 5436.163702
#&gt; LO-REDUCTION     295 5436.231145 5436.163702
#&gt; REFLECTION       297 5436.228805 5436.161571
#&gt; REFLECTION       299 5436.177542 5436.145499
#&gt; HI-REDUCTION     301 5436.177370 5436.145499
#&gt; REFLECTION       303 5436.177262 5436.144737
#&gt; EXTENSION        305 5436.167619 5436.102846
#&gt; LO-REDUCTION     307 5436.163702 5436.102846
#&gt; HI-REDUCTION     309 5436.161571 5436.102846
#&gt; LO-REDUCTION     311 5436.155063 5436.102846
#&gt; EXTENSION        313 5436.145499 5436.085295
#&gt; LO-REDUCTION     315 5436.144737 5436.085295
#&gt; EXTENSION        317 5436.134947 5436.054448
#&gt; LO-REDUCTION     319 5436.124845 5436.054448
#&gt; EXTENSION        321 5436.122563 5436.013435
#&gt; LO-REDUCTION     323 5436.102846 5436.013435
#&gt; EXTENSION        325 5436.101420 5435.989134
#&gt; EXTENSION        327 5436.085295 5435.972441
#&gt; LO-REDUCTION     329 5436.071269 5435.972441
#&gt; EXTENSION        331 5436.054448 5435.940164
#&gt; LO-REDUCTION     333 5436.048903 5435.940164
#&gt; EXTENSION        335 5436.013435 5435.874632
#&gt; LO-REDUCTION     337 5435.998299 5435.874632
#&gt; LO-REDUCTION     339 5435.989134 5435.874632
#&gt; LO-REDUCTION     341 5435.972441 5435.874632
#&gt; LO-REDUCTION     343 5435.950385 5435.874632
#&gt; LO-REDUCTION     345 5435.940164 5435.874632
#&gt; HI-REDUCTION     347 5435.905429 5435.874632
#&gt; LO-REDUCTION     349 5435.902813 5435.874632
#&gt; REFLECTION       351 5435.901820 5435.870867
#&gt; EXTENSION        353 5435.897837 5435.849230
#&gt; LO-REDUCTION     355 5435.885234 5435.849230
#&gt; LO-REDUCTION     357 5435.878697 5435.849230
#&gt; LO-REDUCTION     359 5435.876775 5435.849230
#&gt; EXTENSION        361 5435.874632 5435.828476
#&gt; EXTENSION        363 5435.870867 5435.792264
#&gt; LO-REDUCTION     365 5435.857494 5435.792264
#&gt; LO-REDUCTION     367 5435.853132 5435.792264
#&gt; LO-REDUCTION     369 5435.851582 5435.792264
#&gt; LO-REDUCTION     371 5435.849230 5435.792264
#&gt; EXTENSION        373 5435.828990 5435.772393
#&gt; LO-REDUCTION     375 5435.828476 5435.772393
#&gt; EXTENSION        377 5435.821604 5435.746858
#&gt; LO-REDUCTION     379 5435.813288 5435.746858
#&gt; EXTENSION        381 5435.808137 5435.737821
#&gt; LO-REDUCTION     383 5435.792264 5435.737821
#&gt; LO-REDUCTION     385 5435.774418 5435.737821
#&gt; LO-REDUCTION     387 5435.772393 5435.737821
#&gt; LO-REDUCTION     389 5435.752254 5435.736184
#&gt; LO-REDUCTION     391 5435.746858 5435.736184
#&gt; LO-REDUCTION     393 5435.745673 5435.736184
#&gt; LO-REDUCTION     395 5435.740298 5435.735742
#&gt; LO-REDUCTION     397 5435.739024 5435.735101
#&gt; HI-REDUCTION     399 5435.738644 5435.734571
#&gt; REFLECTION       401 5435.737821 5435.733375
#&gt; LO-REDUCTION     403 5435.736369 5435.733375
#&gt; LO-REDUCTION     405 5435.736184 5435.733375
#&gt; LO-REDUCTION     407 5435.735742 5435.733375
#&gt; REFLECTION       409 5435.735101 5435.732774
#&gt; LO-REDUCTION     411 5435.734571 5435.732774
#&gt; LO-REDUCTION     413 5435.734421 5435.732774
#&gt; REFLECTION       415 5435.734066 5435.732355
#&gt; LO-REDUCTION     417 5435.733883 5435.732355
#&gt; LO-REDUCTION     419 5435.733441 5435.732355
#&gt; LO-REDUCTION     421 5435.733375 5435.732355
#&gt; LO-REDUCTION     423 5435.733323 5435.732355
#&gt; REFLECTION       425 5435.732774 5435.732121
#&gt; LO-REDUCTION     427 5435.732657 5435.732121
#&gt; LO-REDUCTION     429 5435.732616 5435.732121
#&gt; REFLECTION       431 5435.732587 5435.732005
#&gt; LO-REDUCTION     433 5435.732358 5435.732005
#&gt; LO-REDUCTION     435 5435.732355 5435.732005
#&gt; REFLECTION       437 5435.732238 5435.731933
#&gt; LO-REDUCTION     439 5435.732180 5435.731933
#&gt; REFLECTION       441 5435.732150 5435.731913
#&gt; LO-REDUCTION     443 5435.732121 5435.731913
#&gt; REFLECTION       445 5435.732042 5435.731904
#&gt; LO-REDUCTION     447 5435.732036 5435.731896
#&gt; REFLECTION       449 5435.732005 5435.731876
#&gt; Exiting from Nelder Mead minimizer
#&gt;     451 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9909872   1.5033299  -3.0022290  -0.9581241  -0.7041930   0.2827446 
#&gt; 
#&gt; $value
#&gt; [1] 5435.732
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      451 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] FALSE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.31 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |========================================================              |  80%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6098.548964
#&gt;   Scaled convergence tolerance is 9.08755e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11609.839213 5702.666439
#&gt; LO-REDUCTION       9 7799.196804 5702.666439
#&gt; LO-REDUCTION      11 7394.248633 5702.666439
#&gt; LO-REDUCTION      13 6838.410842 5702.666439
#&gt; LO-REDUCTION      15 6554.589139 5702.666439
#&gt; LO-REDUCTION      17 6403.282858 5702.666439
#&gt; REFLECTION        19 6299.261090 5693.456564
#&gt; REFLECTION        21 6098.548964 5535.752783
#&gt; LO-REDUCTION      23 5954.475831 5535.752783
#&gt; LO-REDUCTION      25 5939.376849 5535.752783
#&gt; LO-REDUCTION      27 5758.936747 5535.752783
#&gt; LO-REDUCTION      29 5702.666439 5535.752783
#&gt; LO-REDUCTION      31 5693.456564 5535.752783
#&gt; LO-REDUCTION      33 5583.285504 5535.752783
#&gt; LO-REDUCTION      35 5576.718099 5526.618851
#&gt; LO-REDUCTION      37 5563.466021 5526.618851
#&gt; HI-REDUCTION      39 5563.176315 5526.618851
#&gt; HI-REDUCTION      41 5536.736572 5526.618851
#&gt; LO-REDUCTION      43 5536.348237 5526.618851
#&gt; REFLECTION        45 5535.801033 5524.086362
#&gt; LO-REDUCTION      47 5535.752783 5524.086362
#&gt; HI-REDUCTION      49 5532.376258 5524.086362
#&gt; REFLECTION        51 5530.667579 5522.083444
#&gt; HI-REDUCTION      53 5526.626024 5522.083444
#&gt; REFLECTION        55 5526.618851 5519.020526
#&gt; HI-REDUCTION      57 5524.744124 5519.020526
#&gt; LO-REDUCTION      59 5524.160602 5519.020526
#&gt; LO-REDUCTION      61 5524.086362 5519.020526
#&gt; HI-REDUCTION      63 5523.579052 5519.020526
#&gt; EXTENSION         65 5522.083444 5516.954950
#&gt; LO-REDUCTION      67 5521.408007 5516.954950
#&gt; LO-REDUCTION      69 5520.779767 5516.954950
#&gt; LO-REDUCTION      71 5520.738263 5516.954950
#&gt; REFLECTION        73 5520.683315 5516.308940
#&gt; LO-REDUCTION      75 5519.020526 5516.176256
#&gt; LO-REDUCTION      77 5518.324429 5516.176256
#&gt; LO-REDUCTION      79 5518.322430 5516.176256
#&gt; LO-REDUCTION      81 5517.574700 5516.176256
#&gt; LO-REDUCTION      83 5516.954950 5516.176256
#&gt; LO-REDUCTION      85 5516.702555 5516.105346
#&gt; HI-REDUCTION      87 5516.521884 5516.105346
#&gt; LO-REDUCTION      89 5516.483605 5516.047049
#&gt; REFLECTION        91 5516.308940 5515.957992
#&gt; REFLECTION        93 5516.237318 5515.932740
#&gt; REFLECTION        95 5516.176434 5515.886833
#&gt; HI-REDUCTION      97 5516.176256 5515.886833
#&gt; REFLECTION        99 5516.105346 5515.789457
#&gt; REFLECTION       101 5516.047049 5515.788084
#&gt; REFLECTION       103 5515.957992 5515.639523
#&gt; HI-REDUCTION     105 5515.932740 5515.639523
#&gt; LO-REDUCTION     107 5515.926257 5515.639523
#&gt; EXTENSION        109 5515.886833 5515.366871
#&gt; LO-REDUCTION     111 5515.789457 5515.366871
#&gt; LO-REDUCTION     113 5515.788084 5515.366871
#&gt; LO-REDUCTION     115 5515.759473 5515.366871
#&gt; EXTENSION        117 5515.684029 5515.249083
#&gt; LO-REDUCTION     119 5515.639523 5515.249083
#&gt; LO-REDUCTION     121 5515.592469 5515.249083
#&gt; LO-REDUCTION     123 5515.588479 5515.249083
#&gt; REFLECTION       125 5515.570618 5515.194950
#&gt; EXTENSION        127 5515.374589 5514.923099
#&gt; LO-REDUCTION     129 5515.366871 5514.923099
#&gt; LO-REDUCTION     131 5515.318771 5514.923099
#&gt; EXTENSION        133 5515.249554 5514.724800
#&gt; LO-REDUCTION     135 5515.249083 5514.724800
#&gt; LO-REDUCTION     137 5515.194950 5514.724800
#&gt; LO-REDUCTION     139 5515.072329 5514.724800
#&gt; LO-REDUCTION     141 5515.014531 5514.724800
#&gt; EXTENSION        143 5514.923099 5514.551990
#&gt; LO-REDUCTION     145 5514.907363 5514.551990
#&gt; LO-REDUCTION     147 5514.832896 5514.551990
#&gt; EXTENSION        149 5514.803246 5514.519972
#&gt; EXTENSION        151 5514.787943 5514.453092
#&gt; EXTENSION        153 5514.724800 5514.327556
#&gt; LO-REDUCTION     155 5514.670277 5514.327556
#&gt; LO-REDUCTION     157 5514.616384 5514.327556
#&gt; REFLECTION       159 5514.551990 5514.285347
#&gt; LO-REDUCTION     161 5514.519972 5514.285347
#&gt; LO-REDUCTION     163 5514.453092 5514.285347
#&gt; HI-REDUCTION     165 5514.446196 5514.285347
#&gt; REFLECTION       167 5514.384799 5514.261380
#&gt; LO-REDUCTION     169 5514.362087 5514.261380
#&gt; LO-REDUCTION     171 5514.359481 5514.261380
#&gt; LO-REDUCTION     173 5514.354066 5514.261380
#&gt; EXTENSION        175 5514.327556 5514.190685
#&gt; LO-REDUCTION     177 5514.320565 5514.190685
#&gt; LO-REDUCTION     179 5514.298572 5514.190685
#&gt; EXTENSION        181 5514.285347 5514.146122
#&gt; LO-REDUCTION     183 5514.282948 5514.146122
#&gt; EXTENSION        185 5514.261380 5514.140482
#&gt; EXTENSION        187 5514.257117 5513.989029
#&gt; LO-REDUCTION     189 5514.191549 5513.989029
#&gt; LO-REDUCTION     191 5514.190685 5513.989029
#&gt; LO-REDUCTION     193 5514.180931 5513.989029
#&gt; EXTENSION        195 5514.146122 5513.955732
#&gt; LO-REDUCTION     197 5514.140482 5513.955732
#&gt; EXTENSION        199 5514.084815 5513.773971
#&gt; LO-REDUCTION     201 5514.035565 5513.773971
#&gt; LO-REDUCTION     203 5514.010860 5513.773971
#&gt; LO-REDUCTION     205 5514.000386 5513.773971
#&gt; EXTENSION        207 5513.989029 5513.678437
#&gt; LO-REDUCTION     209 5513.955732 5513.678437
#&gt; REFLECTION       211 5513.818162 5513.623820
#&gt; LO-REDUCTION     213 5513.793527 5513.623820
#&gt; LO-REDUCTION     215 5513.780659 5513.623820
#&gt; LO-REDUCTION     217 5513.773971 5513.623820
#&gt; REFLECTION       219 5513.734953 5513.607110
#&gt; LO-REDUCTION     221 5513.678437 5513.607110
#&gt; REFLECTION       223 5513.657147 5513.605007
#&gt; EXTENSION        225 5513.643014 5513.576555
#&gt; EXTENSION        227 5513.629335 5513.556249
#&gt; REFLECTION       229 5513.628287 5513.553676
#&gt; REFLECTION       231 5513.623820 5513.527167
#&gt; LO-REDUCTION     233 5513.607110 5513.527167
#&gt; HI-REDUCTION     235 5513.605007 5513.527167
#&gt; EXTENSION        237 5513.576555 5513.444741
#&gt; HI-REDUCTION     239 5513.556249 5513.444741
#&gt; LO-REDUCTION     241 5513.555368 5513.444741
#&gt; LO-REDUCTION     243 5513.553676 5513.444741
#&gt; LO-REDUCTION     245 5513.529294 5513.444741
#&gt; EXTENSION        247 5513.527167 5513.420370
#&gt; EXTENSION        249 5513.526751 5513.391728
#&gt; EXTENSION        251 5513.498061 5513.351153
#&gt; LO-REDUCTION     253 5513.477996 5513.351153
#&gt; LO-REDUCTION     255 5513.474426 5513.351153
#&gt; REFLECTION       257 5513.444741 5513.342537
#&gt; LO-REDUCTION     259 5513.420370 5513.342537
#&gt; LO-REDUCTION     261 5513.391728 5513.342537
#&gt; LO-REDUCTION     263 5513.367292 5513.342537
#&gt; LO-REDUCTION     265 5513.366860 5513.342537
#&gt; LO-REDUCTION     267 5513.356903 5513.342537
#&gt; REFLECTION       269 5513.353536 5513.337248
#&gt; HI-REDUCTION     271 5513.351153 5513.337248
#&gt; LO-REDUCTION     273 5513.350969 5513.337248
#&gt; LO-REDUCTION     275 5513.346435 5513.337248
#&gt; LO-REDUCTION     277 5513.345883 5513.337248
#&gt; EXTENSION        279 5513.343540 5513.333238
#&gt; LO-REDUCTION     281 5513.342537 5513.333238
#&gt; LO-REDUCTION     283 5513.340178 5513.333238
#&gt; LO-REDUCTION     285 5513.339974 5513.333238
#&gt; LO-REDUCTION     287 5513.338680 5513.333238
#&gt; LO-REDUCTION     289 5513.337248 5513.333238
#&gt; REFLECTION       291 5513.335883 5513.332967
#&gt; LO-REDUCTION     293 5513.334997 5513.332967
#&gt; HI-REDUCTION     295 5513.334561 5513.332967
#&gt; LO-REDUCTION     297 5513.334220 5513.332967
#&gt; LO-REDUCTION     299 5513.333690 5513.332967
#&gt; HI-REDUCTION     301 5513.333363 5513.332967
#&gt; REFLECTION       303 5513.333336 5513.332678
#&gt; HI-REDUCTION     305 5513.333238 5513.332678
#&gt; HI-REDUCTION     307 5513.333196 5513.332678
#&gt; LO-REDUCTION     309 5513.333036 5513.332678
#&gt; LO-REDUCTION     311 5513.332967 5513.332678
#&gt; LO-REDUCTION     313 5513.332967 5513.332678
#&gt; LO-REDUCTION     315 5513.332890 5513.332678
#&gt; LO-REDUCTION     317 5513.332873 5513.332661
#&gt; LO-REDUCTION     319 5513.332749 5513.332646
#&gt; HI-REDUCTION     321 5513.332744 5513.332646
#&gt; Exiting from Nelder Mead minimizer
#&gt;     323 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9518534   1.5023541  -2.9958123  -0.9496699  -0.5992537   0.3191132 
#&gt; 
#&gt; $value
#&gt; [1] 5513.333
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      323 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.24 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===============================================================       |  90%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6209.489575
#&gt;   Scaled convergence tolerance is 9.25286e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11410.391350 5790.669250
#&gt; LO-REDUCTION       9 7923.826323 5790.669250
#&gt; LO-REDUCTION      11 7899.811449 5790.669250
#&gt; LO-REDUCTION      13 7044.427581 5790.669250
#&gt; LO-REDUCTION      15 6787.549796 5790.669250
#&gt; LO-REDUCTION      17 6452.324100 5790.669250
#&gt; REFLECTION        19 6432.931579 5757.479803
#&gt; REFLECTION        21 6209.489575 5545.501851
#&gt; LO-REDUCTION      23 5934.428959 5545.501851
#&gt; LO-REDUCTION      25 5926.681539 5545.501851
#&gt; LO-REDUCTION      27 5801.005806 5545.501851
#&gt; LO-REDUCTION      29 5790.669250 5545.501851
#&gt; LO-REDUCTION      31 5757.479803 5545.501851
#&gt; LO-REDUCTION      33 5638.733649 5545.501851
#&gt; LO-REDUCTION      35 5621.051253 5545.501851
#&gt; LO-REDUCTION      37 5590.179046 5545.367360
#&gt; HI-REDUCTION      39 5589.870030 5545.367360
#&gt; LO-REDUCTION      41 5557.298779 5545.367360
#&gt; HI-REDUCTION      43 5553.212080 5544.368917
#&gt; REFLECTION        45 5551.762853 5541.517855
#&gt; LO-REDUCTION      47 5545.939521 5540.869280
#&gt; HI-REDUCTION      49 5545.722271 5539.534014
#&gt; REFLECTION        51 5545.501851 5537.861796
#&gt; HI-REDUCTION      53 5545.367360 5537.584623
#&gt; LO-REDUCTION      55 5544.368917 5535.818767
#&gt; HI-REDUCTION      57 5541.517855 5535.818767
#&gt; HI-REDUCTION      59 5540.869280 5535.818767
#&gt; LO-REDUCTION      61 5539.534014 5535.818767
#&gt; LO-REDUCTION      63 5537.968061 5535.430677
#&gt; HI-REDUCTION      65 5537.861796 5535.430677
#&gt; HI-REDUCTION      67 5537.584623 5535.430677
#&gt; LO-REDUCTION      69 5536.366384 5535.228096
#&gt; LO-REDUCTION      71 5536.183386 5535.163868
#&gt; REFLECTION        73 5535.899300 5534.474343
#&gt; REFLECTION        75 5535.818767 5533.954835
#&gt; HI-REDUCTION      77 5535.704556 5533.954835
#&gt; LO-REDUCTION      79 5535.430677 5533.954835
#&gt; LO-REDUCTION      81 5535.228096 5533.954835
#&gt; HI-REDUCTION      83 5535.163868 5533.954835
#&gt; EXTENSION         85 5534.613689 5533.647705
#&gt; EXTENSION         87 5534.513681 5533.314652
#&gt; LO-REDUCTION      89 5534.474343 5533.314652
#&gt; REFLECTION        91 5534.370968 5532.974193
#&gt; LO-REDUCTION      93 5534.280271 5532.974193
#&gt; LO-REDUCTION      95 5533.954835 5532.974193
#&gt; LO-REDUCTION      97 5533.647705 5532.974193
#&gt; LO-REDUCTION      99 5533.404187 5532.974193
#&gt; HI-REDUCTION     101 5533.314652 5532.974193
#&gt; LO-REDUCTION     103 5533.231698 5532.974193
#&gt; EXTENSION        105 5533.127969 5532.617842
#&gt; LO-REDUCTION     107 5533.082308 5532.617842
#&gt; EXTENSION        109 5532.993833 5532.531606
#&gt; LO-REDUCTION     111 5532.990142 5532.531606
#&gt; LO-REDUCTION     113 5532.987399 5532.531606
#&gt; LO-REDUCTION     115 5532.974193 5532.531606
#&gt; REFLECTION       117 5532.738957 5532.348317
#&gt; LO-REDUCTION     119 5532.662777 5532.348317
#&gt; LO-REDUCTION     121 5532.617842 5532.348317
#&gt; LO-REDUCTION     123 5532.612529 5532.348317
#&gt; LO-REDUCTION     125 5532.546641 5532.348317
#&gt; REFLECTION       127 5532.531606 5532.332133
#&gt; REFLECTION       129 5532.493442 5532.306560
#&gt; EXTENSION        131 5532.429202 5532.050781
#&gt; LO-REDUCTION     133 5532.407426 5532.050781
#&gt; LO-REDUCTION     135 5532.362533 5532.050781
#&gt; LO-REDUCTION     137 5532.348317 5532.050781
#&gt; LO-REDUCTION     139 5532.332133 5532.050781
#&gt; LO-REDUCTION     141 5532.306560 5532.050781
#&gt; EXTENSION        143 5532.232497 5531.890382
#&gt; LO-REDUCTION     145 5532.205878 5531.890382
#&gt; EXTENSION        147 5532.147411 5531.807158
#&gt; EXTENSION        149 5532.142116 5531.716965
#&gt; EXTENSION        151 5532.137615 5531.513458
#&gt; LO-REDUCTION     153 5532.050781 5531.513458
#&gt; EXTENSION        155 5531.905549 5531.315218
#&gt; LO-REDUCTION     157 5531.890382 5531.315218
#&gt; LO-REDUCTION     159 5531.807158 5531.315218
#&gt; REFLECTION       161 5531.716965 5531.278621
#&gt; LO-REDUCTION     163 5531.614671 5531.278621
#&gt; REFLECTION       165 5531.513458 5531.250613
#&gt; LO-REDUCTION     167 5531.413553 5531.250613
#&gt; EXTENSION        169 5531.409765 5531.154810
#&gt; LO-REDUCTION     171 5531.326739 5531.154810
#&gt; LO-REDUCTION     173 5531.315218 5531.154810
#&gt; LO-REDUCTION     175 5531.293479 5531.154810
#&gt; LO-REDUCTION     177 5531.278621 5531.154810
#&gt; HI-REDUCTION     179 5531.250613 5531.154810
#&gt; LO-REDUCTION     181 5531.248495 5531.154810
#&gt; EXTENSION        183 5531.209293 5531.094786
#&gt; LO-REDUCTION     185 5531.204548 5531.094786
#&gt; LO-REDUCTION     187 5531.192078 5531.094786
#&gt; LO-REDUCTION     189 5531.187576 5531.094786
#&gt; EXTENSION        191 5531.180952 5531.043797
#&gt; LO-REDUCTION     193 5531.154810 5531.043797
#&gt; LO-REDUCTION     195 5531.145447 5531.043797
#&gt; LO-REDUCTION     197 5531.124723 5531.043797
#&gt; EXTENSION        199 5531.108066 5530.999833
#&gt; LO-REDUCTION     201 5531.094786 5530.999833
#&gt; LO-REDUCTION     203 5531.073305 5530.999833
#&gt; LO-REDUCTION     205 5531.063715 5530.999833
#&gt; EXTENSION        207 5531.050644 5530.985097
#&gt; EXTENSION        209 5531.043797 5530.977764
#&gt; HI-REDUCTION     211 5531.037048 5530.977764
#&gt; EXTENSION        213 5531.032975 5530.952746
#&gt; EXTENSION        215 5531.032956 5530.926840
#&gt; LO-REDUCTION     217 5531.009381 5530.926840
#&gt; LO-REDUCTION     219 5530.999833 5530.926840
#&gt; LO-REDUCTION     221 5530.985097 5530.926840
#&gt; LO-REDUCTION     223 5530.977764 5530.926840
#&gt; REFLECTION       225 5530.952746 5530.922045
#&gt; REFLECTION       227 5530.950573 5530.921014
#&gt; EXTENSION        229 5530.942375 5530.888649
#&gt; LO-REDUCTION     231 5530.933243 5530.888649
#&gt; LO-REDUCTION     233 5530.931455 5530.888649
#&gt; LO-REDUCTION     235 5530.926840 5530.888649
#&gt; LO-REDUCTION     237 5530.922045 5530.888649
#&gt; REFLECTION       239 5530.921014 5530.882745
#&gt; EXTENSION        241 5530.906345 5530.867521
#&gt; EXTENSION        243 5530.895262 5530.845002
#&gt; LO-REDUCTION     245 5530.893507 5530.845002
#&gt; LO-REDUCTION     247 5530.891989 5530.845002
#&gt; LO-REDUCTION     249 5530.888649 5530.845002
#&gt; REFLECTION       251 5530.882745 5530.841204
#&gt; REFLECTION       253 5530.867521 5530.833039
#&gt; LO-REDUCTION     255 5530.860482 5530.833039
#&gt; REFLECTION       257 5530.858265 5530.829760
#&gt; EXTENSION        259 5530.853082 5530.818575
#&gt; LO-REDUCTION     261 5530.845002 5530.818575
#&gt; LO-REDUCTION     263 5530.841435 5530.818575
#&gt; LO-REDUCTION     265 5530.841204 5530.818575
#&gt; REFLECTION       267 5530.833039 5530.811711
#&gt; LO-REDUCTION     269 5530.829760 5530.811711
#&gt; LO-REDUCTION     271 5530.824613 5530.811711
#&gt; LO-REDUCTION     273 5530.819475 5530.811711
#&gt; LO-REDUCTION     275 5530.819160 5530.811711
#&gt; LO-REDUCTION     277 5530.818997 5530.811711
#&gt; HI-REDUCTION     279 5530.818575 5530.811711
#&gt; LO-REDUCTION     281 5530.815465 5530.811711
#&gt; REFLECTION       283 5530.815022 5530.810725
#&gt; LO-REDUCTION     285 5530.814433 5530.810725
#&gt; LO-REDUCTION     287 5530.813748 5530.810725
#&gt; LO-REDUCTION     289 5530.812422 5530.810725
#&gt; LO-REDUCTION     291 5530.812139 5530.810725
#&gt; LO-REDUCTION     293 5530.812130 5530.810725
#&gt; LO-REDUCTION     295 5530.811711 5530.810725
#&gt; EXTENSION        297 5530.811345 5530.809561
#&gt; LO-REDUCTION     299 5530.811126 5530.809561
#&gt; LO-REDUCTION     301 5530.811054 5530.809561
#&gt; LO-REDUCTION     303 5530.811052 5530.809561
#&gt; LO-REDUCTION     305 5530.810809 5530.809561
#&gt; LO-REDUCTION     307 5530.810725 5530.809561
#&gt; EXTENSION        309 5530.810230 5530.809375
#&gt; EXTENSION        311 5530.810196 5530.809160
#&gt; EXTENSION        313 5530.810129 5530.808480
#&gt; LO-REDUCTION     315 5530.809982 5530.808480
#&gt; LO-REDUCTION     317 5530.809965 5530.808480
#&gt; REFLECTION       319 5530.809561 5530.808417
#&gt; LO-REDUCTION     321 5530.809375 5530.808417
#&gt; REFLECTION       323 5530.809160 5530.808142
#&gt; REFLECTION       325 5530.808813 5530.807918
#&gt; EXTENSION        327 5530.808553 5530.807641
#&gt; LO-REDUCTION     329 5530.808499 5530.807641
#&gt; EXTENSION        331 5530.808480 5530.807275
#&gt; LO-REDUCTION     333 5530.808417 5530.807275
#&gt; LO-REDUCTION     335 5530.808142 5530.807275
#&gt; LO-REDUCTION     337 5530.807918 5530.807275
#&gt; LO-REDUCTION     339 5530.807835 5530.807275
#&gt; EXTENSION        341 5530.807641 5530.806862
#&gt; LO-REDUCTION     343 5530.807527 5530.806862
#&gt; LO-REDUCTION     345 5530.807373 5530.806862
#&gt; LO-REDUCTION     347 5530.807303 5530.806862
#&gt; LO-REDUCTION     349 5530.807294 5530.806862
#&gt; LO-REDUCTION     351 5530.807275 5530.806862
#&gt; LO-REDUCTION     353 5530.807154 5530.806862
#&gt; REFLECTION       355 5530.807094 5530.806802
#&gt; LO-REDUCTION     357 5530.807022 5530.806802
#&gt; LO-REDUCTION     359 5530.807015 5530.806802
#&gt; LO-REDUCTION     361 5530.806914 5530.806802
#&gt; Exiting from Nelder Mead minimizer
#&gt;     363 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0894975   1.4937390  -3.0198310  -0.9673983  -0.5297408   0.3194827 
#&gt; 
#&gt; $value
#&gt; [1] 5530.807
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      363 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.36 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |======================================================================| 100%fn is  fn 
#&gt; Looking for method =  Nelder-Mead 
#&gt; Methods to be used:[1] "Nelder-Mead"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 6
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "Nelder-Mead"
#&gt; 
#&gt; Method:  Nelder-Mead 
#&gt;   Nelder-Mead direct search function minimizer
#&gt; function value for initial parameters = 6176.628555
#&gt;   Scaled convergence tolerance is 9.20389e-05
#&gt; Stepsize computed as 0.300078
#&gt; BUILD              7 11908.034655 5761.688360
#&gt; LO-REDUCTION       9 7915.982938 5761.688360
#&gt; LO-REDUCTION      11 7674.308709 5761.688360
#&gt; REFLECTION        13 6890.751068 5747.812327
#&gt; LO-REDUCTION      15 6669.590781 5747.812327
#&gt; LO-REDUCTION      17 6459.545782 5747.812327
#&gt; REFLECTION        19 6396.391838 5730.984730
#&gt; REFLECTION        21 6176.628555 5536.194755
#&gt; LO-REDUCTION      23 5976.858971 5536.194755
#&gt; LO-REDUCTION      25 5959.185826 5536.194755
#&gt; LO-REDUCTION      27 5761.688360 5536.194755
#&gt; HI-REDUCTION      29 5747.812327 5536.194755
#&gt; LO-REDUCTION      31 5730.984730 5536.194755
#&gt; LO-REDUCTION      33 5607.155369 5532.945380
#&gt; LO-REDUCTION      35 5606.820596 5532.945380
#&gt; LO-REDUCTION      37 5564.906593 5532.179423
#&gt; HI-REDUCTION      39 5558.698971 5532.179423
#&gt; HI-REDUCTION      41 5544.543104 5532.179423
#&gt; LO-REDUCTION      43 5538.924625 5531.301830
#&gt; REFLECTION        45 5537.970636 5528.602111
#&gt; LO-REDUCTION      47 5536.194755 5526.395723
#&gt; HI-REDUCTION      49 5533.536721 5526.395723
#&gt; LO-REDUCTION      51 5532.945380 5526.217982
#&gt; HI-REDUCTION      53 5532.179423 5526.217982
#&gt; LO-REDUCTION      55 5531.301830 5525.452862
#&gt; REFLECTION        57 5528.602111 5524.417465
#&gt; HI-REDUCTION      59 5527.244834 5524.417465
#&gt; LO-REDUCTION      61 5527.233739 5524.044634
#&gt; REFLECTION        63 5526.395723 5523.937200
#&gt; LO-REDUCTION      65 5526.217982 5523.538623
#&gt; HI-REDUCTION      67 5525.452862 5523.450220
#&gt; REFLECTION        69 5524.677433 5522.288489
#&gt; REFLECTION        71 5524.417465 5521.970850
#&gt; LO-REDUCTION      73 5524.044634 5521.970850
#&gt; LO-REDUCTION      75 5523.937200 5521.970850
#&gt; HI-REDUCTION      77 5523.538623 5521.970850
#&gt; LO-REDUCTION      79 5523.450220 5521.970850
#&gt; LO-REDUCTION      81 5522.492949 5521.812990
#&gt; HI-REDUCTION      83 5522.477252 5521.812990
#&gt; LO-REDUCTION      85 5522.288489 5521.812990
#&gt; REFLECTION        87 5522.062959 5521.808214
#&gt; REFLECTION        89 5522.056676 5521.740629
#&gt; LO-REDUCTION      91 5521.970850 5521.642616
#&gt; REFLECTION        93 5521.911315 5521.591229
#&gt; LO-REDUCTION      95 5521.826091 5521.580765
#&gt; LO-REDUCTION      97 5521.812990 5521.570059
#&gt; REFLECTION        99 5521.808214 5521.564078
#&gt; LO-REDUCTION     101 5521.740629 5521.541158
#&gt; REFLECTION       103 5521.642616 5521.531368
#&gt; LO-REDUCTION     105 5521.591229 5521.491779
#&gt; LO-REDUCTION     107 5521.580765 5521.465698
#&gt; LO-REDUCTION     109 5521.570059 5521.465698
#&gt; REFLECTION       111 5521.564078 5521.421293
#&gt; LO-REDUCTION     113 5521.541158 5521.420837
#&gt; HI-REDUCTION     115 5521.531368 5521.420837
#&gt; LO-REDUCTION     117 5521.491779 5521.420837
#&gt; LO-REDUCTION     119 5521.477495 5521.416605
#&gt; LO-REDUCTION     121 5521.465698 5521.412552
#&gt; REFLECTION       123 5521.442970 5521.391168
#&gt; LO-REDUCTION     125 5521.437393 5521.391168
#&gt; REFLECTION       127 5521.421293 5521.382111
#&gt; HI-REDUCTION     129 5521.420837 5521.382111
#&gt; HI-REDUCTION     131 5521.416605 5521.382111
#&gt; EXTENSION        133 5521.412552 5521.356684
#&gt; LO-REDUCTION     135 5521.396235 5521.356684
#&gt; EXTENSION        137 5521.392020 5521.346459
#&gt; LO-REDUCTION     139 5521.391168 5521.346459
#&gt; LO-REDUCTION     141 5521.390492 5521.346459
#&gt; LO-REDUCTION     143 5521.382111 5521.346459
#&gt; LO-REDUCTION     145 5521.379622 5521.346459
#&gt; EXTENSION        147 5521.361658 5521.311161
#&gt; LO-REDUCTION     149 5521.359966 5521.311161
#&gt; HI-REDUCTION     151 5521.359851 5521.311161
#&gt; LO-REDUCTION     153 5521.356684 5521.311161
#&gt; LO-REDUCTION     155 5521.350220 5521.311161
#&gt; EXTENSION        157 5521.346459 5521.295401
#&gt; EXTENSION        159 5521.342828 5521.287589
#&gt; LO-REDUCTION     161 5521.333812 5521.287589
#&gt; EXTENSION        163 5521.317523 5521.243092
#&gt; LO-REDUCTION     165 5521.313181 5521.243092
#&gt; LO-REDUCTION     167 5521.311161 5521.243092
#&gt; LO-REDUCTION     169 5521.295401 5521.243092
#&gt; LO-REDUCTION     171 5521.288119 5521.243092
#&gt; EXTENSION        173 5521.287589 5521.235112
#&gt; LO-REDUCTION     175 5521.272260 5521.235112
#&gt; EXTENSION        177 5521.271848 5521.213136
#&gt; LO-REDUCTION     179 5521.256296 5521.213136
#&gt; LO-REDUCTION     181 5521.252925 5521.213136
#&gt; LO-REDUCTION     183 5521.243092 5521.213136
#&gt; LO-REDUCTION     185 5521.240612 5521.213136
#&gt; LO-REDUCTION     187 5521.235112 5521.213136
#&gt; EXTENSION        189 5521.225048 5521.208449
#&gt; LO-REDUCTION     191 5521.222970 5521.208449
#&gt; LO-REDUCTION     193 5521.222810 5521.208449
#&gt; LO-REDUCTION     195 5521.220033 5521.208071
#&gt; EXTENSION        197 5521.219413 5521.188963
#&gt; LO-REDUCTION     199 5521.213136 5521.188963
#&gt; LO-REDUCTION     201 5521.212099 5521.188963
#&gt; LO-REDUCTION     203 5521.209808 5521.188963
#&gt; LO-REDUCTION     205 5521.208449 5521.188963
#&gt; EXTENSION        207 5521.208071 5521.177226
#&gt; EXTENSION        209 5521.203878 5521.162361
#&gt; LO-REDUCTION     211 5521.195242 5521.162361
#&gt; LO-REDUCTION     213 5521.194244 5521.162361
#&gt; EXTENSION        215 5521.191144 5521.156941
#&gt; LO-REDUCTION     217 5521.188963 5521.156941
#&gt; EXTENSION        219 5521.177226 5521.137193
#&gt; LO-REDUCTION     221 5521.175309 5521.137193
#&gt; EXTENSION        223 5521.162886 5521.115842
#&gt; LO-REDUCTION     225 5521.162361 5521.115842
#&gt; LO-REDUCTION     227 5521.157704 5521.115842
#&gt; LO-REDUCTION     229 5521.156941 5521.115842
#&gt; LO-REDUCTION     231 5521.142658 5521.115842
#&gt; LO-REDUCTION     233 5521.139765 5521.115842
#&gt; LO-REDUCTION     235 5521.137193 5521.115842
#&gt; LO-REDUCTION     237 5521.135496 5521.115842
#&gt; LO-REDUCTION     239 5521.133981 5521.115842
#&gt; EXTENSION        241 5521.129401 5521.108661
#&gt; LO-REDUCTION     243 5521.128826 5521.108661
#&gt; EXTENSION        245 5521.127194 5521.097630
#&gt; LO-REDUCTION     247 5521.122782 5521.097630
#&gt; EXTENSION        249 5521.121725 5521.091874
#&gt; EXTENSION        251 5521.115842 5521.072763
#&gt; LO-REDUCTION     253 5521.111930 5521.072763
#&gt; LO-REDUCTION     255 5521.108661 5521.072763
#&gt; EXTENSION        257 5521.103548 5521.059593
#&gt; LO-REDUCTION     259 5521.097630 5521.059593
#&gt; LO-REDUCTION     261 5521.091874 5521.059593
#&gt; EXTENSION        263 5521.090393 5521.045065
#&gt; EXTENSION        265 5521.080157 5521.038771
#&gt; LO-REDUCTION     267 5521.072763 5521.038771
#&gt; LO-REDUCTION     269 5521.070323 5521.038771
#&gt; REFLECTION       271 5521.066554 5521.035248
#&gt; LO-REDUCTION     273 5521.059593 5521.035248
#&gt; LO-REDUCTION     275 5521.048597 5521.035248
#&gt; EXTENSION        277 5521.045065 5521.029641
#&gt; LO-REDUCTION     279 5521.040564 5521.029641
#&gt; LO-REDUCTION     281 5521.038771 5521.029641
#&gt; LO-REDUCTION     283 5521.038284 5521.029641
#&gt; LO-REDUCTION     285 5521.038185 5521.029641
#&gt; EXTENSION        287 5521.035248 5521.025687
#&gt; HI-REDUCTION     289 5521.034994 5521.025687
#&gt; LO-REDUCTION     291 5521.033139 5521.025687
#&gt; EXTENSION        293 5521.032936 5521.021768
#&gt; LO-REDUCTION     295 5521.031110 5521.021768
#&gt; LO-REDUCTION     297 5521.030863 5521.021768
#&gt; HI-REDUCTION     299 5521.029641 5521.021768
#&gt; LO-REDUCTION     301 5521.026976 5521.021768
#&gt; EXTENSION        303 5521.026255 5521.020958
#&gt; LO-REDUCTION     305 5521.025687 5521.020958
#&gt; REFLECTION       307 5521.025363 5521.019969
#&gt; EXTENSION        309 5521.024056 5521.015624
#&gt; LO-REDUCTION     311 5521.022586 5521.015624
#&gt; LO-REDUCTION     313 5521.022307 5521.015624
#&gt; LO-REDUCTION     315 5521.021768 5521.015624
#&gt; LO-REDUCTION     317 5521.020958 5521.015624
#&gt; LO-REDUCTION     319 5521.020091 5521.015624
#&gt; LO-REDUCTION     321 5521.019969 5521.015624
#&gt; LO-REDUCTION     323 5521.019511 5521.015624
#&gt; EXTENSION        325 5521.018432 5521.014359
#&gt; EXTENSION        327 5521.018382 5521.014007
#&gt; EXTENSION        329 5521.017132 5521.011437
#&gt; EXTENSION        331 5521.016223 5521.010593
#&gt; LO-REDUCTION     333 5521.015921 5521.010593
#&gt; HI-REDUCTION     335 5521.015624 5521.010593
#&gt; LO-REDUCTION     337 5521.014359 5521.010593
#&gt; EXTENSION        339 5521.014007 5521.006721
#&gt; EXTENSION        341 5521.012712 5521.003568
#&gt; LO-REDUCTION     343 5521.011437 5521.003568
#&gt; LO-REDUCTION     345 5521.011278 5521.003568
#&gt; EXTENSION        347 5521.010672 5520.999508
#&gt; LO-REDUCTION     349 5521.010593 5520.999508
#&gt; LO-REDUCTION     351 5521.008313 5520.999508
#&gt; EXTENSION        353 5521.006721 5520.991305
#&gt; LO-REDUCTION     355 5521.006274 5520.991305
#&gt; LO-REDUCTION     357 5521.003568 5520.991305
#&gt; LO-REDUCTION     359 5521.001035 5520.991305
#&gt; EXTENSION        361 5521.000378 5520.986853
#&gt; EXTENSION        363 5520.999508 5520.986054
#&gt; EXTENSION        365 5520.995440 5520.975132
#&gt; LO-REDUCTION     367 5520.991592 5520.975132
#&gt; LO-REDUCTION     369 5520.991483 5520.975132
#&gt; LO-REDUCTION     371 5520.991305 5520.975132
#&gt; LO-REDUCTION     373 5520.986853 5520.975132
#&gt; LO-REDUCTION     375 5520.986054 5520.975132
#&gt; EXTENSION        377 5520.979902 5520.958530
#&gt; LO-REDUCTION     379 5520.978501 5520.958530
#&gt; LO-REDUCTION     381 5520.976124 5520.958530
#&gt; LO-REDUCTION     383 5520.975576 5520.958530
#&gt; LO-REDUCTION     385 5520.975563 5520.958530
#&gt; EXTENSION        387 5520.975132 5520.946301
#&gt; EXTENSION        389 5520.966947 5520.934626
#&gt; LO-REDUCTION     391 5520.964812 5520.934626
#&gt; LO-REDUCTION     393 5520.963174 5520.934626
#&gt; LO-REDUCTION     395 5520.963007 5520.934626
#&gt; EXTENSION        397 5520.958530 5520.921676
#&gt; LO-REDUCTION     399 5520.947738 5520.921676
#&gt; EXTENSION        401 5520.946301 5520.911677
#&gt; LO-REDUCTION     403 5520.941482 5520.911677
#&gt; REFLECTION       405 5520.938527 5520.911344
#&gt; EXTENSION        407 5520.934626 5520.898597
#&gt; LO-REDUCTION     409 5520.923561 5520.898597
#&gt; LO-REDUCTION     411 5520.921676 5520.898597
#&gt; LO-REDUCTION     413 5520.918969 5520.898597
#&gt; REFLECTION       415 5520.911677 5520.893500
#&gt; HI-REDUCTION     417 5520.911344 5520.893500
#&gt; LO-REDUCTION     419 5520.909025 5520.893500
#&gt; EXTENSION        421 5520.902941 5520.883114
#&gt; LO-REDUCTION     423 5520.902255 5520.883114
#&gt; LO-REDUCTION     425 5520.899980 5520.883114
#&gt; LO-REDUCTION     427 5520.898597 5520.883114
#&gt; LO-REDUCTION     429 5520.897929 5520.883114
#&gt; EXTENSION        431 5520.893500 5520.877858
#&gt; LO-REDUCTION     433 5520.892310 5520.877858
#&gt; LO-REDUCTION     435 5520.889895 5520.877858
#&gt; LO-REDUCTION     437 5520.887749 5520.877858
#&gt; LO-REDUCTION     439 5520.886641 5520.877858
#&gt; EXTENSION        441 5520.883114 5520.871526
#&gt; HI-REDUCTION     443 5520.881050 5520.871526
#&gt; LO-REDUCTION     445 5520.879529 5520.871526
#&gt; EXTENSION        447 5520.879432 5520.867514
#&gt; LO-REDUCTION     449 5520.878325 5520.867514
#&gt; EXTENSION        451 5520.877900 5520.867033
#&gt; LO-REDUCTION     453 5520.877858 5520.867033
#&gt; EXTENSION        455 5520.873536 5520.858542
#&gt; LO-REDUCTION     457 5520.871526 5520.858542
#&gt; EXTENSION        459 5520.868615 5520.852614
#&gt; LO-REDUCTION     461 5520.868259 5520.852614
#&gt; EXTENSION        463 5520.867514 5520.840904
#&gt; LO-REDUCTION     465 5520.867033 5520.840904
#&gt; EXTENSION        467 5520.863156 5520.832502
#&gt; LO-REDUCTION     469 5520.858542 5520.832502
#&gt; LO-REDUCTION     471 5520.855079 5520.832502
#&gt; EXTENSION        473 5520.854928 5520.821823
#&gt; EXTENSION        475 5520.852614 5520.807622
#&gt; EXTENSION        477 5520.840904 5520.797141
#&gt; LO-REDUCTION     479 5520.835332 5520.797141
#&gt; LO-REDUCTION     481 5520.834014 5520.797141
#&gt; LO-REDUCTION     483 5520.832502 5520.797141
#&gt; LO-REDUCTION     485 5520.821823 5520.797141
#&gt; EXTENSION        487 5520.807959 5520.781555
#&gt; EXTENSION        489 5520.807622 5520.764622
#&gt; LO-REDUCTION     491 5520.806834 5520.764622
#&gt; LO-REDUCTION     493 5520.798982 5520.764622
#&gt; EXTENSION        495 5520.797542 5520.751605
#&gt; LO-REDUCTION     497 5520.797141 5520.751605
#&gt; LO-REDUCTION     499 5520.790009 5520.751605
#&gt; EXTENSION        501 5520.781555 5520.718361
#&gt; LO-REDUCTION     503 5520.774648 5520.718361
#&gt; EXTENSION        505 5520.764622 5520.694901
#&gt; LO-REDUCTION     507 5520.763471 5520.694901
#&gt; LO-REDUCTION     509 5520.759052 5520.694901
#&gt; EXTENSION        511 5520.751605 5520.637936
#&gt; LO-REDUCTION     513 5520.729784 5520.637936
#&gt; LO-REDUCTION     515 5520.726237 5520.637936
#&gt; EXTENSION        517 5520.718361 5520.573632
#&gt; LO-REDUCTION     519 5520.695102 5520.573632
#&gt; LO-REDUCTION     521 5520.694901 5520.573632
#&gt; EXTENSION        523 5520.652538 5520.490561
#&gt; LO-REDUCTION     525 5520.644464 5520.490561
#&gt; LO-REDUCTION     527 5520.637936 5520.490561
#&gt; EXTENSION        529 5520.599766 5520.411014
#&gt; LO-REDUCTION     531 5520.578369 5520.411014
#&gt; EXTENSION        533 5520.573632 5520.344601
#&gt; LO-REDUCTION     535 5520.509623 5520.344601
#&gt; LO-REDUCTION     537 5520.497730 5520.344601
#&gt; LO-REDUCTION     539 5520.490561 5520.344601
#&gt; LO-REDUCTION     541 5520.455035 5520.344601
#&gt; REFLECTION       543 5520.411014 5520.329174
#&gt; LO-REDUCTION     545 5520.393770 5520.329174
#&gt; EXTENSION        547 5520.369695 5520.297077
#&gt; LO-REDUCTION     549 5520.364444 5520.297077
#&gt; LO-REDUCTION     551 5520.359017 5520.297077
#&gt; EXTENSION        553 5520.349436 5520.271683
#&gt; EXTENSION        555 5520.344601 5520.266913
#&gt; HI-REDUCTION     557 5520.329174 5520.266913
#&gt; EXTENSION        559 5520.312033 5520.239325
#&gt; LO-REDUCTION     561 5520.309633 5520.239325
#&gt; EXTENSION        563 5520.298496 5520.190450
#&gt; LO-REDUCTION     565 5520.297077 5520.190450
#&gt; LO-REDUCTION     567 5520.271683 5520.190450
#&gt; LO-REDUCTION     569 5520.266913 5520.190450
#&gt; LO-REDUCTION     571 5520.252212 5520.190450
#&gt; LO-REDUCTION     573 5520.248147 5520.190450
#&gt; EXTENSION        575 5520.239325 5520.162451
#&gt; LO-REDUCTION     577 5520.233073 5520.162451
#&gt; LO-REDUCTION     579 5520.222293 5520.162451
#&gt; EXTENSION        581 5520.221810 5520.135808
#&gt; EXTENSION        583 5520.218525 5520.111739
#&gt; EXTENSION        585 5520.191668 5520.018734
#&gt; LO-REDUCTION     587 5520.190450 5520.018734
#&gt; LO-REDUCTION     589 5520.167512 5520.018734
#&gt; EXTENSION        591 5520.162451 5519.910125
#&gt; LO-REDUCTION     593 5520.135808 5519.910125
#&gt; LO-REDUCTION     595 5520.111739 5519.910125
#&gt; EXTENSION        597 5520.074600 5519.759931
#&gt; LO-REDUCTION     599 5520.027223 5519.759931
#&gt; EXTENSION        601 5520.018734 5519.652566
#&gt; LO-REDUCTION     603 5519.959462 5519.652566
#&gt; EXTENSION        605 5519.928539 5519.469115
#&gt; LO-REDUCTION     607 5519.910125 5519.469115
#&gt; EXTENSION        609 5519.792989 5519.209075
#&gt; LO-REDUCTION     611 5519.759931 5519.209075
#&gt; LO-REDUCTION     613 5519.652782 5519.209075
#&gt; EXTENSION        615 5519.652566 5519.137775
#&gt; REFLECTION       617 5519.545093 5519.093544
#&gt; EXTENSION        619 5519.469115 5518.872212
#&gt; LO-REDUCTION     621 5519.312128 5518.872212
#&gt; LO-REDUCTION     623 5519.211533 5518.872212
#&gt; LO-REDUCTION     625 5519.209075 5518.872212
#&gt; LO-REDUCTION     627 5519.137775 5518.872212
#&gt; LO-REDUCTION     629 5519.093544 5518.872212
#&gt; LO-REDUCTION     631 5519.002224 5518.872212
#&gt; LO-REDUCTION     633 5518.982521 5518.872212
#&gt; EXTENSION        635 5518.973602 5518.834839
#&gt; LO-REDUCTION     637 5518.929850 5518.834839
#&gt; LO-REDUCTION     639 5518.907079 5518.834839
#&gt; LO-REDUCTION     641 5518.902191 5518.834839
#&gt; LO-REDUCTION     643 5518.879188 5518.834839
#&gt; LO-REDUCTION     645 5518.872212 5518.834839
#&gt; LO-REDUCTION     647 5518.861347 5518.834839
#&gt; LO-REDUCTION     649 5518.852950 5518.834839
#&gt; HI-REDUCTION     651 5518.847781 5518.834839
#&gt; LO-REDUCTION     653 5518.847302 5518.834839
#&gt; LO-REDUCTION     655 5518.846870 5518.834839
#&gt; LO-REDUCTION     657 5518.845493 5518.834839
#&gt; LO-REDUCTION     659 5518.843029 5518.834839
#&gt; LO-REDUCTION     661 5518.839796 5518.834839
#&gt; EXTENSION        663 5518.839358 5518.829072
#&gt; LO-REDUCTION     665 5518.838405 5518.829072
#&gt; LO-REDUCTION     667 5518.837623 5518.829072
#&gt; EXTENSION        669 5518.837295 5518.827363
#&gt; LO-REDUCTION     671 5518.834941 5518.827363
#&gt; EXTENSION        673 5518.834839 5518.822966
#&gt; EXTENSION        675 5518.832242 5518.815423
#&gt; LO-REDUCTION     677 5518.831589 5518.815423
#&gt; LO-REDUCTION     679 5518.829314 5518.815423
#&gt; EXTENSION        681 5518.829072 5518.813134
#&gt; EXTENSION        683 5518.827363 5518.810078
#&gt; EXTENSION        685 5518.822966 5518.794354
#&gt; LO-REDUCTION     687 5518.818675 5518.794354
#&gt; LO-REDUCTION     689 5518.816421 5518.794354
#&gt; LO-REDUCTION     691 5518.815423 5518.794354
#&gt; LO-REDUCTION     693 5518.813134 5518.794354
#&gt; EXTENSION        695 5518.810078 5518.790422
#&gt; REFLECTION       697 5518.805140 5518.788303
#&gt; LO-REDUCTION     699 5518.801854 5518.788303
#&gt; EXTENSION        701 5518.799906 5518.778394
#&gt; EXTENSION        703 5518.799169 5518.772494
#&gt; LO-REDUCTION     705 5518.794354 5518.772494
#&gt; LO-REDUCTION     707 5518.790644 5518.772494
#&gt; LO-REDUCTION     709 5518.790422 5518.772494
#&gt; LO-REDUCTION     711 5518.788303 5518.772494
#&gt; LO-REDUCTION     713 5518.778394 5518.772494
#&gt; REFLECTION       715 5518.778321 5518.772091
#&gt; REFLECTION       717 5518.777726 5518.771410
#&gt; HI-REDUCTION     719 5518.777257 5518.771410
#&gt; LO-REDUCTION     721 5518.773665 5518.771089
#&gt; REFLECTION       723 5518.773583 5518.770540
#&gt; LO-REDUCTION     725 5518.773201 5518.770540
#&gt; LO-REDUCTION     727 5518.772494 5518.770462
#&gt; LO-REDUCTION     729 5518.772091 5518.770462
#&gt; REFLECTION       731 5518.771410 5518.769916
#&gt; REFLECTION       733 5518.771089 5518.769799
#&gt; LO-REDUCTION     735 5518.770785 5518.769799
#&gt; LO-REDUCTION     737 5518.770779 5518.769799
#&gt; REFLECTION       739 5518.770540 5518.769511
#&gt; REFLECTION       741 5518.770462 5518.769247
#&gt; EXTENSION        743 5518.770171 5518.768587
#&gt; LO-REDUCTION     745 5518.769924 5518.768587
#&gt; LO-REDUCTION     747 5518.769916 5518.768587
#&gt; LO-REDUCTION     749 5518.769799 5518.768587
#&gt; REFLECTION       751 5518.769511 5518.768340
#&gt; LO-REDUCTION     753 5518.769247 5518.768340
#&gt; LO-REDUCTION     755 5518.768752 5518.768340
#&gt; REFLECTION       757 5518.768714 5518.768195
#&gt; REFLECTION       759 5518.768656 5518.768123
#&gt; HI-REDUCTION     761 5518.768590 5518.768123
#&gt; LO-REDUCTION     763 5518.768587 5518.768123
#&gt; EXTENSION        765 5518.768467 5518.767895
#&gt; LO-REDUCTION     767 5518.768340 5518.767895
#&gt; LO-REDUCTION     769 5518.768291 5518.767895
#&gt; REFLECTION       771 5518.768195 5518.767815
#&gt; LO-REDUCTION     773 5518.768146 5518.767813
#&gt; EXTENSION        775 5518.768123 5518.767562
#&gt; LO-REDUCTION     777 5518.767956 5518.767562
#&gt; HI-REDUCTION     779 5518.767938 5518.767562
#&gt; LO-REDUCTION     781 5518.767895 5518.767562
#&gt; LO-REDUCTION     783 5518.767815 5518.767562
#&gt; LO-REDUCTION     785 5518.767813 5518.767562
#&gt; LO-REDUCTION     787 5518.767773 5518.767562
#&gt; LO-REDUCTION     789 5518.767712 5518.767562
#&gt; EXTENSION        791 5518.767645 5518.767406
#&gt; LO-REDUCTION     793 5518.767622 5518.767406
#&gt; LO-REDUCTION     795 5518.767621 5518.767406
#&gt; LO-REDUCTION     797 5518.767594 5518.767406
#&gt; EXTENSION        799 5518.767579 5518.767341
#&gt; LO-REDUCTION     801 5518.767562 5518.767341
#&gt; EXTENSION        803 5518.767525 5518.767256
#&gt; LO-REDUCTION     805 5518.767487 5518.767256
#&gt; LO-REDUCTION     807 5518.767459 5518.767256
#&gt; LO-REDUCTION     809 5518.767418 5518.767256
#&gt; LO-REDUCTION     811 5518.767406 5518.767256
#&gt; LO-REDUCTION     813 5518.767352 5518.767256
#&gt; Exiting from Nelder Mead minimizer
#&gt;     815 function evaluations used
#&gt; Post processing for method  Nelder-Mead 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  Nelder-Mead 
#&gt; Compute gradient approximation at finish of  Nelder-Mead 
#&gt; Save results from method  Nelder-Mead 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0833806   1.4800215  -3.0048100  -0.9687616  -0.5816980   0.3195044 
#&gt; 
#&gt; $value
#&gt; [1] 5518.767
#&gt; 
#&gt; $message
#&gt; NULL
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;      815 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       NA 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.62 
#&gt; 
#&gt; Assemble the answers
#&gt; </div><div class='input'>
<span class='co'># use method L-BFGS-B instead of Nelder-Mead and print report every 50 iterations</span>
 <span class='no'>res.c1</span> <span class='kw'>&lt;-</span> <span class='fu'>copulaCorrection</span>(<span class='no'>y</span>~<span class='no'>X1</span>+<span class='no'>X2</span>+<span class='no'>P</span><span class='kw'>|</span><span class='fu'>continuous</span>(<span class='no'>P</span>),
                            <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"L-BFGS-B"</span>,
                                               <span class='kw'>control</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>trace</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>REPORT</span><span class='kw'>=</span><span class='fl'>50</span>)),
                            <span class='kw'>num.boots</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>data</span><span class='kw'>=</span><span class='no'>dataCopCont</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: It is recommended to run 1000 or more bootstraps.</span></div><div class='output co'>#&gt; <span class='message'>Optimizing LL for the single continuous endogenous regressor P.</span></div><div class='output co'>#&gt; <span class='message'>No start parameters were given. The linear model y ~ X1 + X2 + P was fitted and start parameters c((Intercept)=2.035, X1=1.492, X2=-3.001, P=-0.821) are used.</span></div><div class='output co'>#&gt; fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 32
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.120456
#&gt; final function value 5472.96
#&gt; 
#&gt; final  value 5472.961311 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0357392   1.4920300  -3.0020515  -0.9571233  -0.6439850   0.3010139 
#&gt; 
#&gt; $value
#&gt; [1] 5472.961
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       32 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       32 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.48 
#&gt; 
#&gt; Assemble the answers</div><div class='output co'>#&gt; <span class='message'>Running 10 bootstraps.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======                                                               |  10%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 29
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0195478
#&gt; final function value 5442.6
#&gt; 
#&gt; final  value 5442.595838 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0272062   1.4938794  -3.0098549  -0.9474678  -0.5765299   0.2896899 
#&gt; 
#&gt; $value
#&gt; [1] 5442.596
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       29 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       29 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.28 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==============                                                        |  20%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 27
#&gt; function evaluations 34
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.070375
#&gt; final function value 5459.26
#&gt; 
#&gt; final  value 5459.259254 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0489639   1.4878878  -3.0049513  -0.9705989  -0.4192992   0.3084112 
#&gt; 
#&gt; $value
#&gt; [1] 5459.259
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       34 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       34 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.32 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=====================                                                 |  30%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 31
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0194508
#&gt; final function value 5463.74
#&gt; 
#&gt; final  value 5463.736250 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   1.9705138   1.4998842  -2.9936691  -0.9356585  -0.8347134   0.2860095 
#&gt; 
#&gt; $value
#&gt; [1] 5463.736
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       31 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       31 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.28 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |============================                                          |  40%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 24
#&gt; function evaluations 30
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.460697
#&gt; final function value 5491.12
#&gt; 
#&gt; final  value 5491.116056 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0217240   1.4924518  -3.0062189  -0.9354655  -0.7969088   0.3024538 
#&gt; 
#&gt; $value
#&gt; [1] 5491.116
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       30 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       30 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.31 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===================================                                   |  50%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 24
#&gt; function evaluations 30
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.114193
#&gt; final function value 5508.93
#&gt; 
#&gt; final  value 5508.926924 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0199267   1.5012179  -3.0109880  -1.0025297  -0.4370527   0.3268280 
#&gt; 
#&gt; $value
#&gt; [1] 5508.927
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       30 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       30 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.31 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |==========================================                            |  60%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 27
#&gt; function evaluations 31
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.219064
#&gt; final function value 5455.15
#&gt; 
#&gt; final  value 5455.151819 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0418568   1.4904732  -3.0148154  -0.9678995  -0.5857385   0.2971326 
#&gt; 
#&gt; $value
#&gt; [1] 5455.152
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       31 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       31 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.31 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |=================================================                     |  70%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 23
#&gt; function evaluations 28
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.33923
#&gt; final function value 5514.08
#&gt; 
#&gt; final  value 5514.083472 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0516648   1.4926496  -3.0028171  -0.9794091  -0.4737071   0.3261048 
#&gt; 
#&gt; $value
#&gt; [1] 5514.083
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       28 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       28 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.39 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |========================================================              |  80%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 25
#&gt; function evaluations 29
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.2592
#&gt; final function value 5527.79
#&gt; 
#&gt; final  value 5527.791324 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0279292   1.4903780  -2.9962790  -0.9721135  -0.6256215   0.3204383 
#&gt; 
#&gt; $value
#&gt; [1] 5527.791
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       29 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       29 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.28 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |===============================================================       |  90%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 21
#&gt; function evaluations 26
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.713059
#&gt; final function value 5459.41
#&gt; 
#&gt; final  value 5459.407669 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0626474   1.4931854  -3.0005646  -0.9766677  -0.4520050   0.3056350 
#&gt; 
#&gt; $value
#&gt; [1] 5459.408
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       26 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       26 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.32 
#&gt; 
#&gt; Assemble the answers
#&gt;   |                                                                              |======================================================================| 100%fn is  fn 
#&gt; Looking for method =  L-BFGS-B 
#&gt; Methods to be used:[1] "L-BFGS-B"
#&gt; Function has  6  arguments
#&gt; Analytic gradient not made available.
#&gt; Analytic Hessian not made available.
#&gt; Scale check -- log parameter ratio= 0.5629566   log bounds ratio= NA 
#&gt; optcfg:$fname
#&gt; [1] "fn"
#&gt; 
#&gt; $npar
#&gt; [1] 6
#&gt; 
#&gt; $ctrl
#&gt; $ctrl$follow.on
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$save.failures
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$trace
#&gt; [1] 2
#&gt; 
#&gt; $ctrl$kkt
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$all.methods
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$starttests
#&gt; [1] TRUE
#&gt; 
#&gt; $ctrl$maximize
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$dowarn
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ctrl$kkttol
#&gt; [1] 0.001
#&gt; 
#&gt; $ctrl$kkt2tol
#&gt; [1] 1e-06
#&gt; 
#&gt; $ctrl$badval
#&gt; [1] 8.988466e+307
#&gt; 
#&gt; $ctrl$scaletol
#&gt; [1] 3
#&gt; 
#&gt; $ctrl$REPORT
#&gt; [1] 50
#&gt; 
#&gt; $ctrl$have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $usenumDeriv
#&gt; [1] FALSE
#&gt; 
#&gt; $ufn
#&gt; function (params, vec.y, m.data.exo.endo, vec.data.endo.pstar) 
#&gt; {
#&gt;     params.endo.exo &lt;- params[setdiff(names(params), c("sigma", 
#&gt;         "rho"))]
#&gt;     sigma &lt;- params["sigma"]
#&gt;     rho &lt;- params["rho"]
#&gt;     rho &lt;- exp(rho)
#&gt;     rho &lt;- rho/(1 + rho)
#&gt;     sigma &lt;- exp(sigma)
#&gt;     params.endo.exo &lt;- params.endo.exo[colnames(m.data.exo.endo)]
#&gt;     eps.1 &lt;- vec.y - m.data.exo.endo %*% params.endo.exo
#&gt;     ppnorm &lt;- pnorm(eps.1, mean = 0, sd = sigma)
#&gt;     ppnorm[ppnorm &gt;= 0.999998] &lt;- 0.999998
#&gt;     ppnorm[ppnorm &lt;= 1e-04] &lt;- 1e-04
#&gt;     eps.star &lt;- stats::qnorm(ppnorm)
#&gt;     l.eps &lt;- sum(dnorm(eps.1, mean = 0, sd = sigma, log = TRUE))
#&gt;     s &lt;- sum((vec.data.endo.pstar^2 + eps.star^2)/(2 * (1 - rho^2)) - 
#&gt;         (rho * vec.data.endo.pstar * eps.star)/(1 - rho^2))
#&gt;     mm &lt;- (length(vec.y)/2) * log(1 - rho^2)
#&gt;     log.LL &lt;- -mm - s + l.eps
#&gt;     return(-1 * log.LL)
#&gt; }
#&gt; &lt;bytecode: 0x000000003167a1c0&gt;
#&gt; &lt;environment: namespace:REndo&gt;
#&gt; 
#&gt; $have.bounds
#&gt; [1] FALSE
#&gt; 
#&gt; $method
#&gt; [1] "L-BFGS-B"
#&gt; 
#&gt; Method:  L-BFGS-B 
#&gt; N = 6, M = 5 machine precision = 2.22045e-16
#&gt; This problem is unconstrained.
#&gt; 
#&gt; iterations 33
#&gt; function evaluations 40
#&gt; segments explored during Cauchy searches 1
#&gt; BFGS updates skipped 0
#&gt; active bounds at final generalized Cauchy point 0
#&gt; norm of the final projected gradient 0.0469909
#&gt; final function value 5386.47
#&gt; 
#&gt; final  value 5386.474390 
#&gt; converged
#&gt; Post processing for method  L-BFGS-B 
#&gt; Successful convergence! 
#&gt; Compute Hessian approximation at finish of  L-BFGS-B 
#&gt; Compute gradient approximation at finish of  L-BFGS-B 
#&gt; Save results from method  L-BFGS-B 
#&gt; $par
#&gt; (Intercept)          X1          X2           P         rho       sigma 
#&gt;   2.0956873   1.4843369  -3.0027926  -0.9658839  -0.5717402   0.2637332 
#&gt; 
#&gt; $value
#&gt; [1] 5386.474
#&gt; 
#&gt; $message
#&gt; [1] "CONVERGENCE: REL_REDUCTION_OF_F &lt;= FACTR*EPSMCH"
#&gt; 
#&gt; $convcode
#&gt; [1] 0
#&gt; 
#&gt; $fevals
#&gt; function 
#&gt;       40 
#&gt; 
#&gt; $gevals
#&gt; gradient 
#&gt;       40 
#&gt; 
#&gt; $nitns
#&gt; [1] NA
#&gt; 
#&gt; $kkt1
#&gt; [1] TRUE
#&gt; 
#&gt; $kkt2
#&gt; [1] TRUE
#&gt; 
#&gt; $xtimes
#&gt; user.self 
#&gt;      0.44 
#&gt; 
#&gt; Assemble the answers
#&gt; </div><div class='input'>
<span class='co'># For coef(), the parameter "complete" determines if only the</span>
<span class='co'># main model parameters or also the auxiliary coefficients are returned</span>

<span class='no'>c1.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>) <span class='co'># also returns rho and sigma</span>
<span class='co'># same as above</span>
<span class='no'>c1.all.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'># only main model coefs</span>
<span class='no'>c1.main.coefs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/coef'>coef</a></span>(<span class='no'>res.c1</span>, <span class='kw'>complete</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Raluca Gui, Markus Meierer, Rene Algesheimer, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

